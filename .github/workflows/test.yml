name: Test

on:
  push:
    branches:
      - 'master'
  pull_request:
    types: [synchronize, opened, reopened, ready_for_review]

jobs:
  config:
    runs-on: "ubuntu-latest"
    outputs:
      has-secrets: ${{ steps.check.outputs.has-secrets }}
    steps:
      - name: "Check for secrets"
        id: check
        shell: bash
        run: |
          if [ -n "${{ (secrets.DOCKERHUB_USER != '' && secrets.DOCKERHUB_TOKEN != '') || '' }}" ]; then
            echo "has-secrets=1" >> "$GITHUB_OUTPUT"
            echo "has secrets dockerhub!"
          else
            echo "has-secrets=0" >> "$GITHUB_OUTPUT"
            echo "no secrets docker hub!"
          fi
          if [ -n "${{ (secrets.AWS_ACCESS_KEY_ID != '' &&
            secrets.AWS_ACCESS_KEY_ID != '' &&
            secrets.AWS_SECRET_ACCESS_KEY != '' &&
            secrets.AWS_SECRET_ACCESS_KEY != '') || '' }}" ]; then
            echo "has-secrets=1" >> "$GITHUB_OUTPUT"
            echo "has secrets! AWS"
          else
            echo "has-secrets=0" >> "$GITHUB_OUTPUT"
            echo "no secrets! AWS"
          fi
