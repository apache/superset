{"ast":null,"code":"import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";var _jsxFileName = \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/OmniContainer.jsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           */\nimport React from 'react';\nimport { Modal } from 'react-bootstrap';\nimport PropTypes from 'prop-types';\nimport { t } from '@superset-ui/translation';\nimport { SupersetClient } from '@superset-ui/connection';\nimport { isFeatureEnabled, FeatureFlag } from 'src/featureFlags';\nimport Omnibar from 'omnibar';\nimport { LOG_ACTIONS_OMNIBAR_TRIGGERED } from '../logger/LogUtils';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst propTypes = {\n  logEvent: PropTypes.func.isRequired };\n\n\nconst getDashboards = (query) =>\n// todo: Build a dedicated endpoint for dashboard searching\n// i.e. superset/v1/api/dashboards?q=${query}\nSupersetClient.get({\n  endpoint: \"/dashboardasync/api/read?_oc_DashboardModelViewAsync=changed_on&_od_DashboardModelViewAsync=desc&_flt_2_dashboard_title=\" + query }).\n\nthen(({ json }) => {var _context;return (\n    _mapInstanceProperty(_context = json.result).call(_context, item => _Object$assign({\n      title: item.dashboard_title },\n    item)));}).\n\n\ncatch(() => ({\n  title: t('An error occurred while fethching Dashboards') }));\n\n\nclass OmniContainer extends React.Component {\n  constructor(props) {var _context2;\n    super(props);\n    this.state = {\n      showOmni: false };\n\n    this.handleKeydown = _bindInstanceProperty(_context2 = this.handleKeydown).call(_context2, this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeydown);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown);\n  }\n\n  handleKeydown(event) {\n    const controlOrCommand = event.ctrlKey || event.metaKey;\n    if (controlOrCommand && isFeatureEnabled(FeatureFlag.OMNIBAR)) {\n      const isK = event.key === 'k' || event.keyCode === 83;\n      if (isK) {\n        this.props.logEvent(LOG_ACTIONS_OMNIBAR_TRIGGERED, {\n          show_omni: !this.state.showOmni });\n\n\n        this.setState({ showOmni: !this.state.showOmni });\n\n        document.getElementsByClassName('Omnibar')[0].focus();\n      }\n    }\n  }\n\n  render() {\n    return (\n      ___EmotionJSX(Modal, { show: this.state.showOmni, style: { marginTop: '25%' }, __source: { fileName: _jsxFileName, lineNumber: 83 }, __self: this },\n      ___EmotionJSX(Omnibar, {\n        className: \"Omnibar\",\n        placeholder: \"Search all dashboards\",\n        extensions: [getDashboards], __source: { fileName: _jsxFileName, lineNumber: 84 }, __self: this })));\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nOmniContainer.propTypes = propTypes;const _default =\nOmniContainer;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/OmniContainer.jsx\");reactHotLoader.register(getDashboards, \"getDashboards\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/OmniContainer.jsx\");reactHotLoader.register(OmniContainer, \"OmniContainer\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/OmniContainer.jsx\");reactHotLoader.register(_default, \"default\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/OmniContainer.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/OmniContainer.jsx"],"names":["React","Modal","PropTypes","t","SupersetClient","isFeatureEnabled","FeatureFlag","Omnibar","LOG_ACTIONS_OMNIBAR_TRIGGERED","propTypes","logEvent","func","isRequired","getDashboards","query","get","endpoint","then","json","result","item","title","dashboard_title","catch","OmniContainer","Component","constructor","props","state","showOmni","handleKeydown","componentDidMount","document","addEventListener","componentWillUnmount","removeEventListener","event","controlOrCommand","ctrlKey","metaKey","OMNIBAR","isK","key","keyCode","show_omni","setState","getElementsByClassName","focus","render","marginTop"],"mappings":"0pBAAA;;;;;;;;;;;;;;;;;;AAkBA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,KAAT,QAAsB,iBAAtB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,CAAT,QAAkB,0BAAlB;AACA,SAASC,cAAT,QAA+B,yBAA/B;AACA,SAASC,gBAAT,EAA2BC,WAA3B,QAA8C,kBAA9C;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,SAASC,6BAAT,QAA8C,oBAA9C,C;;AAEA,MAAMC,SAAS,GAAG;AAChBC,EAAAA,QAAQ,EAAER,SAAS,CAACS,IAAV,CAAeC,UADT,EAAlB;;;AAIA,MAAMC,aAAa,GAAG,CAAAC,KAAK;AACzB;AACA;AACAV,cAAc,CAACW,GAAf,CAAmB;AACjBC,EAAAA,QAAQ,+HAA6HF,KADpH,EAAnB;;AAGGG,IAHH,CAGQ,CAAC,EAAEC,IAAF,EAAD;AACJ,oCAAAA,IAAI,CAACC,MAAL,iBAAgBC,IAAI;AAClBC,MAAAA,KAAK,EAAED,IAAI,CAACE,eADM;AAEfF,IAAAA,IAFe,CAApB,CADI,GAHR;;;AASGG,KATH,CASS,OAAO;AACZF,EAAAA,KAAK,EAAElB,CAAC,CAAC,8CAAD,CADI,EAAP,CATT,CAHF;;;AAgBA,MAAMqB,aAAN,SAA4BxB,KAAK,CAACyB,SAAlC,CAA4C;AAC1CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXC,MAAAA,QAAQ,EAAE,KADC,EAAb;;AAGA,SAAKC,aAAL,GAAqB,uCAAKA,aAAL,kBAAwB,IAAxB,CAArB;AACD;;AAEDC,EAAAA,iBAAiB,GAAG;AAClBC,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,EAAqC,KAAKH,aAA1C;AACD;;AAEDI,EAAAA,oBAAoB,GAAG;AACrBF,IAAAA,QAAQ,CAACG,mBAAT,CAA6B,SAA7B,EAAwC,KAAKL,aAA7C;AACD;;AAEDA,EAAAA,aAAa,CAACM,KAAD,EAAQ;AACnB,UAAMC,gBAAgB,GAAGD,KAAK,CAACE,OAAN,IAAiBF,KAAK,CAACG,OAAhD;AACA,QAAIF,gBAAgB,IAAIhC,gBAAgB,CAACC,WAAW,CAACkC,OAAb,CAAxC,EAA+D;AAC7D,YAAMC,GAAG,GAAGL,KAAK,CAACM,GAAN,KAAc,GAAd,IAAqBN,KAAK,CAACO,OAAN,KAAkB,EAAnD;AACA,UAAIF,GAAJ,EAAS;AACP,aAAKd,KAAL,CAAWjB,QAAX,CAAoBF,6BAApB,EAAmD;AACjDoC,UAAAA,SAAS,EAAE,CAAC,KAAKhB,KAAL,CAAWC,QAD0B,EAAnD;;;AAIA,aAAKgB,QAAL,CAAc,EAAEhB,QAAQ,EAAE,CAAC,KAAKD,KAAL,CAAWC,QAAxB,EAAd;;AAEAG,QAAAA,QAAQ,CAACc,sBAAT,CAAgC,SAAhC,EAA2C,CAA3C,EAA8CC,KAA9C;AACD;AACF;AACF;;AAEDC,EAAAA,MAAM,GAAG;AACP;AACE,oBAAC,KAAD,IAAO,IAAI,EAAE,KAAKpB,KAAL,CAAWC,QAAxB,EAAkC,KAAK,EAAE,EAAEoB,SAAS,EAAE,KAAb,EAAzC;AACE,oBAAC,OAAD;AACE,QAAA,SAAS,EAAC,SADZ;AAEE,QAAA,WAAW,EAAC,uBAFd;AAGE,QAAA,UAAU,EAAE,CAACpC,aAAD,CAHd,uEADF,CADF;;;;AASD,GA3CyC;AAAA;AAAA;AA8C5CW,aAAa,CAACf,SAAd,GAA0BA,SAA1B,C;AACee,a,CAAf,wB,iLAnEMf,S,wIAIAI,a,4IAgBAW,a","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { Modal } from 'react-bootstrap';\nimport PropTypes from 'prop-types';\nimport { t } from '@superset-ui/translation';\nimport { SupersetClient } from '@superset-ui/connection';\nimport { isFeatureEnabled, FeatureFlag } from 'src/featureFlags';\nimport Omnibar from 'omnibar';\nimport { LOG_ACTIONS_OMNIBAR_TRIGGERED } from '../logger/LogUtils';\n\nconst propTypes = {\n  logEvent: PropTypes.func.isRequired,\n};\n\nconst getDashboards = query =>\n  // todo: Build a dedicated endpoint for dashboard searching\n  // i.e. superset/v1/api/dashboards?q=${query}\n  SupersetClient.get({\n    endpoint: `/dashboardasync/api/read?_oc_DashboardModelViewAsync=changed_on&_od_DashboardModelViewAsync=desc&_flt_2_dashboard_title=${query}`,\n  })\n    .then(({ json }) =>\n      json.result.map(item => ({\n        title: item.dashboard_title,\n        ...item,\n      })),\n    )\n    .catch(() => ({\n      title: t('An error occurred while fethching Dashboards'),\n    }));\n\nclass OmniContainer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showOmni: false,\n    };\n    this.handleKeydown = this.handleKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeydown);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown);\n  }\n\n  handleKeydown(event) {\n    const controlOrCommand = event.ctrlKey || event.metaKey;\n    if (controlOrCommand && isFeatureEnabled(FeatureFlag.OMNIBAR)) {\n      const isK = event.key === 'k' || event.keyCode === 83;\n      if (isK) {\n        this.props.logEvent(LOG_ACTIONS_OMNIBAR_TRIGGERED, {\n          show_omni: !this.state.showOmni,\n        });\n\n        this.setState({ showOmni: !this.state.showOmni });\n\n        document.getElementsByClassName('Omnibar')[0].focus();\n      }\n    }\n  }\n\n  render() {\n    return (\n      <Modal show={this.state.showOmni} style={{ marginTop: '25%' }}>\n        <Omnibar\n          className=\"Omnibar\"\n          placeholder=\"Search all dashboards\"\n          extensions={[getDashboards]}\n        />\n      </Modal>\n    );\n  }\n}\n\nOmniContainer.propTypes = propTypes;\nexport default OmniContainer;\n"]},"metadata":{},"sourceType":"module"}