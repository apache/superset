{"ast":null,"code":"import _extends from \"@babel/runtime-corejs3/helpers/extends\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";var _jsxFileName = \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/dashboard/components/gridComponents/Tab.jsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport DashboardComponent from '../../containers/DashboardComponent';\nimport DragDroppable from '../dnd/DragDroppable';\nimport EditableTitle from '../../../components/EditableTitle';\nimport AnchorLink from '../../../components/AnchorLink';\nimport DeleteComponentModal from '../DeleteComponentModal';\nimport WithPopoverMenu from '../menu/WithPopoverMenu';\nimport { componentShape } from '../../util/propShapes';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nexport const RENDER_TAB = 'RENDER_TAB';\nexport const RENDER_TAB_CONTENT = 'RENDER_TAB_CONTENT';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  renderType: PropTypes.oneOf([RENDER_TAB, RENDER_TAB_CONTENT]).isRequired,\n  onDropOnTab: PropTypes.func,\n  onDeleteTab: PropTypes.func,\n  editMode: PropTypes.bool.isRequired,\n  filters: PropTypes.object.isRequired,\n\n  // grid related\n  availableColumnCount: PropTypes.number,\n  columnWidth: PropTypes.number,\n  onResizeStart: PropTypes.func,\n  onResize: PropTypes.func,\n  onResizeStop: PropTypes.func,\n\n  // redux\n  handleComponentDrop: PropTypes.func.isRequired,\n  deleteComponent: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n  setDirectPathToChild: PropTypes.func.isRequired };\n\n\nconst defaultProps = {\n  availableColumnCount: 0,\n  columnWidth: 0,\n  onDropOnTab() {},\n  onDeleteTab() {},\n  onResizeStart() {},\n  onResize() {},\n  onResizeStop() {} };\n\n\nexport default class Tab extends React.PureComponent {\n  constructor(props) {var _context, _context2, _context3, _context4, _context5, _context6;\n    super(props);\n    this.state = {\n      isFocused: false };\n\n    this.handleChangeFocus = _bindInstanceProperty(_context = this.handleChangeFocus).call(_context, this);\n    this.handleChangeText = _bindInstanceProperty(_context2 = this.handleChangeText).call(_context2, this);\n    this.handleDeleteComponent = _bindInstanceProperty(_context3 = this.handleDeleteComponent).call(_context3, this);\n    this.handleDrop = _bindInstanceProperty(_context4 = this.handleDrop).call(_context4, this);\n    this.handleTopDropTargetDrop = _bindInstanceProperty(_context5 = this.handleTopDropTargetDrop).call(_context5, this);\n    this.handleChangeTab = _bindInstanceProperty(_context6 = this.handleChangeTab).call(_context6, this);\n  }\n\n  handleChangeFocus(nextFocus) {\n    this.setState(() => ({ isFocused: nextFocus }));\n  }\n\n  handleChangeTab({ pathToTabIndex }) {\n    this.props.setDirectPathToChild(pathToTabIndex);\n  }\n\n  handleChangeText(nextTabText) {\n    const { updateComponents, component } = this.props;\n    if (nextTabText && nextTabText !== component.meta.text) {\n      updateComponents({\n        [component.id]: _Object$assign({},\n        component, {\n          meta: _Object$assign({},\n          component.meta, {\n            text: nextTabText }) }) });\n\n\n\n    }\n  }\n\n  handleDeleteComponent() {\n    const { index, id, parentId } = this.props;\n    this.props.deleteComponent(id, parentId);\n    this.props.onDeleteTab(index);\n  }\n\n  handleDrop(dropResult) {\n    this.props.handleComponentDrop(dropResult);\n    this.props.onDropOnTab(dropResult);\n  }\n\n  handleTopDropTargetDrop(dropResult) {\n    if (dropResult) {\n      this.props.handleComponentDrop(_Object$assign({},\n      dropResult, {\n        destination: _Object$assign({},\n        dropResult.destination, {\n          // force appending as the first child if top drop target\n          index: 0 }) }));\n\n\n    }\n  }\n\n  renderTabContent() {var _context7;\n    const {\n      component: tabComponent,\n      parentComponent: tabParentComponent,\n      depth,\n      availableColumnCount,\n      columnWidth,\n      onResizeStart,\n      onResize,\n      onResizeStop,\n      editMode,\n      isComponentVisible } =\n    this.props;\n\n    return (\n      ___EmotionJSX(\"div\", { className: \"dashboard-component-tabs-content\", __source: { fileName: _jsxFileName, lineNumber: 146 }, __self: this },\n\n      editMode &&\n      ___EmotionJSX(DragDroppable, {\n        component: tabComponent,\n        parentComponent: tabParentComponent,\n        orientation: \"column\",\n        index: 0,\n        depth: depth,\n        onDrop: this.handleTopDropTargetDrop,\n        editMode: true,\n        className: \"empty-droptarget\", __source: { fileName: _jsxFileName, lineNumber: 149 }, __self: this },\n\n      ({ dropIndicatorProps }) =>\n      dropIndicatorProps &&\n      ___EmotionJSX(\"div\", { className: \"drop-indicator drop-indicator--top\", __source: { fileName: _jsxFileName, lineNumber: 161 }, __self: this })),\n\n\n\n\n      _mapInstanceProperty(_context7 = tabComponent.children).call(_context7, (componentId, componentIndex) =>\n      ___EmotionJSX(DashboardComponent, {\n        key: componentId,\n        id: componentId,\n        parentId: tabComponent.id,\n        depth: depth // see isValidChild.js for why tabs don't increment child depth\n        , index: componentIndex,\n        onDrop: this.handleDrop,\n        availableColumnCount: availableColumnCount,\n        columnWidth: columnWidth,\n        onResizeStart: onResizeStart,\n        onResize: onResize,\n        onResizeStop: onResizeStop,\n        isComponentVisible: isComponentVisible,\n        onChangeTab: this.handleChangeTab, __source: { fileName: _jsxFileName, lineNumber: 167 }, __self: this })),\n\n\n\n      editMode &&\n      ___EmotionJSX(DragDroppable, {\n        component: tabComponent,\n        parentComponent: tabParentComponent,\n        orientation: \"column\",\n        index: tabComponent.children.length,\n        depth: depth,\n        onDrop: this.handleDrop,\n        editMode: true,\n        className: \"empty-droptarget\", __source: { fileName: _jsxFileName, lineNumber: 185 }, __self: this },\n\n      ({ dropIndicatorProps }) =>\n      dropIndicatorProps &&\n      ___EmotionJSX(\"div\", { className: \"drop-indicator drop-indicator--bottom\", __source: { fileName: _jsxFileName, lineNumber: 197 }, __self: this }))));\n\n\n\n\n\n\n  }\n\n  renderTab() {\n    const { isFocused } = this.state;\n    const {\n      component,\n      parentComponent,\n      index,\n      depth,\n      editMode,\n      filters } =\n    this.props;\n    const deleteTabIcon =\n    ___EmotionJSX(\"div\", { className: \"icon-button\", __source: { fileName: _jsxFileName, lineNumber: 217 }, __self: this },\n    ___EmotionJSX(\"span\", { className: \"fa fa-trash\", __source: { fileName: _jsxFileName, lineNumber: 218 }, __self: this }));\n\n\n\n    return (\n      ___EmotionJSX(DragDroppable, {\n        component: component,\n        parentComponent: parentComponent,\n        orientation: \"column\",\n        index: index,\n        depth: depth,\n        onDrop: this.handleDrop,\n        editMode: editMode, __source: { fileName: _jsxFileName, lineNumber: 223 }, __self: this },\n\n      ({ dropIndicatorProps, dragSourceRef }) =>\n      ___EmotionJSX(\"div\", { className: \"dragdroppable-tab\", ref: dragSourceRef, __source: { fileName: _jsxFileName, lineNumber: 233 }, __self: this },\n      ___EmotionJSX(WithPopoverMenu, {\n        onChangeFocus: this.handleChangeFocus,\n        menuItems:\n        parentComponent.children.length <= 1 ?\n        [] :\n        [\n        ___EmotionJSX(DeleteComponentModal, {\n          triggerNode: deleteTabIcon,\n          onDelete: this.handleDeleteComponent, __source: { fileName: _jsxFileName, lineNumber: 240 }, __self: this })],\n\n\n\n        editMode: editMode, __source: { fileName: _jsxFileName, lineNumber: 234 }, __self: this },\n\n      ___EmotionJSX(EditableTitle, {\n        title: component.meta.text,\n        canEdit: editMode && isFocused,\n        onSaveTitle: this.handleChangeText,\n        showTooltip: false, __source: { fileName: _jsxFileName, lineNumber: 248 }, __self: this }),\n\n      !editMode &&\n      ___EmotionJSX(AnchorLink, {\n        anchorLinkId: component.id,\n        filters: filters,\n        showShortLinkButton: true,\n        placement: index >= 5 ? 'left' : 'right', __source: { fileName: _jsxFileName, lineNumber: 255 }, __self: this })),\n\n\n\n\n      dropIndicatorProps && ___EmotionJSX(\"div\", _extends({}, dropIndicatorProps, { __source: { fileName: _jsxFileName, lineNumber: 264 }, __self: this })))));\n\n\n\n\n  }\n\n  render() {\n    const { renderType } = this.props;\n    return renderType === RENDER_TAB ?\n    this.renderTab() :\n    this.renderTabContent();\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nTab.propTypes = propTypes;\nTab.defaultProps = defaultProps;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(RENDER_TAB, \"RENDER_TAB\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/dashboard/components/gridComponents/Tab.jsx\");reactHotLoader.register(RENDER_TAB_CONTENT, \"RENDER_TAB_CONTENT\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/dashboard/components/gridComponents/Tab.jsx\");reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/dashboard/components/gridComponents/Tab.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/dashboard/components/gridComponents/Tab.jsx\");reactHotLoader.register(Tab, \"Tab\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/dashboard/components/gridComponents/Tab.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/tiago/git-facilit/incubator-superset/superset-frontend/src/dashboard/components/gridComponents/Tab.jsx"],"names":["React","PropTypes","DashboardComponent","DragDroppable","EditableTitle","AnchorLink","DeleteComponentModal","WithPopoverMenu","componentShape","RENDER_TAB","RENDER_TAB_CONTENT","propTypes","id","string","isRequired","parentId","component","parentComponent","index","number","depth","renderType","oneOf","onDropOnTab","func","onDeleteTab","editMode","bool","filters","object","availableColumnCount","columnWidth","onResizeStart","onResize","onResizeStop","handleComponentDrop","deleteComponent","updateComponents","setDirectPathToChild","defaultProps","Tab","PureComponent","constructor","props","state","isFocused","handleChangeFocus","handleChangeText","handleDeleteComponent","handleDrop","handleTopDropTargetDrop","handleChangeTab","nextFocus","setState","pathToTabIndex","nextTabText","meta","text","dropResult","destination","renderTabContent","tabComponent","tabParentComponent","isComponentVisible","dropIndicatorProps","children","componentId","componentIndex","length","renderTab","deleteTabIcon","dragSourceRef","render"],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport DashboardComponent from '../../containers/DashboardComponent';\nimport DragDroppable from '../dnd/DragDroppable';\nimport EditableTitle from '../../../components/EditableTitle';\nimport AnchorLink from '../../../components/AnchorLink';\nimport DeleteComponentModal from '../DeleteComponentModal';\nimport WithPopoverMenu from '../menu/WithPopoverMenu';\nimport { componentShape } from '../../util/propShapes';\n\nexport const RENDER_TAB = 'RENDER_TAB';\nexport const RENDER_TAB_CONTENT = 'RENDER_TAB_CONTENT';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  renderType: PropTypes.oneOf([RENDER_TAB, RENDER_TAB_CONTENT]).isRequired,\n  onDropOnTab: PropTypes.func,\n  onDeleteTab: PropTypes.func,\n  editMode: PropTypes.bool.isRequired,\n  filters: PropTypes.object.isRequired,\n\n  // grid related\n  availableColumnCount: PropTypes.number,\n  columnWidth: PropTypes.number,\n  onResizeStart: PropTypes.func,\n  onResize: PropTypes.func,\n  onResizeStop: PropTypes.func,\n\n  // redux\n  handleComponentDrop: PropTypes.func.isRequired,\n  deleteComponent: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n  setDirectPathToChild: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {\n  availableColumnCount: 0,\n  columnWidth: 0,\n  onDropOnTab() {},\n  onDeleteTab() {},\n  onResizeStart() {},\n  onResize() {},\n  onResizeStop() {},\n};\n\nexport default class Tab extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isFocused: false,\n    };\n    this.handleChangeFocus = this.handleChangeFocus.bind(this);\n    this.handleChangeText = this.handleChangeText.bind(this);\n    this.handleDeleteComponent = this.handleDeleteComponent.bind(this);\n    this.handleDrop = this.handleDrop.bind(this);\n    this.handleTopDropTargetDrop = this.handleTopDropTargetDrop.bind(this);\n    this.handleChangeTab = this.handleChangeTab.bind(this);\n  }\n\n  handleChangeFocus(nextFocus) {\n    this.setState(() => ({ isFocused: nextFocus }));\n  }\n\n  handleChangeTab({ pathToTabIndex }) {\n    this.props.setDirectPathToChild(pathToTabIndex);\n  }\n\n  handleChangeText(nextTabText) {\n    const { updateComponents, component } = this.props;\n    if (nextTabText && nextTabText !== component.meta.text) {\n      updateComponents({\n        [component.id]: {\n          ...component,\n          meta: {\n            ...component.meta,\n            text: nextTabText,\n          },\n        },\n      });\n    }\n  }\n\n  handleDeleteComponent() {\n    const { index, id, parentId } = this.props;\n    this.props.deleteComponent(id, parentId);\n    this.props.onDeleteTab(index);\n  }\n\n  handleDrop(dropResult) {\n    this.props.handleComponentDrop(dropResult);\n    this.props.onDropOnTab(dropResult);\n  }\n\n  handleTopDropTargetDrop(dropResult) {\n    if (dropResult) {\n      this.props.handleComponentDrop({\n        ...dropResult,\n        destination: {\n          ...dropResult.destination,\n          // force appending as the first child if top drop target\n          index: 0,\n        },\n      });\n    }\n  }\n\n  renderTabContent() {\n    const {\n      component: tabComponent,\n      parentComponent: tabParentComponent,\n      depth,\n      availableColumnCount,\n      columnWidth,\n      onResizeStart,\n      onResize,\n      onResizeStop,\n      editMode,\n      isComponentVisible,\n    } = this.props;\n\n    return (\n      <div className=\"dashboard-component-tabs-content\">\n        {/* Make top of tab droppable */}\n        {editMode && (\n          <DragDroppable\n            component={tabComponent}\n            parentComponent={tabParentComponent}\n            orientation=\"column\"\n            index={0}\n            depth={depth}\n            onDrop={this.handleTopDropTargetDrop}\n            editMode\n            className=\"empty-droptarget\"\n          >\n            {({ dropIndicatorProps }) =>\n              dropIndicatorProps && (\n                <div className=\"drop-indicator drop-indicator--top\" />\n              )\n            }\n          </DragDroppable>\n        )}\n        {tabComponent.children.map((componentId, componentIndex) => (\n          <DashboardComponent\n            key={componentId}\n            id={componentId}\n            parentId={tabComponent.id}\n            depth={depth} // see isValidChild.js for why tabs don't increment child depth\n            index={componentIndex}\n            onDrop={this.handleDrop}\n            availableColumnCount={availableColumnCount}\n            columnWidth={columnWidth}\n            onResizeStart={onResizeStart}\n            onResize={onResize}\n            onResizeStop={onResizeStop}\n            isComponentVisible={isComponentVisible}\n            onChangeTab={this.handleChangeTab}\n          />\n        ))}\n        {/* Make bottom of tab droppable */}\n        {editMode && (\n          <DragDroppable\n            component={tabComponent}\n            parentComponent={tabParentComponent}\n            orientation=\"column\"\n            index={tabComponent.children.length}\n            depth={depth}\n            onDrop={this.handleDrop}\n            editMode\n            className=\"empty-droptarget\"\n          >\n            {({ dropIndicatorProps }) =>\n              dropIndicatorProps && (\n                <div className=\"drop-indicator drop-indicator--bottom\" />\n              )\n            }\n          </DragDroppable>\n        )}\n      </div>\n    );\n  }\n\n  renderTab() {\n    const { isFocused } = this.state;\n    const {\n      component,\n      parentComponent,\n      index,\n      depth,\n      editMode,\n      filters,\n    } = this.props;\n    const deleteTabIcon = (\n      <div className=\"icon-button\">\n        <span className=\"fa fa-trash\" />\n      </div>\n    );\n\n    return (\n      <DragDroppable\n        component={component}\n        parentComponent={parentComponent}\n        orientation=\"column\"\n        index={index}\n        depth={depth}\n        onDrop={this.handleDrop}\n        editMode={editMode}\n      >\n        {({ dropIndicatorProps, dragSourceRef }) => (\n          <div className=\"dragdroppable-tab\" ref={dragSourceRef}>\n            <WithPopoverMenu\n              onChangeFocus={this.handleChangeFocus}\n              menuItems={\n                parentComponent.children.length <= 1\n                  ? []\n                  : [\n                      <DeleteComponentModal\n                        triggerNode={deleteTabIcon}\n                        onDelete={this.handleDeleteComponent}\n                      />,\n                    ]\n              }\n              editMode={editMode}\n            >\n              <EditableTitle\n                title={component.meta.text}\n                canEdit={editMode && isFocused}\n                onSaveTitle={this.handleChangeText}\n                showTooltip={false}\n              />\n              {!editMode && (\n                <AnchorLink\n                  anchorLinkId={component.id}\n                  filters={filters}\n                  showShortLinkButton\n                  placement={index >= 5 ? 'left' : 'right'}\n                />\n              )}\n            </WithPopoverMenu>\n\n            {dropIndicatorProps && <div {...dropIndicatorProps} />}\n          </div>\n        )}\n      </DragDroppable>\n    );\n  }\n\n  render() {\n    const { renderType } = this.props;\n    return renderType === RENDER_TAB\n      ? this.renderTab()\n      : this.renderTabContent();\n  }\n}\n\nTab.propTypes = propTypes;\nTab.defaultProps = defaultProps;\n"]},"metadata":{},"sourceType":"module"}