{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime-corejs3/helpers/objectWithoutPropertiesLoose\";import _findIndexInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/find-index\";import _Array$isArray from \"@babel/runtime-corejs3/core-js-stable/array/is-array\";var _jsxFileName = \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/Select/WindowedSelect/WindowedMenuList.tsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  */\nimport React, { useRef, useEffect } from 'react';\nimport { FixedSizeList as WindowedList } from 'react-window';import { jsx as ___EmotionJSX } from \"@emotion/core\";\nconst DEFAULT_OPTION_HEIGHT = 30;\n/**\n                                   * Get the index of the last selected option.\n                                   */\nfunction getLastSelected(children) {\n  return _Array$isArray(children) ?\n  _findIndexInstanceProperty(children).call(children, ({ props: { isFocused = false } = {} }) => isFocused) || 0 :\n  -1;\n}\n/**\n   * Calculate probable option height as set in theme configs\n   */\nfunction detectHeight({ spacing: { baseUnit, lineHeight } }) {\n  // Option item expects 2 * baseUnit for each of top and bottom padding.\n  return baseUnit * 4 + lineHeight;\n}\nexport default function WindowedMenuList(_ref) {let { children } = _ref,props = _objectWithoutPropertiesLoose(_ref, [\"children\"]);\n  const { maxHeight, selectProps, theme, getStyles, cx, innerRef, isMulti, className } = props;\n  const {\n    // Expose react-window VariableSizeList instance and HTML elements\n    windowListRef = useRef(null), windowListInnerRef } = selectProps;\n  // try get default option height from theme configs\n  let optionHeight = selectProps.optionHeight;\n  if (!optionHeight) {\n    optionHeight = theme ? detectHeight(theme) : DEFAULT_OPTION_HEIGHT;\n  }\n  const itemCount = children.length;\n  const totalHeight = optionHeight * itemCount;\n  const listRef = windowListRef || useRef(null);\n  const Row = ({ data, index, style }) => {\n    return ___EmotionJSX(\"div\", { style: style, __source: { fileName: _jsxFileName, lineNumber: 51 }, __self: this }, data[index]);\n  };\n  useEffect(() => {\n    const lastSelected = getLastSelected(children);\n    if (listRef.current && lastSelected) {\n      listRef.current.scrollToItem(lastSelected);\n    }\n  }, [children]);\n  return ___EmotionJSX(WindowedList, { css: getStyles('menuList', props)\n    // @ts-ignore\n    , className: cx({\n      'menu-list': true,\n      'menu-list--is-multi': isMulti },\n    className), ref: listRef, outerRef: innerRef, innerRef: windowListInnerRef, height: Math.min(totalHeight, maxHeight), width: \"100%\", itemData: children, itemCount: children.length, itemSize: optionHeight, __source: { fileName: _jsxFileName, lineNumber: 59 }, __self: this },\n  Row);\n\n}__signature__(WindowedMenuList, \"useRef{}\\nuseRef{}\\nuseEffect{}\");;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(DEFAULT_OPTION_HEIGHT, \"DEFAULT_OPTION_HEIGHT\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/Select/WindowedSelect/WindowedMenuList.tsx\");reactHotLoader.register(getLastSelected, \"getLastSelected\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/Select/WindowedSelect/WindowedMenuList.tsx\");reactHotLoader.register(detectHeight, \"detectHeight\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/Select/WindowedSelect/WindowedMenuList.tsx\");reactHotLoader.register(WindowedMenuList, \"WindowedMenuList\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/Select/WindowedSelect/WindowedMenuList.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/tiago/git-facilit/incubator-superset/superset-frontend/src/components/Select/WindowedSelect/WindowedMenuList.tsx"],"names":[],"mappings":"itBAAA;;;;;;;;;;;;;;;;;;AAkBA,OAAO,KAAP,IACE,MADF,EAEE,SAFF,QAMO,OANP;AAOA,SAEE,aAAa,IAAI,YAFnB,QAGO,cAHP,C;AAwCA,MAAM,qBAAqB,GAAG,EAA9B;AAEA;;;AAGA,SAAS,eAAT,CAAyB,QAAzB,EAAmD;AACjD,SAAO,eAAc,QAAd;AACH,6BAAA,QAAQ,MAAR,CAAA,QAAQ,EACN,CAAC,EAAE,KAAK,EAAE,EAAE,SAAS,GAAG,KAAd,KAAwB,EAAjC,EAAD,KAA2C,SADrC,CAAR,IAEK,CAHF;AAIH,GAAC,CAJL;AAKD;AAED;;;AAGA,SAAS,YAAT,CAAsB,EAAE,OAAO,EAAE,EAAE,QAAF,EAAY,UAAZ,EAAX,EAAtB,EAAwE;AACtE;AACA,SAAO,QAAQ,GAAG,CAAX,GAAe,UAAtB;AACD;AAED,eAAc,SAAU,gBAAV,OAGc,KAHgD,EAC1E,QAD0E,EAGhD,QADvB,KACuB;AAC1B,QAAM,EACJ,SADI,EAEJ,WAFI,EAGJ,KAHI,EAIJ,SAJI,EAKJ,EALI,EAMJ,QANI,EAOJ,OAPI,EAQJ,SARI,KASF,KATJ;AAUA,QAAM;AACJ;AACA,IAAA,aAAa,GAAG,MAAM,CAAC,IAAD,CAFlB,EAGJ,kBAHI,KAIF,WAJJ;AAMA;AACA,MAAI,YAAY,GAAG,WAAW,CAAC,YAA/B;AACA,MAAI,CAAC,YAAL,EAAmB;AACjB,IAAA,YAAY,GAAG,KAAK,GAAG,YAAY,CAAC,KAAD,CAAf,GAAyB,qBAA7C;AACD;AAED,QAAM,SAAS,GAAG,QAAQ,CAAC,MAA3B;AACA,QAAM,WAAW,GAAG,YAAY,GAAG,SAAnC;AACA,QAAM,OAAO,GAA4B,aAAa,IAAI,MAAM,CAAC,IAAD,CAAhE;AAEA,QAAM,GAAG,GAA+C,CAAC,EACvD,IADuD,EAEvD,KAFuD,EAGvD,KAHuD,EAAD,KAInD;AACH,WAAO,uBAAK,KAAK,EAAE,KAAZ,wEAAoB,IAAI,CAAC,KAAD,CAAxB,CAAP;AACD,GAND;AAQA,EAAA,SAAS,CAAC,MAAK;AACb,UAAM,YAAY,GAAG,eAAe,CAAC,QAAD,CAApC;AACA,QAAI,OAAO,CAAC,OAAR,IAAmB,YAAvB,EAAqC;AACnC,MAAA,OAAO,CAAC,OAAR,CAAgB,YAAhB,CAA6B,YAA7B;AACD;AACF,GALQ,EAKN,CAAC,QAAD,CALM,CAAT;AAOA,SACE,cAAC,YAAD,IACE,GAAG,EAAE,SAAS,CAAC,UAAD,EAAa,KAAb;AACd;AAFF,MAGE,SAAS,EAAE,EAAE,CACX;AACE,mBAAa,IADf;AAEE,6BAAuB,OAFzB,EADW;AAKX,IAAA,SALW,CAHf,EAUE,GAAG,EAAE,OAVP,EAWE,QAAQ,EAAE,QAXZ,EAYE,QAAQ,EAAE,kBAZZ,EAaE,MAAM,EAAE,IAAI,CAAC,GAAL,CAAS,WAAT,EAAsB,SAAtB,CAbV,EAcE,KAAK,EAAC,MAdR,EAeE,QAAQ,EAAE,QAfZ,EAgBE,SAAS,EAAE,QAAQ,CAAC,MAhBtB,EAiBE,QAAQ,EAAE,YAjBZ;AAmBG,EAAA,GAnBH,CADF;;AAuBD,C,cApEuB,gB,sNArBlB,qB,6KAKG,e,uKAWA,Y,oKAKe,gB","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useRef,\n  useEffect,\n  Component,\n  FunctionComponent,\n  RefObject,\n} from 'react';\nimport {\n  ListChildComponentProps,\n  FixedSizeList as WindowedList,\n} from 'react-window';\nimport {\n  OptionTypeBase,\n  OptionProps,\n  MenuListComponentProps,\n} from 'react-select';\nimport { ThemeConfig } from '../styles';\n\nexport type WindowedMenuListProps = {\n  selectProps: {\n    windowListRef?: RefObject<WindowedList>;\n    optionHeight?: number;\n  };\n};\n\n/**\n * MenuListComponentProps should always have `children` elements, as guaranteed\n * by https://github.com/JedWatson/react-select/blob/32ad5c040bdd96cd1ca71010c2558842d684629c/packages/react-select/src/Select.js#L1686-L1719\n *\n * `children` may also be `Component<NoticeProps<OptionType>>` if options are not\n * provided (e.g., when async list is still loading, or no results), but that's\n * not possible because this MenuList will only be rendered when\n * optionsLength > windowThreshold.\n *\n * If may also be `Component<GroupProps<OptionType>>[]` but we are not supporting\n * grouped options just yet.\n */\nexport type MenuListProps<\n  OptionType extends OptionTypeBase\n> = MenuListComponentProps<OptionType> & {\n  children: Component<OptionProps<OptionType>>[];\n  // theme is not present with built-in @types/react-select, but is actually\n  // available via CommonProps.\n  theme?: ThemeConfig;\n  className?: string;\n} & WindowedMenuListProps;\n\nconst DEFAULT_OPTION_HEIGHT = 30;\n\n/**\n * Get the index of the last selected option.\n */\nfunction getLastSelected(children: Component<any>[]) {\n  return Array.isArray(children)\n    ? children.findIndex(\n        ({ props: { isFocused = false } = {} }) => isFocused,\n      ) || 0\n    : -1;\n}\n\n/**\n * Calculate probable option height as set in theme configs\n */\nfunction detectHeight({ spacing: { baseUnit, lineHeight } }: ThemeConfig) {\n  // Option item expects 2 * baseUnit for each of top and bottom padding.\n  return baseUnit * 4 + lineHeight;\n}\n\nexport default function WindowedMenuList<OptionType extends OptionTypeBase>({\n  children,\n  ...props\n}: MenuListProps<OptionType>) {\n  const {\n    maxHeight,\n    selectProps,\n    theme,\n    getStyles,\n    cx,\n    innerRef,\n    isMulti,\n    className,\n  } = props;\n  const {\n    // Expose react-window VariableSizeList instance and HTML elements\n    windowListRef = useRef(null),\n    windowListInnerRef,\n  } = selectProps;\n\n  // try get default option height from theme configs\n  let optionHeight = selectProps.optionHeight;\n  if (!optionHeight) {\n    optionHeight = theme ? detectHeight(theme) : DEFAULT_OPTION_HEIGHT;\n  }\n\n  const itemCount = children.length;\n  const totalHeight = optionHeight * itemCount;\n  const listRef: RefObject<WindowedList> = windowListRef || useRef(null);\n\n  const Row: FunctionComponent<ListChildComponentProps> = ({\n    data,\n    index,\n    style,\n  }) => {\n    return <div style={style}>{data[index]}</div>;\n  };\n\n  useEffect(() => {\n    const lastSelected = getLastSelected(children);\n    if (listRef.current && lastSelected) {\n      listRef.current.scrollToItem(lastSelected);\n    }\n  }, [children]);\n\n  return (\n    <WindowedList\n      css={getStyles('menuList', props)}\n      // @ts-ignore\n      className={cx(\n        {\n          'menu-list': true,\n          'menu-list--is-multi': isMulti,\n        },\n        className,\n      )}\n      ref={listRef}\n      outerRef={innerRef}\n      innerRef={windowListInnerRef}\n      height={Math.min(totalHeight, maxHeight)}\n      width=\"100%\"\n      itemData={children}\n      itemCount={children.length}\n      itemSize={optionHeight}\n    >\n      {Row}\n    </WindowedList>\n  );\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}