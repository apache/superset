{"ast":null,"code":"import \"core-js/modules/es.string.replace\";import \"core-js/modules/es.string.split\";import \"core-js/modules/web.dom-collections.iterator\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _extends from \"@babel/runtime-corejs3/helpers/extends\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";import _indexOfInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/index-of\";import _Object$freeze from \"@babel/runtime-corejs3/core-js-stable/object/freeze\";var _jsxFileName = \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {\nButton,\nDropdownButton,\nFormControl,\nFormGroup,\nGlyphicon,\nInputGroup,\nLabel,\nMenuItem,\nOverlayTrigger,\nPopover,\nRadio,\nTab,\nTabs,\nTooltip } from\n'react-bootstrap';\nimport Datetime from 'react-datetime';\nimport 'react-datetime/css/react-datetime.css';\nimport moment from 'moment';\nimport { t } from '@superset-ui/translation';\n\nimport './DateFilterControl.less';\nimport ControlHeader from '../ControlHeader';\nimport PopoverSection from '../../../components/PopoverSection';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst TYPES = _Object$freeze({\n  DEFAULTS: 'defaults',\n  CUSTOM_START_END: 'custom_start_end',\n  CUSTOM_RANGE: 'custom_range' });\n\nconst TABS = _Object$freeze({\n  DEFAULTS: 'defaults',\n  CUSTOM: 'custom' });\n\nconst RELATIVE_TIME_OPTIONS = _Object$freeze({\n  LAST: 'Last',\n  NEXT: 'Next' });\n\nconst COMMON_TIME_FRAMES = [\n'Last day',\n'Last week',\n'Last month',\n'Last quarter',\n'Last year',\n'No filter'];\n\nconst TIME_GRAIN_OPTIONS = [\n'seconds',\n'minutes',\n'hours',\n'days',\n'weeks',\n'months',\n'years'];\n\n\nconst MOMENT_FORMAT = 'YYYY-MM-DD[T]HH:mm:ss';\nconst DEFAULT_SINCE = moment().\nutc().\nstartOf('day').\nsubtract(7, 'days').\nformat(MOMENT_FORMAT);\nconst DEFAULT_UNTIL = moment().utc().startOf('day').format(MOMENT_FORMAT);\nconst SEPARATOR = ' : ';\nconst FREEFORM_TOOLTIP = t(\n'Superset supports smart date parsing. Strings like `last sunday` or ' +\n'`last october` can be used.');\n\n\nconst DATE_FILTER_POPOVER_STYLE = { width: '250px' };\n\nconst propTypes = {\n  animation: PropTypes.bool,\n  name: PropTypes.string.isRequired,\n  label: PropTypes.string,\n  description: PropTypes.string,\n  onChange: PropTypes.func,\n  value: PropTypes.string,\n  height: PropTypes.number,\n  onOpenDateFilterControl: PropTypes.func,\n  onCloseDateFilterControl: PropTypes.func,\n  endpoints: PropTypes.arrayOf(PropTypes.string) };\n\n\nconst defaultProps = {\n  animation: true,\n  onChange: () => {},\n  value: 'Last week',\n  onOpenDateFilterControl: () => {},\n  onCloseDateFilterControl: () => {} };\n\n\nfunction isValidMoment(s) {\n  /* Moment sometimes consider invalid dates as valid, eg, \"10 years ago\" gets\n                            * parsed as \"Fri Jan 01 2010 00:00:00\" local time. This function does a\n                            * better check by comparing a string with a parse/format roundtrip.\n                            */\n  return s === moment(s, MOMENT_FORMAT).format(MOMENT_FORMAT);\n}\n\nfunction getStateFromSeparator(value) {\n  const [since, until] = value.split(SEPARATOR, 2);\n  return { since, until, type: TYPES.CUSTOM_START_END, tab: TABS.CUSTOM };\n}\n\nfunction getStateFromCommonTimeFrame(value) {\n  const units = value.split(' ')[1] + 's';\n  return {\n    tab: TABS.DEFAULTS,\n    type: TYPES.DEFAULTS,\n    common: value,\n    since: moment().\n    utc().\n    startOf('day').\n    subtract(1, units).\n    format(MOMENT_FORMAT),\n    until: moment().utc().startOf('day').format(MOMENT_FORMAT) };\n\n}\n\nfunction getStateFromCustomRange(value) {\n  const [rel, num, grain] = value.split(' ', 3);\n  let since;\n  let until;\n  if (rel === RELATIVE_TIME_OPTIONS.LAST) {\n    until = moment().utc().startOf('day').format(MOMENT_FORMAT);\n    since = moment().\n    utc().\n    startOf('day').\n    subtract(num, grain).\n    format(MOMENT_FORMAT);\n  } else {\n    until = moment().utc().startOf('day').add(num, grain).format(MOMENT_FORMAT);\n    since = moment().startOf('day').format(MOMENT_FORMAT);\n  }\n  return {\n    tab: TABS.CUSTOM,\n    type: TYPES.CUSTOM_RANGE,\n    common: null,\n    rel,\n    num,\n    grain,\n    since,\n    until };\n\n}\n\nexport default class DateFilterControl extends React.Component {\n  constructor(props) {var _context, _context2, _context3, _context4, _context5, _context6, _context7, _context8, _context9, _context10, _context11, _context12, _context13;\n    super(props);\n    this.state = {\n      type: TYPES.DEFAULTS,\n      tab: TABS.DEFAULTS,\n\n      // default time frames, for convenience\n      common: COMMON_TIME_FRAMES[0],\n\n      // \"last 7 days\", \"next 4 weeks\", etc.\n      rel: RELATIVE_TIME_OPTIONS.LAST,\n      num: '7',\n      grain: TIME_GRAIN_OPTIONS[3],\n\n      // distinct start/end values, either ISO or freeform\n      since: DEFAULT_SINCE,\n      until: DEFAULT_UNTIL,\n\n      // react-datetime has a `closeOnSelect` prop, but it's buggy... so we\n      // handle the calendar visibility here ourselves\n      showSinceCalendar: false,\n      showUntilCalendar: false,\n      sinceViewMode: 'days',\n      untilViewMode: 'days' };\n\n\n    const value = props.value;\n    if (_indexOfInstanceProperty(value).call(value, SEPARATOR) >= 0) {\n      this.state = _Object$assign({}, this.state, {}, getStateFromSeparator(value));\n    } else if (_indexOfInstanceProperty(COMMON_TIME_FRAMES).call(COMMON_TIME_FRAMES, value) >= 0) {\n      this.state = _Object$assign({}, this.state, {}, getStateFromCommonTimeFrame(value));\n    } else {\n      this.state = _Object$assign({}, this.state, {}, getStateFromCustomRange(value));\n    }\n\n    this.close = _bindInstanceProperty(_context = this.close).call(_context, this);\n    this.handleClick = _bindInstanceProperty(_context2 = this.handleClick).call(_context2, this);\n    this.handleClickTrigger = _bindInstanceProperty(_context3 = this.handleClickTrigger).call(_context3, this);\n    this.isValidSince = _bindInstanceProperty(_context4 = this.isValidSince).call(_context4, this);\n    this.isValidUntil = _bindInstanceProperty(_context5 = this.isValidUntil).call(_context5, this);\n    this.onEnter = _bindInstanceProperty(_context6 = this.onEnter).call(_context6, this);\n    this.renderInput = _bindInstanceProperty(_context7 = this.renderInput).call(_context7, this);\n    this.setCustomRange = _bindInstanceProperty(_context8 = this.setCustomRange).call(_context8, this);\n    this.setCustomStartEnd = _bindInstanceProperty(_context9 = this.setCustomStartEnd).call(_context9, this);\n    this.setTypeCustomRange = _bindInstanceProperty(_context10 = this.setTypeCustomRange).call(_context10, this);\n    this.setTypeCustomStartEnd = _bindInstanceProperty(_context11 = this.setTypeCustomStartEnd).call(_context11, this);\n    this.toggleCalendar = _bindInstanceProperty(_context12 = this.toggleCalendar).call(_context12, this);\n    this.changeTab = _bindInstanceProperty(_context13 = this.changeTab).call(_context13, this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this.handleClick);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.handleClick);\n  }\n  onEnter(event) {\n    if (event.key === 'Enter') {\n      this.close();\n    }\n  }\n  setCustomRange(key, value) {\n    const updatedState = _Object$assign({}, this.state, { [key]: value });\n    const combinedValue = [\n    updatedState.rel,\n    updatedState.num,\n    updatedState.grain].\n    join(' ');\n    this.setState(getStateFromCustomRange(combinedValue));\n  }\n  setCustomStartEnd(key, value) {\n    const closeCalendar =\n    key === 'since' && this.state.sinceViewMode === 'days' ||\n    key === 'until' && this.state.untilViewMode === 'days';\n    this.setState({\n      type: TYPES.CUSTOM_START_END,\n      [key]: typeof value === 'string' ? value : value.format(MOMENT_FORMAT),\n      showSinceCalendar: this.state.showSinceCalendar && !closeCalendar,\n      showUntilCalendar: this.state.showUntilCalendar && !closeCalendar,\n      sinceViewMode: closeCalendar ? 'days' : this.state.sinceViewMode,\n      untilViewMode: closeCalendar ? 'days' : this.state.untilViewMode });\n\n  }\n  setTypeCustomRange() {\n    this.setState({ type: TYPES.CUSTOM_RANGE });\n  }\n  setTypeCustomStartEnd() {\n    this.setState({ type: TYPES.CUSTOM_START_END });\n  }\n\n  changeTab() {\n    const { tab } = this.state;\n    if (tab === TABS.CUSTOM) {\n      this.setState({ tab: TABS.DEFAULTS });\n    } else if (tab === TABS.DEFAULTS) {\n      this.setState({ tab: TABS.CUSTOM });\n    }\n  }\n\n  handleClick(e) {\n    const target = e.target;\n    // switch to `TYPES.CUSTOM_START_END` when the calendar is clicked\n    if (this.startEndSectionRef && this.startEndSectionRef.contains(target)) {\n      this.setTypeCustomStartEnd();\n    }\n\n    // if user click outside popover, popover will hide and we will call onCloseDateFilterControl,\n    // but need to exclude OverlayTrigger component to avoid handle click events twice.\n    if (target.getAttribute('name') !== 'popover-trigger') {\n      if (this.popoverContainer && !this.popoverContainer.contains(target)) {\n        this.props.onCloseDateFilterControl();\n      }\n    }\n  }\n\n  handleClickTrigger() {\n    // when user clicks OverlayTrigger,\n    // popoverContainer component will be created after handleClickTrigger\n    // and before handleClick handler\n    if (!this.popoverContainer) {\n      this.props.onOpenDateFilterControl();\n    } else {\n      this.props.onCloseDateFilterControl();\n    }\n  }\n\n  close() {\n    let val;\n    if (\n    this.state.type === TYPES.DEFAULTS ||\n    this.state.tab === TABS.DEFAULTS)\n    {\n      val = this.state.common;\n    } else if (this.state.type === TYPES.CUSTOM_RANGE) {\n      val = this.state.rel + \" \" + this.state.num + \" \" + this.state.grain;\n    } else {\n      val = [this.state.since, this.state.until].join(SEPARATOR);\n    }\n    this.props.onCloseDateFilterControl();\n    this.props.onChange(val);\n    this.refs.trigger.hide();\n    this.setState({ showSinceCalendar: false, showUntilCalendar: false });\n  }\n  isValidSince(date) {\n    return (\n      !isValidMoment(this.state.until) ||\n      date <= moment(this.state.until, MOMENT_FORMAT));\n\n  }\n  isValidUntil(date) {\n    return (\n      !isValidMoment(this.state.since) ||\n      date >= moment(this.state.since, MOMENT_FORMAT));\n\n  }\n  toggleCalendar(key) {\n    const nextState = {};\n    if (key === 'showSinceCalendar') {\n      nextState.showSinceCalendar = !this.state.showSinceCalendar;\n      if (!this.state.showSinceCalendar) {\n        nextState.showUntilCalendar = false;\n      }\n    } else if (key === 'showUntilCalendar') {\n      nextState.showUntilCalendar = !this.state.showUntilCalendar;\n      if (!this.state.showUntilCalendar) {\n        nextState.showSinceCalendar = false;\n      }\n    }\n    this.setState(nextState);\n  }\n  renderInput(props, key) {\n    return (\n      ___EmotionJSX(FormGroup, { __source: { fileName: _jsxFileName, lineNumber: 342 }, __self: this },\n      ___EmotionJSX(InputGroup, { bsSize: \"small\", __source: { fileName: _jsxFileName, lineNumber: 343 }, __self: this },\n      ___EmotionJSX(FormControl, _extends({},\n      props, {\n        type: \"text\",\n        onKeyPress: this.onEnter,\n        onFocus: this.setTypeCustomStartEnd,\n        onClick: () => {}, __source: { fileName: _jsxFileName, lineNumber: 344 }, __self: this })),\n\n      ___EmotionJSX(InputGroup.Button, { onClick: () => this.toggleCalendar(key), __source: { fileName: _jsxFileName, lineNumber: 351 }, __self: this },\n      ___EmotionJSX(Button, { __source: { fileName: _jsxFileName, lineNumber: 352 }, __self: this },\n      ___EmotionJSX(\"i\", { className: \"fa fa-calendar\", __source: { fileName: _jsxFileName, lineNumber: 353 }, __self: this }))))));\n\n\n\n\n\n  }\n  renderPopover() {\n    const grainOptions = _mapInstanceProperty(TIME_GRAIN_OPTIONS).call(TIME_GRAIN_OPTIONS, (grain) =>\n    ___EmotionJSX(MenuItem, {\n      onSelect: value => this.setCustomRange('grain', value),\n      key: grain,\n      eventKey: grain,\n      active: grain === this.state.grain, __source: { fileName: _jsxFileName, lineNumber: 362 }, __self: this },\n\n    grain));\n\n\n    const timeFrames = _mapInstanceProperty(COMMON_TIME_FRAMES).call(COMMON_TIME_FRAMES, timeFrame => {\n      const nextState = getStateFromCommonTimeFrame(timeFrame);\n      const endpoints = this.props.endpoints;\n      return (\n        ___EmotionJSX(OverlayTrigger, {\n          key: timeFrame,\n          placement: \"left\",\n          overlay:\n          ___EmotionJSX(Tooltip, { id: \"tooltip-\" + timeFrame, __source: { fileName: _jsxFileName, lineNumber: 379 }, __self: this },\n          nextState.since, \" \", endpoints && \"(\" + endpoints[0] + \")\",\n          ___EmotionJSX(\"br\", { __source: { fileName: _jsxFileName, lineNumber: 381 }, __self: this }),\n          nextState.until, \" \", endpoints && \"(\" + endpoints[1] + \")\"), __source: { fileName: _jsxFileName, lineNumber: 375 }, __self: this },\n\n\n\n        ___EmotionJSX(\"div\", { __source: { fileName: _jsxFileName, lineNumber: 386 }, __self: this },\n        ___EmotionJSX(Radio, {\n          key: timeFrame.replace(' ', '').toLowerCase(),\n          checked: this.state.common === timeFrame,\n          onChange: () => this.setState(nextState), __source: { fileName: _jsxFileName, lineNumber: 387 }, __self: this },\n\n        timeFrame))));\n\n\n\n\n    });\n    return (\n      ___EmotionJSX(Popover, { id: \"filter-popover\", placement: \"top\", positionTop: 0, __source: { fileName: _jsxFileName, lineNumber: 399 }, __self: this },\n      ___EmotionJSX(\"div\", {\n        style: DATE_FILTER_POPOVER_STYLE,\n        ref: _ref2 => {\n          this.popoverContainer = _ref2;\n        }, __source: { fileName: _jsxFileName, lineNumber: 400 }, __self: this },\n\n      ___EmotionJSX(Tabs, {\n        defaultActiveKey: this.state.tab === TABS.DEFAULTS ? 1 : 2,\n        id: \"type\",\n        className: \"time-filter-tabs\",\n        onSelect: this.changeTab, __source: { fileName: _jsxFileName, lineNumber: 406 }, __self: this },\n\n      ___EmotionJSX(Tab, { eventKey: 1, title: \"Defaults\", __source: { fileName: _jsxFileName, lineNumber: 412 }, __self: this },\n      ___EmotionJSX(FormGroup, { __source: { fileName: _jsxFileName, lineNumber: 413 }, __self: this }, timeFrames)),\n\n      ___EmotionJSX(Tab, { eventKey: 2, title: \"Custom\", __source: { fileName: _jsxFileName, lineNumber: 415 }, __self: this },\n      ___EmotionJSX(FormGroup, { __source: { fileName: _jsxFileName, lineNumber: 416 }, __self: this },\n      ___EmotionJSX(PopoverSection, {\n        title: \"Relative to today\",\n        isSelected: this.state.type === TYPES.CUSTOM_RANGE,\n        onSelect: this.setTypeCustomRange, __source: { fileName: _jsxFileName, lineNumber: 417 }, __self: this },\n\n      ___EmotionJSX(\"div\", {\n        className: \"clearfix centered\",\n        style: { marginTop: '12px' }, __source: { fileName: _jsxFileName, lineNumber: 422 }, __self: this },\n\n      ___EmotionJSX(\"div\", {\n        style: { width: '60px', marginTop: '-4px' },\n        className: \"input-inline\", __source: { fileName: _jsxFileName, lineNumber: 426 }, __self: this },\n\n      ___EmotionJSX(DropdownButton, {\n        bsSize: \"small\",\n        componentClass: InputGroup.Button,\n        id: \"input-dropdown-rel\",\n        title: this.state.rel,\n        onFocus: this.setTypeCustomRange, __source: { fileName: _jsxFileName, lineNumber: 430 }, __self: this },\n\n      ___EmotionJSX(MenuItem, {\n        onSelect: value => this.setCustomRange('rel', value),\n        key: RELATIVE_TIME_OPTIONS.LAST,\n        eventKey: RELATIVE_TIME_OPTIONS.LAST,\n        active: this.state.rel === RELATIVE_TIME_OPTIONS.LAST, __source: { fileName: _jsxFileName, lineNumber: 437 }, __self: this }, \"Last\"),\n\n\n\n      ___EmotionJSX(MenuItem, {\n        onSelect: value => this.setCustomRange('rel', value),\n        key: RELATIVE_TIME_OPTIONS.NEXT,\n        eventKey: RELATIVE_TIME_OPTIONS.NEXT,\n        active: this.state.rel === RELATIVE_TIME_OPTIONS.NEXT, __source: { fileName: _jsxFileName, lineNumber: 445 }, __self: this }, \"Next\"))),\n\n\n\n\n\n      ___EmotionJSX(\"div\", {\n        style: { width: '60px', marginTop: '-4px' },\n        className: \"input-inline m-l-5 m-r-3\", __source: { fileName: _jsxFileName, lineNumber: 455 }, __self: this },\n\n      ___EmotionJSX(FormControl, {\n        bsSize: \"small\",\n        type: \"text\",\n        onChange: (event) =>\n        this.setCustomRange('num', event.target.value),\n\n        onFocus: this.setTypeCustomRange,\n        onKeyPress: this.onEnter,\n        value: this.state.num,\n        style: { height: '30px' }, __source: { fileName: _jsxFileName, lineNumber: 459 }, __self: this })),\n\n\n      ___EmotionJSX(\"div\", {\n        style: { width: '90px', marginTop: '-4px' },\n        className: \"input-inline\", __source: { fileName: _jsxFileName, lineNumber: 471 }, __self: this },\n\n      ___EmotionJSX(DropdownButton, {\n        bsSize: \"small\",\n        componentClass: InputGroup.Button,\n        id: \"input-dropdown-grain\",\n        title: this.state.grain,\n        onFocus: this.setTypeCustomRange, __source: { fileName: _jsxFileName, lineNumber: 475 }, __self: this },\n\n      grainOptions)))),\n\n\n\n\n      ___EmotionJSX(PopoverSection, {\n        title: \"Start / end\",\n        isSelected: this.state.type === TYPES.CUSTOM_START_END,\n        onSelect: this.setTypeCustomStartEnd,\n        info: FREEFORM_TOOLTIP, __source: { fileName: _jsxFileName, lineNumber: 487 }, __self: this },\n\n      ___EmotionJSX(\"div\", {\n        ref: _ref => {\n          this.startEndSectionRef = _ref;\n        }, __source: { fileName: _jsxFileName, lineNumber: 493 }, __self: this },\n\n      ___EmotionJSX(InputGroup, { __source: { fileName: _jsxFileName, lineNumber: 498 }, __self: this },\n      ___EmotionJSX(\"div\", { style: { margin: '5px 0' }, __source: { fileName: _jsxFileName, lineNumber: 499 }, __self: this },\n      ___EmotionJSX(Datetime, {\n        value: this.state.since,\n        defaultValue: this.state.since,\n        viewDate: this.state.since,\n        onChange: (value) =>\n        this.setCustomStartEnd('since', value),\n\n        isValidDate: this.isValidSince,\n        onClick: this.setTypeCustomStartEnd,\n        renderInput: (props) =>\n        this.renderInput(props, 'showSinceCalendar'),\n\n        open: this.state.showSinceCalendar,\n        viewMode: this.state.sinceViewMode,\n        onViewModeChange: (sinceViewMode) =>\n        this.setState({ sinceViewMode }), __source: { fileName: _jsxFileName, lineNumber: 500 }, __self: this })),\n\n\n\n      ___EmotionJSX(\"div\", { style: { margin: '5px 0' }, __source: { fileName: _jsxFileName, lineNumber: 519 }, __self: this },\n      ___EmotionJSX(Datetime, {\n        value: this.state.until,\n        defaultValue: this.state.until,\n        viewDate: this.state.until,\n        onChange: (value) =>\n        this.setCustomStartEnd('until', value),\n\n        isValidDate: this.isValidUntil,\n        onClick: this.setTypeCustomStartEnd,\n        renderInput: (props) =>\n        this.renderInput(props, 'showUntilCalendar'),\n\n        open: this.state.showUntilCalendar,\n        viewMode: this.state.untilViewMode,\n        onViewModeChange: (untilViewMode) =>\n        this.setState({ untilViewMode }), __source: { fileName: _jsxFileName, lineNumber: 520 }, __self: this })))))))),\n\n\n\n\n\n\n\n\n\n      ___EmotionJSX(\"div\", { className: \"clearfix\", __source: { fileName: _jsxFileName, lineNumber: 545 }, __self: this },\n      ___EmotionJSX(Button, {\n        bsSize: \"small\",\n        className: \"float-right ok\",\n        bsStyle: \"primary\",\n        onClick: this.close, __source: { fileName: _jsxFileName, lineNumber: 546 }, __self: this }, \"Ok\")))));\n\n\n\n\n\n\n\n  }\n  render() {var _context14;\n    let value = this.props.value || defaultProps.value;\n    const endpoints = this.props.endpoints;\n    value = _mapInstanceProperty(_context14 = value.\n    split(SEPARATOR)).call(_context14,\n\n    (v, idx, values) =>\n    (v.replace('T00:00:00', '') || (idx === 0 ? '-∞' : '∞')) + (\n    endpoints && values.length > 1 ? \" (\" + endpoints[idx] + \")\" : '')).\n\n    join(SEPARATOR);\n    return (\n      ___EmotionJSX(\"div\", { __source: { fileName: _jsxFileName, lineNumber: 571 }, __self: this },\n      ___EmotionJSX(ControlHeader, _extends({}, this.props, { __source: { fileName: _jsxFileName, lineNumber: 572 }, __self: this })),\n      ___EmotionJSX(OverlayTrigger, {\n        animation: this.props.animation,\n        container: document.body,\n        trigger: \"click\",\n        rootClose: true,\n        ref: \"trigger\",\n        placement: \"right\",\n        overlay: this.renderPopover(),\n        onClick: this.handleClickTrigger, __source: { fileName: _jsxFileName, lineNumber: 573 }, __self: this },\n\n      ___EmotionJSX(Label, { name: \"popover-trigger\", style: { cursor: 'pointer' }, __source: { fileName: _jsxFileName, lineNumber: 583 }, __self: this },\n      value))));\n\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nDateFilterControl.propTypes = propTypes;\nDateFilterControl.defaultProps = defaultProps;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(TYPES, \"TYPES\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(TABS, \"TABS\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(RELATIVE_TIME_OPTIONS, \"RELATIVE_TIME_OPTIONS\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(COMMON_TIME_FRAMES, \"COMMON_TIME_FRAMES\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(TIME_GRAIN_OPTIONS, \"TIME_GRAIN_OPTIONS\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(MOMENT_FORMAT, \"MOMENT_FORMAT\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(DEFAULT_SINCE, \"DEFAULT_SINCE\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(DEFAULT_UNTIL, \"DEFAULT_UNTIL\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(SEPARATOR, \"SEPARATOR\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(FREEFORM_TOOLTIP, \"FREEFORM_TOOLTIP\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(DATE_FILTER_POPOVER_STYLE, \"DATE_FILTER_POPOVER_STYLE\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(isValidMoment, \"isValidMoment\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(getStateFromSeparator, \"getStateFromSeparator\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(getStateFromCommonTimeFrame, \"getStateFromCommonTimeFrame\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(getStateFromCustomRange, \"getStateFromCustomRange\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");reactHotLoader.register(DateFilterControl, \"DateFilterControl\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/tiago/git-facilit/incubator-superset/superset-frontend/src/explore/components/controls/DateFilterControl.jsx"],"names":["React","PropTypes","Button","DropdownButton","FormControl","FormGroup","Glyphicon","InputGroup","Label","MenuItem","OverlayTrigger","Popover","Radio","Tab","Tabs","Tooltip","Datetime","moment","t","ControlHeader","PopoverSection","TYPES","DEFAULTS","CUSTOM_START_END","CUSTOM_RANGE","TABS","CUSTOM","RELATIVE_TIME_OPTIONS","LAST","NEXT","COMMON_TIME_FRAMES","TIME_GRAIN_OPTIONS","MOMENT_FORMAT","DEFAULT_SINCE","utc","startOf","subtract","format","DEFAULT_UNTIL","SEPARATOR","FREEFORM_TOOLTIP","DATE_FILTER_POPOVER_STYLE","width","propTypes","animation","bool","name","string","isRequired","label","description","onChange","func","value","height","number","onOpenDateFilterControl","onCloseDateFilterControl","endpoints","arrayOf","defaultProps","isValidMoment","s","getStateFromSeparator","since","until","split","type","tab","getStateFromCommonTimeFrame","units","common","getStateFromCustomRange","rel","num","grain","add","DateFilterControl","Component","constructor","props","state","showSinceCalendar","showUntilCalendar","sinceViewMode","untilViewMode","close","handleClick","handleClickTrigger","isValidSince","isValidUntil","onEnter","renderInput","setCustomRange","setCustomStartEnd","setTypeCustomRange","setTypeCustomStartEnd","toggleCalendar","changeTab","componentDidMount","document","addEventListener","componentWillUnmount","removeEventListener","event","key","updatedState","combinedValue","join","setState","closeCalendar","e","target","startEndSectionRef","contains","getAttribute","popoverContainer","val","refs","trigger","hide","date","nextState","renderPopover","grainOptions","timeFrames","timeFrame","replace","toLowerCase","ref","marginTop","margin","render","v","idx","values","length","body","cursor"],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  Button,\n  DropdownButton,\n  FormControl,\n  FormGroup,\n  Glyphicon,\n  InputGroup,\n  Label,\n  MenuItem,\n  OverlayTrigger,\n  Popover,\n  Radio,\n  Tab,\n  Tabs,\n  Tooltip,\n} from 'react-bootstrap';\nimport Datetime from 'react-datetime';\nimport 'react-datetime/css/react-datetime.css';\nimport moment from 'moment';\nimport { t } from '@superset-ui/translation';\n\nimport './DateFilterControl.less';\nimport ControlHeader from '../ControlHeader';\nimport PopoverSection from '../../../components/PopoverSection';\n\nconst TYPES = Object.freeze({\n  DEFAULTS: 'defaults',\n  CUSTOM_START_END: 'custom_start_end',\n  CUSTOM_RANGE: 'custom_range',\n});\nconst TABS = Object.freeze({\n  DEFAULTS: 'defaults',\n  CUSTOM: 'custom',\n});\nconst RELATIVE_TIME_OPTIONS = Object.freeze({\n  LAST: 'Last',\n  NEXT: 'Next',\n});\nconst COMMON_TIME_FRAMES = [\n  'Last day',\n  'Last week',\n  'Last month',\n  'Last quarter',\n  'Last year',\n  'No filter',\n];\nconst TIME_GRAIN_OPTIONS = [\n  'seconds',\n  'minutes',\n  'hours',\n  'days',\n  'weeks',\n  'months',\n  'years',\n];\n\nconst MOMENT_FORMAT = 'YYYY-MM-DD[T]HH:mm:ss';\nconst DEFAULT_SINCE = moment()\n  .utc()\n  .startOf('day')\n  .subtract(7, 'days')\n  .format(MOMENT_FORMAT);\nconst DEFAULT_UNTIL = moment().utc().startOf('day').format(MOMENT_FORMAT);\nconst SEPARATOR = ' : ';\nconst FREEFORM_TOOLTIP = t(\n  'Superset supports smart date parsing. Strings like `last sunday` or ' +\n    '`last october` can be used.',\n);\n\nconst DATE_FILTER_POPOVER_STYLE = { width: '250px' };\n\nconst propTypes = {\n  animation: PropTypes.bool,\n  name: PropTypes.string.isRequired,\n  label: PropTypes.string,\n  description: PropTypes.string,\n  onChange: PropTypes.func,\n  value: PropTypes.string,\n  height: PropTypes.number,\n  onOpenDateFilterControl: PropTypes.func,\n  onCloseDateFilterControl: PropTypes.func,\n  endpoints: PropTypes.arrayOf(PropTypes.string),\n};\n\nconst defaultProps = {\n  animation: true,\n  onChange: () => {},\n  value: 'Last week',\n  onOpenDateFilterControl: () => {},\n  onCloseDateFilterControl: () => {},\n};\n\nfunction isValidMoment(s) {\n  /* Moment sometimes consider invalid dates as valid, eg, \"10 years ago\" gets\n   * parsed as \"Fri Jan 01 2010 00:00:00\" local time. This function does a\n   * better check by comparing a string with a parse/format roundtrip.\n   */\n  return s === moment(s, MOMENT_FORMAT).format(MOMENT_FORMAT);\n}\n\nfunction getStateFromSeparator(value) {\n  const [since, until] = value.split(SEPARATOR, 2);\n  return { since, until, type: TYPES.CUSTOM_START_END, tab: TABS.CUSTOM };\n}\n\nfunction getStateFromCommonTimeFrame(value) {\n  const units = value.split(' ')[1] + 's';\n  return {\n    tab: TABS.DEFAULTS,\n    type: TYPES.DEFAULTS,\n    common: value,\n    since: moment()\n      .utc()\n      .startOf('day')\n      .subtract(1, units)\n      .format(MOMENT_FORMAT),\n    until: moment().utc().startOf('day').format(MOMENT_FORMAT),\n  };\n}\n\nfunction getStateFromCustomRange(value) {\n  const [rel, num, grain] = value.split(' ', 3);\n  let since;\n  let until;\n  if (rel === RELATIVE_TIME_OPTIONS.LAST) {\n    until = moment().utc().startOf('day').format(MOMENT_FORMAT);\n    since = moment()\n      .utc()\n      .startOf('day')\n      .subtract(num, grain)\n      .format(MOMENT_FORMAT);\n  } else {\n    until = moment().utc().startOf('day').add(num, grain).format(MOMENT_FORMAT);\n    since = moment().startOf('day').format(MOMENT_FORMAT);\n  }\n  return {\n    tab: TABS.CUSTOM,\n    type: TYPES.CUSTOM_RANGE,\n    common: null,\n    rel,\n    num,\n    grain,\n    since,\n    until,\n  };\n}\n\nexport default class DateFilterControl extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      type: TYPES.DEFAULTS,\n      tab: TABS.DEFAULTS,\n\n      // default time frames, for convenience\n      common: COMMON_TIME_FRAMES[0],\n\n      // \"last 7 days\", \"next 4 weeks\", etc.\n      rel: RELATIVE_TIME_OPTIONS.LAST,\n      num: '7',\n      grain: TIME_GRAIN_OPTIONS[3],\n\n      // distinct start/end values, either ISO or freeform\n      since: DEFAULT_SINCE,\n      until: DEFAULT_UNTIL,\n\n      // react-datetime has a `closeOnSelect` prop, but it's buggy... so we\n      // handle the calendar visibility here ourselves\n      showSinceCalendar: false,\n      showUntilCalendar: false,\n      sinceViewMode: 'days',\n      untilViewMode: 'days',\n    };\n\n    const value = props.value;\n    if (value.indexOf(SEPARATOR) >= 0) {\n      this.state = { ...this.state, ...getStateFromSeparator(value) };\n    } else if (COMMON_TIME_FRAMES.indexOf(value) >= 0) {\n      this.state = { ...this.state, ...getStateFromCommonTimeFrame(value) };\n    } else {\n      this.state = { ...this.state, ...getStateFromCustomRange(value) };\n    }\n\n    this.close = this.close.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.handleClickTrigger = this.handleClickTrigger.bind(this);\n    this.isValidSince = this.isValidSince.bind(this);\n    this.isValidUntil = this.isValidUntil.bind(this);\n    this.onEnter = this.onEnter.bind(this);\n    this.renderInput = this.renderInput.bind(this);\n    this.setCustomRange = this.setCustomRange.bind(this);\n    this.setCustomStartEnd = this.setCustomStartEnd.bind(this);\n    this.setTypeCustomRange = this.setTypeCustomRange.bind(this);\n    this.setTypeCustomStartEnd = this.setTypeCustomStartEnd.bind(this);\n    this.toggleCalendar = this.toggleCalendar.bind(this);\n    this.changeTab = this.changeTab.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this.handleClick);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.handleClick);\n  }\n  onEnter(event) {\n    if (event.key === 'Enter') {\n      this.close();\n    }\n  }\n  setCustomRange(key, value) {\n    const updatedState = { ...this.state, [key]: value };\n    const combinedValue = [\n      updatedState.rel,\n      updatedState.num,\n      updatedState.grain,\n    ].join(' ');\n    this.setState(getStateFromCustomRange(combinedValue));\n  }\n  setCustomStartEnd(key, value) {\n    const closeCalendar =\n      (key === 'since' && this.state.sinceViewMode === 'days') ||\n      (key === 'until' && this.state.untilViewMode === 'days');\n    this.setState({\n      type: TYPES.CUSTOM_START_END,\n      [key]: typeof value === 'string' ? value : value.format(MOMENT_FORMAT),\n      showSinceCalendar: this.state.showSinceCalendar && !closeCalendar,\n      showUntilCalendar: this.state.showUntilCalendar && !closeCalendar,\n      sinceViewMode: closeCalendar ? 'days' : this.state.sinceViewMode,\n      untilViewMode: closeCalendar ? 'days' : this.state.untilViewMode,\n    });\n  }\n  setTypeCustomRange() {\n    this.setState({ type: TYPES.CUSTOM_RANGE });\n  }\n  setTypeCustomStartEnd() {\n    this.setState({ type: TYPES.CUSTOM_START_END });\n  }\n\n  changeTab() {\n    const { tab } = this.state;\n    if (tab === TABS.CUSTOM) {\n      this.setState({ tab: TABS.DEFAULTS });\n    } else if (tab === TABS.DEFAULTS) {\n      this.setState({ tab: TABS.CUSTOM });\n    }\n  }\n\n  handleClick(e) {\n    const target = e.target;\n    // switch to `TYPES.CUSTOM_START_END` when the calendar is clicked\n    if (this.startEndSectionRef && this.startEndSectionRef.contains(target)) {\n      this.setTypeCustomStartEnd();\n    }\n\n    // if user click outside popover, popover will hide and we will call onCloseDateFilterControl,\n    // but need to exclude OverlayTrigger component to avoid handle click events twice.\n    if (target.getAttribute('name') !== 'popover-trigger') {\n      if (this.popoverContainer && !this.popoverContainer.contains(target)) {\n        this.props.onCloseDateFilterControl();\n      }\n    }\n  }\n\n  handleClickTrigger() {\n    // when user clicks OverlayTrigger,\n    // popoverContainer component will be created after handleClickTrigger\n    // and before handleClick handler\n    if (!this.popoverContainer) {\n      this.props.onOpenDateFilterControl();\n    } else {\n      this.props.onCloseDateFilterControl();\n    }\n  }\n\n  close() {\n    let val;\n    if (\n      this.state.type === TYPES.DEFAULTS ||\n      this.state.tab === TABS.DEFAULTS\n    ) {\n      val = this.state.common;\n    } else if (this.state.type === TYPES.CUSTOM_RANGE) {\n      val = `${this.state.rel} ${this.state.num} ${this.state.grain}`;\n    } else {\n      val = [this.state.since, this.state.until].join(SEPARATOR);\n    }\n    this.props.onCloseDateFilterControl();\n    this.props.onChange(val);\n    this.refs.trigger.hide();\n    this.setState({ showSinceCalendar: false, showUntilCalendar: false });\n  }\n  isValidSince(date) {\n    return (\n      !isValidMoment(this.state.until) ||\n      date <= moment(this.state.until, MOMENT_FORMAT)\n    );\n  }\n  isValidUntil(date) {\n    return (\n      !isValidMoment(this.state.since) ||\n      date >= moment(this.state.since, MOMENT_FORMAT)\n    );\n  }\n  toggleCalendar(key) {\n    const nextState = {};\n    if (key === 'showSinceCalendar') {\n      nextState.showSinceCalendar = !this.state.showSinceCalendar;\n      if (!this.state.showSinceCalendar) {\n        nextState.showUntilCalendar = false;\n      }\n    } else if (key === 'showUntilCalendar') {\n      nextState.showUntilCalendar = !this.state.showUntilCalendar;\n      if (!this.state.showUntilCalendar) {\n        nextState.showSinceCalendar = false;\n      }\n    }\n    this.setState(nextState);\n  }\n  renderInput(props, key) {\n    return (\n      <FormGroup>\n        <InputGroup bsSize=\"small\">\n          <FormControl\n            {...props}\n            type=\"text\"\n            onKeyPress={this.onEnter}\n            onFocus={this.setTypeCustomStartEnd}\n            onClick={() => {}}\n          />\n          <InputGroup.Button onClick={() => this.toggleCalendar(key)}>\n            <Button>\n              <i className=\"fa fa-calendar\" />\n            </Button>\n          </InputGroup.Button>\n        </InputGroup>\n      </FormGroup>\n    );\n  }\n  renderPopover() {\n    const grainOptions = TIME_GRAIN_OPTIONS.map(grain => (\n      <MenuItem\n        onSelect={value => this.setCustomRange('grain', value)}\n        key={grain}\n        eventKey={grain}\n        active={grain === this.state.grain}\n      >\n        {grain}\n      </MenuItem>\n    ));\n    const timeFrames = COMMON_TIME_FRAMES.map(timeFrame => {\n      const nextState = getStateFromCommonTimeFrame(timeFrame);\n      const endpoints = this.props.endpoints;\n      return (\n        <OverlayTrigger\n          key={timeFrame}\n          placement=\"left\"\n          overlay={\n            <Tooltip id={`tooltip-${timeFrame}`}>\n              {nextState.since} {endpoints && `(${endpoints[0]})`}\n              <br />\n              {nextState.until} {endpoints && `(${endpoints[1]})`}\n            </Tooltip>\n          }\n        >\n          <div>\n            <Radio\n              key={timeFrame.replace(' ', '').toLowerCase()}\n              checked={this.state.common === timeFrame}\n              onChange={() => this.setState(nextState)}\n            >\n              {timeFrame}\n            </Radio>\n          </div>\n        </OverlayTrigger>\n      );\n    });\n    return (\n      <Popover id=\"filter-popover\" placement=\"top\" positionTop={0}>\n        <div\n          style={DATE_FILTER_POPOVER_STYLE}\n          ref={ref => {\n            this.popoverContainer = ref;\n          }}\n        >\n          <Tabs\n            defaultActiveKey={this.state.tab === TABS.DEFAULTS ? 1 : 2}\n            id=\"type\"\n            className=\"time-filter-tabs\"\n            onSelect={this.changeTab}\n          >\n            <Tab eventKey={1} title=\"Defaults\">\n              <FormGroup>{timeFrames}</FormGroup>\n            </Tab>\n            <Tab eventKey={2} title=\"Custom\">\n              <FormGroup>\n                <PopoverSection\n                  title=\"Relative to today\"\n                  isSelected={this.state.type === TYPES.CUSTOM_RANGE}\n                  onSelect={this.setTypeCustomRange}\n                >\n                  <div\n                    className=\"clearfix centered\"\n                    style={{ marginTop: '12px' }}\n                  >\n                    <div\n                      style={{ width: '60px', marginTop: '-4px' }}\n                      className=\"input-inline\"\n                    >\n                      <DropdownButton\n                        bsSize=\"small\"\n                        componentClass={InputGroup.Button}\n                        id=\"input-dropdown-rel\"\n                        title={this.state.rel}\n                        onFocus={this.setTypeCustomRange}\n                      >\n                        <MenuItem\n                          onSelect={value => this.setCustomRange('rel', value)}\n                          key={RELATIVE_TIME_OPTIONS.LAST}\n                          eventKey={RELATIVE_TIME_OPTIONS.LAST}\n                          active={this.state.rel === RELATIVE_TIME_OPTIONS.LAST}\n                        >\n                          Last\n                        </MenuItem>\n                        <MenuItem\n                          onSelect={value => this.setCustomRange('rel', value)}\n                          key={RELATIVE_TIME_OPTIONS.NEXT}\n                          eventKey={RELATIVE_TIME_OPTIONS.NEXT}\n                          active={this.state.rel === RELATIVE_TIME_OPTIONS.NEXT}\n                        >\n                          Next\n                        </MenuItem>\n                      </DropdownButton>\n                    </div>\n                    <div\n                      style={{ width: '60px', marginTop: '-4px' }}\n                      className=\"input-inline m-l-5 m-r-3\"\n                    >\n                      <FormControl\n                        bsSize=\"small\"\n                        type=\"text\"\n                        onChange={event =>\n                          this.setCustomRange('num', event.target.value)\n                        }\n                        onFocus={this.setTypeCustomRange}\n                        onKeyPress={this.onEnter}\n                        value={this.state.num}\n                        style={{ height: '30px' }}\n                      />\n                    </div>\n                    <div\n                      style={{ width: '90px', marginTop: '-4px' }}\n                      className=\"input-inline\"\n                    >\n                      <DropdownButton\n                        bsSize=\"small\"\n                        componentClass={InputGroup.Button}\n                        id=\"input-dropdown-grain\"\n                        title={this.state.grain}\n                        onFocus={this.setTypeCustomRange}\n                      >\n                        {grainOptions}\n                      </DropdownButton>\n                    </div>\n                  </div>\n                </PopoverSection>\n                <PopoverSection\n                  title=\"Start / end\"\n                  isSelected={this.state.type === TYPES.CUSTOM_START_END}\n                  onSelect={this.setTypeCustomStartEnd}\n                  info={FREEFORM_TOOLTIP}\n                >\n                  <div\n                    ref={ref => {\n                      this.startEndSectionRef = ref;\n                    }}\n                  >\n                    <InputGroup>\n                      <div style={{ margin: '5px 0' }}>\n                        <Datetime\n                          value={this.state.since}\n                          defaultValue={this.state.since}\n                          viewDate={this.state.since}\n                          onChange={value =>\n                            this.setCustomStartEnd('since', value)\n                          }\n                          isValidDate={this.isValidSince}\n                          onClick={this.setTypeCustomStartEnd}\n                          renderInput={props =>\n                            this.renderInput(props, 'showSinceCalendar')\n                          }\n                          open={this.state.showSinceCalendar}\n                          viewMode={this.state.sinceViewMode}\n                          onViewModeChange={sinceViewMode =>\n                            this.setState({ sinceViewMode })\n                          }\n                        />\n                      </div>\n                      <div style={{ margin: '5px 0' }}>\n                        <Datetime\n                          value={this.state.until}\n                          defaultValue={this.state.until}\n                          viewDate={this.state.until}\n                          onChange={value =>\n                            this.setCustomStartEnd('until', value)\n                          }\n                          isValidDate={this.isValidUntil}\n                          onClick={this.setTypeCustomStartEnd}\n                          renderInput={props =>\n                            this.renderInput(props, 'showUntilCalendar')\n                          }\n                          open={this.state.showUntilCalendar}\n                          viewMode={this.state.untilViewMode}\n                          onViewModeChange={untilViewMode =>\n                            this.setState({ untilViewMode })\n                          }\n                        />\n                      </div>\n                    </InputGroup>\n                  </div>\n                </PopoverSection>\n              </FormGroup>\n            </Tab>\n          </Tabs>\n          <div className=\"clearfix\">\n            <Button\n              bsSize=\"small\"\n              className=\"float-right ok\"\n              bsStyle=\"primary\"\n              onClick={this.close}\n            >\n              Ok\n            </Button>\n          </div>\n        </div>\n      </Popover>\n    );\n  }\n  render() {\n    let value = this.props.value || defaultProps.value;\n    const endpoints = this.props.endpoints;\n    value = value\n      .split(SEPARATOR)\n      .map(\n        (v, idx, values) =>\n          (v.replace('T00:00:00', '') || (idx === 0 ? '-∞' : '∞')) +\n          (endpoints && values.length > 1 ? ` (${endpoints[idx]})` : ''),\n      )\n      .join(SEPARATOR);\n    return (\n      <div>\n        <ControlHeader {...this.props} />\n        <OverlayTrigger\n          animation={this.props.animation}\n          container={document.body}\n          trigger=\"click\"\n          rootClose\n          ref=\"trigger\"\n          placement=\"right\"\n          overlay={this.renderPopover()}\n          onClick={this.handleClickTrigger}\n        >\n          <Label name=\"popover-trigger\" style={{ cursor: 'pointer' }}>\n            {value}\n          </Label>\n        </OverlayTrigger>\n      </div>\n    );\n  }\n}\n\nDateFilterControl.propTypes = propTypes;\nDateFilterControl.defaultProps = defaultProps;\n"]},"metadata":{},"sourceType":"module"}