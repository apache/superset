{"ast":null,"code":"import \"core-js/modules/es.regexp.to-string\";import _Number$isNaN from \"@babel/runtime-corejs3/core-js-stable/number/is-nan\";import _parseInt from \"@babel/runtime-corejs3/core-js-stable/parse-int\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";var _jsxFileName = \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/LimitControl.jsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Licensed to the Apache Software Foundation (ASF) under one\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * or more contributor license agreements.  See the NOTICE file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * distributed with this work for additional information\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * regarding copyright ownership.  The ASF licenses this file\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * to you under the Apache License, Version 2.0 (the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * \"License\"); you may not use this file except in compliance\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * with the License.  You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               *   http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * Unless required by applicable law or agreed to in writing,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * software distributed under the License is distributed on an\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * KIND, either express or implied.  See the License for the\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * specific language governing permissions and limitations\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               * under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {\nButton,\nLabel,\nFormGroup,\nFormControl,\nOverlay,\nPopover } from\n'react-bootstrap';\nimport { t } from '@superset-ui/translation';\n\nimport ControlHeader from '../../explore/components/ControlHeader';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst propTypes = {\n  value: PropTypes.number,\n  defaultQueryLimit: PropTypes.number.isRequired,\n  maxRow: PropTypes.number.isRequired,\n  onChange: PropTypes.func.isRequired };\n\n\nexport default class LimitControl extends React.PureComponent {\n  constructor(props) {var _context, _context2, _context3;\n    super(props);\n    const { value, defaultQueryLimit } = props;\n    this.state = {\n      textValue: (value || defaultQueryLimit).toString(),\n      showOverlay: false };\n\n    this.handleHide = _bindInstanceProperty(_context = this.handleHide).call(_context, this);\n    this.handleToggle = _bindInstanceProperty(_context2 = this.handleToggle).call(_context2, this);\n    this.submitAndClose = _bindInstanceProperty(_context3 = this.submitAndClose).call(_context3, this);\n  }\n\n  setValueAndClose(val) {\n    this.setState({ textValue: val }, this.submitAndClose);\n  }\n\n  submitAndClose() {\n    const value =\n    _parseInt(this.state.textValue, 10) || this.props.defaultQueryLimit;\n    this.props.onChange(value);\n    this.setState({ showOverlay: false });\n  }\n\n  isValidLimit(limit) {\n    const value = _parseInt(limit, 10);\n    return !(\n    _Number$isNaN(value) ||\n    value <= 0 ||\n    this.props.maxRow && value > this.props.maxRow);\n\n  }\n\n  handleToggle() {\n    this.setState({ showOverlay: !this.state.showOverlay });\n  }\n\n  handleHide() {\n    this.setState({ showOverlay: false });\n  }\n\n  renderPopover() {var _context4;\n    const textValue = this.state.textValue;\n    const isValid = this.isValidLimit(textValue);\n    const errorMsg =\n    t('Row limit must be positive integer') + (\n    this.props.maxRow ?\n    t(' and not greater than %s', this.props.maxRow) :\n    '');\n    return (\n      ___EmotionJSX(Popover, { id: \"sqllab-limit-results\", __source: { fileName: _jsxFileName, lineNumber: 90 }, __self: this },\n      ___EmotionJSX(\"div\", { style: { width: '100px' }, __source: { fileName: _jsxFileName, lineNumber: 91 }, __self: this },\n      ___EmotionJSX(ControlHeader, {\n        label: t('Row limit'),\n        validationErrors: !isValid ? [t(errorMsg)] : [], __source: { fileName: _jsxFileName, lineNumber: 92 }, __self: this }),\n\n      ___EmotionJSX(FormGroup, { __source: { fileName: _jsxFileName, lineNumber: 96 }, __self: this },\n      ___EmotionJSX(FormControl, {\n        type: \"text\",\n        value: textValue,\n        placeholder: t(\"Max: \" + this.props.maxRow),\n        bsSize: \"small\",\n        onChange: e => this.setState({ textValue: e.target.value }), __source: { fileName: _jsxFileName, lineNumber: 97 }, __self: this })),\n\n\n      ___EmotionJSX(\"div\", { className: \"clearfix\", __source: { fileName: _jsxFileName, lineNumber: 105 }, __self: this },\n      ___EmotionJSX(Button, {\n        bsSize: \"small\",\n        bsStyle: \"primary\",\n        className: \"float-left ok\",\n        disabled: !isValid,\n        onClick: this.submitAndClose, __source: { fileName: _jsxFileName, lineNumber: 106 }, __self: this }, \"Ok\"),\n\n\n\n      ___EmotionJSX(Button, {\n        bsSize: \"small\",\n        className: \"float-right reset\",\n        onClick: _bindInstanceProperty(_context4 = this.setValueAndClose).call(_context4,\n        this,\n        this.props.defaultQueryLimit.toString()), __source: { fileName: _jsxFileName, lineNumber: 115 }, __self: this }, \"Reset\")))));\n\n\n\n\n\n\n\n\n  }\n\n  render() {\n    return (\n      ___EmotionJSX(\"div\", { __source: { fileName: _jsxFileName, lineNumber: 133 }, __self: this },\n      ___EmotionJSX(Label, { style: { cursor: 'pointer' }, onClick: this.handleToggle, __source: { fileName: _jsxFileName, lineNumber: 134 }, __self: this }, \"LIMIT \",\n      this.props.value || this.props.maxRow),\n\n      ___EmotionJSX(Overlay, {\n        rootClose: true,\n        show: this.state.showOverlay,\n        onHide: this.handleHide,\n        trigger: \"click\",\n        placement: \"right\",\n        target: this, __source: { fileName: _jsxFileName, lineNumber: 137 }, __self: this },\n\n      this.renderPopover())));\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nLimitControl.propTypes = propTypes;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/LimitControl.jsx\");reactHotLoader.register(LimitControl, \"LimitControl\", \"/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/LimitControl.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/tiago/git-facilit/incubator-superset/superset-frontend/src/SqlLab/components/LimitControl.jsx"],"names":["React","PropTypes","Button","Label","FormGroup","FormControl","Overlay","Popover","t","ControlHeader","propTypes","value","number","defaultQueryLimit","isRequired","maxRow","onChange","func","LimitControl","PureComponent","constructor","props","state","textValue","toString","showOverlay","handleHide","handleToggle","submitAndClose","setValueAndClose","val","setState","isValidLimit","limit","renderPopover","isValid","errorMsg","width","e","target","render","cursor"],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  Button,\n  Label,\n  FormGroup,\n  FormControl,\n  Overlay,\n  Popover,\n} from 'react-bootstrap';\nimport { t } from '@superset-ui/translation';\n\nimport ControlHeader from '../../explore/components/ControlHeader';\n\nconst propTypes = {\n  value: PropTypes.number,\n  defaultQueryLimit: PropTypes.number.isRequired,\n  maxRow: PropTypes.number.isRequired,\n  onChange: PropTypes.func.isRequired,\n};\n\nexport default class LimitControl extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    const { value, defaultQueryLimit } = props;\n    this.state = {\n      textValue: (value || defaultQueryLimit).toString(),\n      showOverlay: false,\n    };\n    this.handleHide = this.handleHide.bind(this);\n    this.handleToggle = this.handleToggle.bind(this);\n    this.submitAndClose = this.submitAndClose.bind(this);\n  }\n\n  setValueAndClose(val) {\n    this.setState({ textValue: val }, this.submitAndClose);\n  }\n\n  submitAndClose() {\n    const value =\n      parseInt(this.state.textValue, 10) || this.props.defaultQueryLimit;\n    this.props.onChange(value);\n    this.setState({ showOverlay: false });\n  }\n\n  isValidLimit(limit) {\n    const value = parseInt(limit, 10);\n    return !(\n      Number.isNaN(value) ||\n      value <= 0 ||\n      (this.props.maxRow && value > this.props.maxRow)\n    );\n  }\n\n  handleToggle() {\n    this.setState({ showOverlay: !this.state.showOverlay });\n  }\n\n  handleHide() {\n    this.setState({ showOverlay: false });\n  }\n\n  renderPopover() {\n    const textValue = this.state.textValue;\n    const isValid = this.isValidLimit(textValue);\n    const errorMsg =\n      t('Row limit must be positive integer') +\n      (this.props.maxRow\n        ? t(' and not greater than %s', this.props.maxRow)\n        : '');\n    return (\n      <Popover id=\"sqllab-limit-results\">\n        <div style={{ width: '100px' }}>\n          <ControlHeader\n            label={t('Row limit')}\n            validationErrors={!isValid ? [t(errorMsg)] : []}\n          />\n          <FormGroup>\n            <FormControl\n              type=\"text\"\n              value={textValue}\n              placeholder={t(`Max: ${this.props.maxRow}`)}\n              bsSize=\"small\"\n              onChange={e => this.setState({ textValue: e.target.value })}\n            />\n          </FormGroup>\n          <div className=\"clearfix\">\n            <Button\n              bsSize=\"small\"\n              bsStyle=\"primary\"\n              className=\"float-left ok\"\n              disabled={!isValid}\n              onClick={this.submitAndClose}\n            >\n              Ok\n            </Button>\n            <Button\n              bsSize=\"small\"\n              className=\"float-right reset\"\n              onClick={this.setValueAndClose.bind(\n                this,\n                this.props.defaultQueryLimit.toString(),\n              )}\n            >\n              Reset\n            </Button>\n          </div>\n        </div>\n      </Popover>\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <Label style={{ cursor: 'pointer' }} onClick={this.handleToggle}>\n          LIMIT {this.props.value || this.props.maxRow}\n        </Label>\n        <Overlay\n          rootClose\n          show={this.state.showOverlay}\n          onHide={this.handleHide}\n          trigger=\"click\"\n          placement=\"right\"\n          target={this}\n        >\n          {this.renderPopover()}\n        </Overlay>\n      </div>\n    );\n  }\n}\n\nLimitControl.propTypes = propTypes;\n"]},"metadata":{},"sourceType":"module"}