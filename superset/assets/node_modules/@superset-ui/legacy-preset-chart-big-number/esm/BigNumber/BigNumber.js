function _inheritsLoose(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */ /* eslint-disable sort-keys, react/forbid-prop-types */import React from"react";import PropTypes from"prop-types";import shortid from"shortid";import{XYChart,AreaSeries,CrossHair,LinearGradient}from"@data-ui/xy-chart";import{BRAND_COLOR}from"@superset-ui/color";import{smartDateVerboseFormatter}from"@superset-ui/time-format";import{computeMaxFontSize}from"@superset-ui/dimension";import"./BigNumber.css";var CHART_MARGIN={top:4,right:4,bottom:4,left:4},PROPORTION={HEADER:.3,SUBHEADER:.125,TRENDLINE:.3};export function renderTooltipFactory(a){function b(b){var c=b.datum,d=c.x,e=c.y,f=smartDateVerboseFormatter(d),g=a(e);return React.createElement("div",{style:{padding:"4px 8px"}},f,React.createElement("br",null),React.createElement("strong",null,g))}return b.propTypes={datum:PropTypes.shape({x:PropTypes.instanceOf(Date),y:PropTypes.number}).isRequired},b}function identity(a){return a}var propTypes={className:PropTypes.string,width:PropTypes.number.isRequired,height:PropTypes.number.isRequired,bigNumber:PropTypes.number.isRequired,formatBigNumber:PropTypes.func,headerFontSize:PropTypes.number,subheader:PropTypes.string,subheaderFontSize:PropTypes.number,showTrendLine:PropTypes.bool,startYAxisAtZero:PropTypes.bool,trendLineData:PropTypes.array,mainColor:PropTypes.string,renderTooltip:PropTypes.func},defaultProps={className:"",formatBigNumber:identity,headerFontSize:PROPORTION.HEADER,subheader:"",subheaderFontSize:PROPORTION.SUBHEADER,showTrendLine:!1,startYAxisAtZero:!0,trendLineData:null,mainColor:BRAND_COLOR,renderTooltip:renderTooltipFactory(identity)},BigNumberVis=/*#__PURE__*/function(a){function b(b){var c;return c=a.call(this,b)||this,c.gradientId=shortid.generate(),c}_inheritsLoose(b,a);var c=b.prototype;return c.getClassName=function e(){var a=this.props,b=a.className,c=a.showTrendLine,d="superset-legacy-chart-big-number "+b;return c?d:d+" no-trendline"},c.createTemporaryContainer=function b(){var a=document.createElement("div");// and not visible
return a.className=this.getClassName(),a.style.position="absolute",a.style.opacity=0,a},c.renderHeader=function i(a){var b=this.props,c=b.bigNumber,d=b.formatBigNumber,e=b.width,f=d(c),g=this.createTemporaryContainer();document.body.appendChild(g);var h=computeMaxFontSize({text:f,maxWidth:Math.floor(e),maxHeight:a,className:"header-line",container:g});return document.body.removeChild(g),React.createElement("div",{className:"header-line",style:{fontSize:h,height:a}},React.createElement("span",null,f))},c.renderSubheader=function f(a){var b=this.props,c=b.subheader,d=b.width,e=0;if(c){var g=this.createTemporaryContainer();document.body.appendChild(g),e=computeMaxFontSize({text:c,maxWidth:Math.floor(d),maxHeight:a,className:"subheader-line",container:g}),document.body.removeChild(g)}return React.createElement("div",{className:"subheader-line",style:{fontSize:e,height:a}},c)},c.renderTrendline=function i(a){var b=this.props,c=b.width,d=b.trendLineData,e=b.mainColor,f=b.subheader,g=b.renderTooltip,h=b.startYAxisAtZero;return React.createElement(XYChart,{ariaLabel:"Big number visualization "+f,xScale:{type:"timeUtc"},yScale:{type:"linear",includeZero:h},width:Math.floor(c),height:a,margin:CHART_MARGIN,renderTooltip:g,snapTooltipToDataX:!0},React.createElement(LinearGradient,{id:this.gradientId,from:e,to:"#fff"}),React.createElement(AreaSeries,{data:d,fill:"url(#"+this.gradientId+")",stroke:e}),React.createElement(CrossHair,{stroke:e,circleFill:e,circleStroke:"#fff",showHorizontalLine:!1,fullHeight:!0,strokeDasharray:"5,2"}))},c.render=function h(){var a=this.props,b=a.showTrendLine,c=a.height,d=a.headerFontSize,e=a.subheaderFontSize,f=this.getClassName();if(b){var g=Math.floor(PROPORTION.TRENDLINE*c);return React.createElement("div",{className:f},React.createElement("div",{className:"text-container",style:{height:c-g}},this.renderHeader(Math.ceil(d*c)),this.renderSubheader(Math.ceil(e*c))),this.renderTrendline(g))}return React.createElement("div",{className:f,style:{height:c}},this.renderHeader(Math.ceil(d*c)),this.renderSubheader(Math.ceil(e*c)))},b}(React.PureComponent);BigNumberVis.propTypes=propTypes,BigNumberVis.defaultProps=defaultProps;export default BigNumberVis;