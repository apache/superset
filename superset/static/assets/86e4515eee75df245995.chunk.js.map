{"version":3,"file":"86e4515eee75df245995.chunk.js","mappings":"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","sources":["webpack://superset/./plugins/legacy-plugin-chart-chord/src/Chord.js","webpack://superset/./plugins/legacy-plugin-chart-chord/src/ReactChord.jsx","webpack://superset/./packages/superset-ui-core/src/chart/components/reactify.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign, react/sort-prop-types */\nimport d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport {\n  getNumberFormatter,\n  CategoricalColorNamespace,\n} from '@superset-ui/core';\n\nconst propTypes = {\n  data: PropTypes.shape({\n    matrix: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.number)),\n    nodes: PropTypes.arrayOf(PropTypes.string),\n  }),\n  width: PropTypes.number,\n  height: PropTypes.number,\n  colorScheme: PropTypes.string,\n  numberFormat: PropTypes.string,\n};\n\nfunction Chord(element, props) {\n  const { data, width, height, numberFormat, colorScheme, sliceId } = props;\n\n  element.innerHTML = '';\n\n  const div = d3.select(element);\n  div.classed('superset-legacy-chart-chord', true);\n  const { nodes, matrix } = data;\n  const f = getNumberFormatter(numberFormat);\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme);\n\n  const outerRadius = Math.min(width, height) / 2 - 10;\n  const innerRadius = outerRadius - 24;\n\n  let chord;\n\n  const arc = d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius);\n\n  const layout = d3.layout\n    .chord()\n    .padding(0.04)\n    .sortSubgroups(d3.descending)\n    .sortChords(d3.descending);\n\n  const path = d3.svg.chord().radius(innerRadius);\n\n  const svg = div\n    .append('svg')\n    .attr('width', width)\n    .attr('height', height)\n    .on('mouseout', () => chord.classed('fade', false))\n    .append('g')\n    .attr('id', 'circle')\n    .attr('transform', `translate(${width / 2}, ${height / 2})`);\n\n  svg.append('circle').attr('r', outerRadius);\n\n  // Compute the chord layout.\n  layout.matrix(matrix);\n\n  const group = svg\n    .selectAll('.group')\n    .data(layout.groups)\n    .enter()\n    .append('g')\n    .attr('class', 'group')\n    .on('mouseover', (d, i) => {\n      chord.classed('fade', p => p.source.index !== i && p.target.index !== i);\n    });\n\n  // Add a mouseover title.\n  group.append('title').text((d, i) => `${nodes[i]}: ${f(d.value)}`);\n\n  // Add the group arc.\n  const groupPath = group\n    .append('path')\n    .attr('id', (d, i) => `group${i}`)\n    .attr('d', arc)\n    .style('fill', (d, i) => colorFn(nodes[i], sliceId));\n\n  // Add a text label.\n  const groupText = group.append('text').attr('x', 6).attr('dy', 15);\n\n  groupText\n    .append('textPath')\n    .attr('xlink:href', (d, i) => `#group${i}`)\n    .text((d, i) => nodes[i]);\n  // Remove the labels that don't fit. :(\n  groupText\n    .filter(function filter(d, i) {\n      return (\n        groupPath[0][i].getTotalLength() / 2 - 16 < this.getComputedTextLength()\n      );\n    })\n    .remove();\n\n  // Add the chords.\n  chord = svg\n    .selectAll('.chord')\n    .data(layout.chords)\n    .enter()\n    .append('path')\n    .attr('class', 'chord')\n    .on('mouseover', d => {\n      chord.classed('fade', p => p !== d);\n    })\n    .style('fill', d => colorFn(nodes[d.source.index], sliceId))\n    .attr('d', path);\n\n  // Add an elaborate mouseover title for each chord.\n  chord\n    .append('title')\n    .text(\n      d =>\n        `${nodes[d.source.index]} → ${nodes[d.target.index]}: ${f(\n          d.source.value,\n        )}\\n${nodes[d.target.index]} → ${nodes[d.source.index]}: ${f(\n          d.target.value,\n        )}`,\n    );\n}\n\nChord.displayName = 'Chord';\nChord.propTypes = propTypes;\n\nexport default Chord;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { reactify, styled } from '@superset-ui/core';\nimport PropTypes from 'prop-types';\nimport Component from './Chord';\n\nconst ReactComponent = reactify(Component);\n\nconst Chord = ({ className, ...otherProps }) => (\n  <div className={className}>\n    <ReactComponent {...otherProps} />\n  </div>\n);\n\nChord.defaultProps = {\n  otherProps: {},\n};\n\nChord.propTypes = {\n  className: PropTypes.string.isRequired,\n  otherProps: PropTypes.objectOf(PropTypes.any),\n};\n\nexport default styled(Chord)`\n  ${({ theme }) => `\n    .superset-legacy-chart-chord svg #circle circle {\n      fill: none;\n      pointer-events: all;\n    }\n    .superset-legacy-chart-chord svg .group path {\n      fill-opacity: ${theme.opacity.mediumHeavy};\n    }\n    .superset-legacy-chart-chord svg path.chord {\n      stroke: ${theme.colors.grayscale.dark2};\n      stroke-width: 0.25px;\n    }\n    .superset-legacy-chart-chord svg #circle:hover path.fade {\n      opacity:  ${theme.opacity.light};\n    }\n  `}\n`;\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React from 'react';\n\n// TODO: Note that id and className can collide between Props and ReactifyProps\n// leading to (likely) unexpected behaviors. We should either require Props to not\n// contain an id/className, or not combine them (via intersection), instead preferring\n// wrapping (composition). As an example:\n// interface MyProps {\n//   id: number;\n// }\n// function myRender(container: HTMLDivElement, props: Readonly<MyProps>): void {\n//   props.id // unusable: id is string & number\n// }\n// new (reactify(myRender))({ id: 5 }); // error: id has to be string & number\n\nexport type ReactifyProps = {\n  id?: string;\n  className?: string;\n};\n\n// TODO: add more React lifecycle callbacks as needed\nexport type LifeCycleCallbacks = {\n  componentWillUnmount?: () => void;\n};\n\nexport interface RenderFuncType<Props> {\n  (container: HTMLDivElement, props: Readonly<Props & ReactifyProps>): void;\n  displayName?: string;\n  defaultProps?: Partial<Props & ReactifyProps>;\n  propTypes?: React.WeakValidationMap<Props & ReactifyProps>;\n}\n\nexport default function reactify<Props extends object>(\n  renderFn: RenderFuncType<Props>,\n  callbacks?: LifeCycleCallbacks,\n): React.ComponentClass<Props & ReactifyProps> {\n  class ReactifiedComponent extends React.Component<Props & ReactifyProps> {\n    container?: HTMLDivElement;\n\n    constructor(props: Props & ReactifyProps) {\n      super(props);\n      this.setContainerRef = this.setContainerRef.bind(this);\n    }\n\n    componentDidMount() {\n      this.execute();\n    }\n\n    componentDidUpdate() {\n      this.execute();\n    }\n\n    componentWillUnmount() {\n      this.container = undefined;\n      if (callbacks?.componentWillUnmount) {\n        callbacks.componentWillUnmount.bind(this)();\n      }\n    }\n\n    setContainerRef(ref: HTMLDivElement) {\n      this.container = ref;\n    }\n\n    execute() {\n      if (this.container) {\n        renderFn(this.container, this.props);\n      }\n    }\n\n    render() {\n      const { id, className } = this.props;\n\n      return <div ref={this.setContainerRef} id={id} className={className} />;\n    }\n  }\n\n  const ReactifiedClass: React.ComponentClass<Props & ReactifyProps> =\n    ReactifiedComponent;\n\n  if (renderFn.displayName) {\n    ReactifiedClass.displayName = renderFn.displayName;\n  }\n  // eslint-disable-next-line react/forbid-foreign-prop-types\n  if (renderFn.propTypes) {\n    ReactifiedClass.propTypes = {\n      ...ReactifiedClass.propTypes,\n      ...renderFn.propTypes,\n    };\n  }\n  if (renderFn.defaultProps) {\n    ReactifiedClass.defaultProps = renderFn.defaultProps;\n  }\n\n  return ReactifiedComponent;\n}\n"],"names":["propTypes","data","PropTypes","matrix","nodes","width","height","colorScheme","numberFormat","Chord","element","props","sliceId","innerHTML","div","d3","classed","f","getNumberFormatter","colorFn","CategoricalColorNamespace","getScale","outerRadius","Math","min","innerRadius","chord","arc","layout","padding","sortSubgroups","sortChords","path","radius","svg","append","attr","on","group","selectAll","groups","enter","d","i","p","source","index","target","text","value","groupPath","style","groupText","filter","getTotalLength","this","getComputedTextLength","remove","chords","displayName","ReactComponent","reactify","Component","className","otherProps","defaultProps","styled","theme","opacity","mediumHeavy","colors","grayscale","dark2","light","renderFn","callbacks","ReactifiedComponent","React","constructor","super","container","setContainerRef","bind","componentDidMount","execute","componentDidUpdate","componentWillUnmount","undefined","ref","render","id","ReactifiedClass"],"sourceRoot":""}