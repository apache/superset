"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5334],{67521:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(78580),l=n.n(r),a=(n(67294),n(63475)),i=n(11965);function c(e){let{height:t,width:n,echartOptions:r,formData:c,onContextMenu:s,setDataMask:u,filterState:d,emitCrossFilters:o,refs:h}=e;const f=e=>{if(null==e||!e.name||null==e||!e.col)return;const{name:t,col:n}=e,r=Object.values((null==d?void 0:d.selectedValues)||{});let a;return a=l()(r).call(r,t)?r.filter((e=>e!==t)):[t],{dataMask:{extraFormData:{filters:a.length?[{col:n,op:"IN",val:a}]:[]},filterState:{value:a.length?a:null,selectedValues:a.length?a:null}},isCurrentValueSelected:l()(r).call(r,t)}},v={click:e=>{var t;if(!o||!u)return;e.event.stop();const n=r.series[0].data.find((t=>t.id===e.data.id)),l=null==(t=f(n))?void 0:t.dataMask;l&&u(l)},contextmenu:e=>{if(s){e.event.stop();const t=e.event.event,n=r.series[0].data,l="node"===e.dataType?(t=>{const n=t.find((t=>t.id===e.data.id));if(null!=n&&n.name)return[{col:n.col,op:"==",val:n.name,formattedVal:n.name}]})(n):(t=>{var n,r;const l=null==(n=t.find((t=>t.id===e.data.source)))?void 0:n.name,a=null==(r=t.find((t=>t.id===e.data.target)))?void 0:r.name;if(l&&a)return[{col:c.source,op:"==",val:l,formattedVal:l},{col:c.target,op:"==",val:a,formattedVal:a}]})(n);s(t.clientX,t.clientY,{drillToDetail:l,crossFilter:f(n.find((t=>t.id===e.data.id)))})}}};return(0,i.tZ)(a.Z,{refs:h,height:t,width:n,echartOptions:r,eventHandlers:v})}},63475:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(78580),l=n.n(r),a=n(67294),i=n(51995),c=n(31431),s=n(11965);const u=i.iK.div`
  height: ${e=>{let{height:t}=e;return t}};
  width: ${e=>{let{width:t}=e;return t}};
`;function d(e,t){let{width:n,height:r,echartOptions:i,eventHandlers:d,zrEventHandlers:o,selectedValues:h={},refs:f}=e;const v=(0,a.useRef)(null);f&&(f.divRef=v);const g=(0,a.useRef)(),p=(0,a.useMemo)((()=>Object.keys(h)||[]),[h]),m=(0,a.useRef)([]);(0,a.useImperativeHandle)(t,(()=>({getEchartInstance:()=>g.current}))),(0,a.useEffect)((()=>{v.current&&(g.current||(g.current=(0,c.S1)(v.current)),Object.entries(d||{}).forEach((e=>{var t,n;let[r,l]=e;null==(t=g.current)||t.off(r),null==(n=g.current)||n.on(r,l)})),Object.entries(o||{}).forEach((e=>{var t,n;let[r,l]=e;null==(t=g.current)||t.getZr().off(r),null==(n=g.current)||n.getZr().on(r,l)})),g.current.setOption(i,!0))}),[i,d,o]),(0,a.useEffect)((()=>{g.current&&(g.current.dispatchAction({type:"downplay",dataIndex:m.current.filter((e=>!l()(p).call(p,e)))}),p.length&&g.current.dispatchAction({type:"highlight",dataIndex:p}),m.current=p)}),[p]);const w=(0,a.useCallback)((e=>{let{width:t,height:n}=e;g.current&&g.current.resize({width:t,height:n})}),[]);return(0,a.useEffect)((()=>(w({width:n,height:r}),()=>{var e;return null==(e=g.current)?void 0:e.dispose()})),[]),(0,a.useLayoutEffect)((()=>{w({width:n,height:r})}),[n,r,w]),(0,s.tZ)(u,{ref:v,height:r,width:n})}const o=(0,a.forwardRef)(d)}}]);
//# sourceMappingURL=9ce119655aa145613a7f.chunk.js.map
