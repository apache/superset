"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5619],{81788:(e,t,r)=>{r.d(t,{TZ:()=>o,u7:()=>c,B8:()=>d,mf:()=>l});var n=r(31069),a=r(68492);const s=(e,t,r)=>{let n=`api/v1/dashboard/${e}/filter_state`;return t&&(n=n.concat(`/${t}`)),r&&(n=n.concat(`?tab_id=${r}`)),n},o=(e,t,r,o)=>n.Z.put({endpoint:s(e,r,o),jsonPayload:{value:t}}).then((e=>e.json.message)).catch((e=>(a.Z.error(e),null))),c=(e,t,r)=>n.Z.post({endpoint:s(e,void 0,r),jsonPayload:{value:t}}).then((e=>e.json.key)).catch((e=>(a.Z.error(e),null))),d=(e,t)=>n.Z.get({endpoint:s(e,t)}).then((e=>{let{json:t}=e;return JSON.parse(t.value)})).catch((e=>(a.Z.error(e),null))),l=e=>n.Z.get({endpoint:`/api/v1/dashboard/permalink/${e}`}).then((e=>{let{json:t}=e;return t})).catch((e=>(a.Z.error(e),null)))},25619:(e,t,r)=>{r.r(t),r.d(t,{DashboardPageIdContext:()=>w,DashboardPage:()=>D,default:()=>F});var n=r(67294),a=r(16550),s=r(93185),o=r(78161),c=r(28062),d=r(55867),l=r(78718),u=r.n(l),i=r(28216),h=r(14114),f=r(38703),b=r(42582),m=r(4305),p=r(50810),v=r(14505),_=r(48911),E=r(61337),g=r(27600),S=r(23525),y=r(52794),I=r(9467),Z=r(81788),R=r(14670),$=r.n(R),j=r(43399),k=r(11965);const w=n.createContext("");(0,_.Z)();const T=n.lazy((()=>Promise.all([r.e(1216),r.e(8494),r.e(8453),r.e(7167),r.e(678),r.e(876),r.e(6052),r.e(2907),r.e(5207),r.e(5640),r.e(5010),r.e(8888),r.e(7243),r.e(986),r.e(8274),r.e(2923),r.e(4717),r.e(452)]).then(r.bind(r,70955)))),x=document.title,C=()=>{const e=(0,E.rV)(E.dR.dashboard__explore_context,{});return Object.fromEntries(Object.entries(e).filter((e=>{let[,t]=e;return!t.isRedundant})))},L=(e,t)=>{const r=C();(0,E.LS)(E.dR.dashboard__explore_context,{...r,[e]:t})},D=e=>{let{idOrSlug:t}=e;const r=(0,i.I0)(),l=(0,a.k6)(),_=(()=>{const e=(0,n.useMemo)((()=>$().generate()),[]),t=(0,i.v9)((t=>{var r,n,a;let{dashboardInfo:s,dashboardState:o,nativeFilters:c,dataMask:d}=t;return{labelColors:(null==(r=s.metadata)?void 0:r.label_colors)||{},sharedLabelColors:(null==(n=s.metadata)?void 0:n.shared_label_colors)||{},colorScheme:null==o?void 0:o.colorScheme,chartConfiguration:(null==(a=s.metadata)?void 0:a.chart_configuration)||{},nativeFilters:Object.entries(c.filters).reduce(((e,t)=>{let[r,n]=t;return{...e,[r]:u()(n,["chartsInScope"])}}),{}),dataMask:d,dashboardId:s.id,filterBoxFilters:(0,j.De)(),dashboardPageId:e}}));return(0,n.useEffect)((()=>(L(e,t),()=>{L(e,{...t,isRedundant:!0})})),[t,e]),e})(),{addDangerToast:R}=(0,h.e1)(),{result:D,error:F}=(0,b.QU)(t),{result:B,error:M}=(0,b.Es)(t),{result:O,error:P,status:N}=(0,b.JL)(t),A=(0,n.useRef)(!1),J=F||M,K=Boolean(D&&B),{dashboard_title:q,css:Q,metadata:Y,id:U=0}=D||{};if((0,n.useEffect)((()=>{const e=()=>{const e=C();(0,E.LS)(E.dR.dashboard__explore_context,{...e,[_]:{...e[_],isRedundant:!0}})};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[_]),(0,n.useEffect)((()=>{r((0,I.sL)(N))}),[r,N]),(0,n.useEffect)((()=>{U&&async function(){const e=(0,S.eY)(g.KD.permalinkKey),t=(0,S.eY)(g.KD.nativeFiltersKey),n=(0,S.eY)(g.KD.nativeFilters);let a,o=t||{};if(e){const t=await(0,Z.mf)(e);t&&({dataMask:o,activeTabs:a}=t.state)}else t&&(o=await(0,Z.B8)(U,t));n&&(o=n),K&&(A.current||(A.current=!0,(0,s.c)(s.T.DASHBOARD_NATIVE_FILTERS_SET)&&r((0,y.pi)(U))),r((0,m.Y)({history:l,dashboard:D,charts:B,activeTabs:a,dataMask:o})))}()}),[K]),(0,n.useEffect)((()=>(q&&(document.title=q),()=>{document.title=x})),[q]),(0,n.useEffect)((()=>"string"==typeof Q?(0,v.Z)(Q):()=>{}),[Q]),(0,n.useEffect)((()=>{const e=(0,o.ZP)();return e.source=o.Ag.dashboard,()=>{c.getNamespace(null==Y?void 0:Y.color_namespace).resetColors(),e.clear()}}),[null==Y?void 0:Y.color_namespace]),(0,n.useEffect)((()=>{P?R((0,d.t)("Error loading chart datasources. Filters may not work correctly.")):r((0,p.Fy)(O))}),[R,O,P,r]),J)throw J;return K?(0,k.tZ)(w.Provider,{value:_},(0,k.tZ)(T,null)):(0,k.tZ)(f.Z,null)},F=D},14505:(e,t,r)=>{function n(e){const t="CssEditor-css",r=document.head||document.getElementsByTagName("head")[0],n=document.querySelector(`.${t}`)||function(e){const t=document.createElement("style");return t.className="CssEditor-css",t.type="text/css",t}();return"styleSheet"in n?n.styleSheet.cssText=e:n.innerHTML=e,r.appendChild(n),function(){n.remove()}}r.d(t,{Z:()=>n})},42582:(e,t,r)=>{r.d(t,{s_:()=>n.s_,hb:()=>d,QU:()=>l,Es:()=>u,JL:()=>i,Xx:()=>m,zA:()=>p});var n=r(42190),a=r(15926),s=r.n(a);function o(e){let{owners:t}=e;return t?t.map((e=>`${e.first_name} ${e.last_name}`)):null}const c=s().encode({columns:["owners.first_name","owners.last_name"],keys:["none"]});function d(e){return(0,n.l6)((0,n.s_)(`/api/v1/chart/${e}?q=${c}`),o)}const l=e=>(0,n.l6)((0,n.s_)(`/api/v1/dashboard/${e}`),(e=>({...e,metadata:e.json_metadata&&JSON.parse(e.json_metadata)||{},position_data:e.position_json&&JSON.parse(e.position_json)}))),u=e=>(0,n.s_)(`/api/v1/dashboard/${e}/charts`),i=e=>(0,n.s_)(`/api/v1/dashboard/${e}/datasets`);var h=r(67294),f=r(78926),b=r(31069);function m(e){const{dbId:t,onSuccess:r,onError:n}=e||{},a=(0,h.useRef)(!1),o={dbId:t},c=(0,f.useQuery)(["schemas",{dbId:t}],(()=>function(e){let{dbId:t,forceRefresh:r}=e;const n=`/api/v1/database/${t}/schemas/?q=${s().encode({force:r})}`;return b.Z.get({endpoint:n})}({...o,forceRefresh:a.current})),{select:e=>{let{json:t}=e;return t.result.map((e=>({value:e,label:e,title:e})))},enabled:Boolean(t),onSuccess:r,onError:n,onSettled:()=>{a.current=!1}});return{...c,refetch:()=>(a.current=!0,c.refetch())}}function p(e){const{data:t,isFetching:r}=m({dbId:e.dbId}),n=(0,h.useMemo)((()=>new Set(null==t?void 0:t.map((e=>{let{value:t}=e;return t})))),[t]),{dbId:a,schema:o,onSuccess:c,onError:d}=e||{},l=(0,h.useRef)(!1),u={dbId:a,schema:o},i=(0,f.useQuery)(["tables",{dbId:a,schema:o}],(()=>function(e){let{dbId:t,schema:r,forceRefresh:n}=e;const a=r?encodeURIComponent(r):"",o=`/api/v1/database/${null!=t?t:"undefined"}/tables/?q=${s().encode({force:n,schema_name:a})}`;return b.Z.get({endpoint:o})}({...u,forceRefresh:l.current})),{select:e=>{let{json:t}=e;return{options:t.result,hasMore:t.count>t.result.length}},enabled:Boolean(a&&o&&!r&&n.has(o)),onSuccess:c,onError:d,onSettled:()=>{l.current=!1}});return{...i,refetch:()=>(l.current=!0,i.refetch())}}}}]);
//# sourceMappingURL=1882240ba470d27198f4.chunk.js.map
