{"version":3,"file":"4c81b739e6e8cff1c345.chunk.js","mappings":"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","sources":["webpack://superset/./src/types/ChartSource.ts","webpack://superset/./src/components/Chart/ChartContextMenu.tsx","webpack://superset/./src/components/Chart/ChartRenderer.jsx","webpack://superset/./src/components/Chart/ChartErrorMessage.tsx","webpack://superset/./src/components/Chart/Chart.jsx","webpack://superset/./src/components/Chart/ChartContainer.jsx","webpack://superset/./src/explore/components/EmbedCodeContent.jsx","webpack://superset/./src/explore/components/useExploreAdditionalActionsMenu/DashboardsSubMenu.tsx","webpack://superset/./src/explore/components/useExploreAdditionalActionsMenu/index.jsx","webpack://superset/./src/components/Chart/DisabledMenuItemTooltip.tsx","webpack://superset/./src/components/Table/cell-renderers/BooleanCell/index.tsx","webpack://superset/./src/components/Table/cell-renderers/NullCell/index.tsx","webpack://superset/./src/components/Table/cell-renderers/TimeCell/index.tsx","webpack://superset/./src/components/Table/header-renderers/HeaderWithRadioGroup.tsx","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailTableControls.tsx","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailPane.tsx","webpack://superset/./src/components/Chart/DrillDetail/utils.ts","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailModal.tsx","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailMenuItems.tsx","webpack://superset/./src/components/Chart/utils.ts","webpack://superset/./src/components/CronPicker/CronPicker.tsx","webpack://superset/./src/components/Dropdown/index.tsx","webpack://superset/./src/components/MetadataBar/ContentConfig.tsx","webpack://superset/./src/components/MetadataBar/MetadataBar.tsx","webpack://superset/./src/components/MetadataBar/ContentType.ts","webpack://superset/./src/components/MetadataBar/index.tsx","webpack://superset/./src/reports/types.ts","webpack://superset/./src/components/ReportModal/styles.tsx","webpack://superset/./src/components/ReportModal/index.tsx","webpack://superset/./src/components/ReportModal/HeaderReportDropdown/index.tsx","webpack://superset/./src/components/Switch/index.tsx","webpack://superset/./src/components/TimezoneSelector/index.tsx","webpack://superset/./src/dashboard/util/activeAllDashboardFilters.ts","webpack://superset/./src/dashboard/util/charts/getEffectiveExtraFilters.ts","webpack://superset/./src/dashboard/util/charts/getFormDataWithExtraFilters.ts","webpack://superset/./src/explore/components/DataTablesPane/types.ts","webpack://superset/./src/explore/components/DataTablesPane/components/DataTableControls.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/SingleQueryResultPane.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/useResultsPane.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/ResultsPaneOnDashboard.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/SamplesPane.tsx","webpack://superset/./src/explore/components/DataTablesPane/DataTablesPane.tsx","webpack://superset/./src/explore/components/controls/ViewQueryModal.tsx","webpack://superset/./src/hooks/useChangeEffect/useChangeEffect.ts","webpack://superset/./src/hooks/useTabId.ts","webpack://superset/./src/utils/downloadAsImage.ts","webpack://superset/./src/utils/getChartRequiredFieldsMissingMessage.ts","webpack://superset/./src/utils/isBot.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport enum ChartSource {\n  Explore = 'explore',\n  Dashboard = 'dashboard',\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  forwardRef,\n  ReactNode,\n  RefObject,\n  useCallback,\n  useImperativeHandle,\n  useState,\n} from 'react';\nimport ReactDOM from 'react-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  Behavior,\n  ContextMenuFilters,\n  FeatureFlag,\n  getChartMetadataRegistry,\n  isFeatureEnabled,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { RootState } from 'src/dashboard/types';\nimport { findPermission } from 'src/utils/findPermission';\nimport { Menu } from 'src/components/Menu';\nimport { AntdDropdown as Dropdown } from 'src/components';\nimport { DrillDetailMenuItems } from './DrillDetail';\nimport { getMenuAdjustedY } from './utils';\nimport { updateDataMask } from '../../dataMask/actions';\nimport { MenuItemTooltip } from './DisabledMenuItemTooltip';\n\nexport interface ChartContextMenuProps {\n  id: number;\n  formData: QueryFormData;\n  onSelection: () => void;\n  onClose: () => void;\n}\n\nexport interface Ref {\n  open: (\n    clientX: number,\n    clientY: number,\n    filters?: ContextMenuFilters,\n  ) => void;\n}\n\nconst ChartContextMenu = (\n  { id, formData, onSelection, onClose }: ChartContextMenuProps,\n  ref: RefObject<Ref>,\n) => {\n  const theme = useTheme();\n  const dispatch = useDispatch();\n  const canExplore = useSelector((state: RootState) =>\n    findPermission('can_explore', 'Superset', state.user?.roles),\n  );\n  const crossFiltersEnabled = useSelector<RootState, boolean>(\n    ({ dashboardInfo }) => dashboardInfo.crossFiltersEnabled,\n  );\n\n  const [{ filters, clientX, clientY }, setState] = useState<{\n    clientX: number;\n    clientY: number;\n    filters?: ContextMenuFilters;\n  }>({ clientX: 0, clientY: 0 });\n\n  const menuItems = [];\n\n  const showDrillToDetail =\n    isFeatureEnabled(FeatureFlag.DRILL_TO_DETAIL) && canExplore;\n\n  const isCrossFilteringSupportedByChart = getChartMetadataRegistry()\n    .get(formData.viz_type)\n    ?.behaviors?.includes(Behavior.INTERACTIVE_CHART);\n\n  let itemsCount = 0;\n  if (isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS)) {\n    itemsCount += 1;\n  }\n  if (showDrillToDetail) {\n    itemsCount += 2; // Drill to detail always has 2 top-level menu items\n  }\n  if (itemsCount === 0) {\n    itemsCount = 1; // \"No actions\" appears if no actions in menu\n  }\n\n  if (isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS)) {\n    const isCrossFilterDisabled =\n      !isCrossFilteringSupportedByChart ||\n      !crossFiltersEnabled ||\n      !filters?.crossFilter;\n\n    let crossFilteringTooltipTitle: ReactNode = null;\n    if (!isCrossFilterDisabled) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>\n            {t(\n              'Cross-filter will be applied to all of the charts that use this dataset.',\n            )}\n          </div>\n          <div>\n            {t('You can also just click on the chart to apply cross-filter.')}\n          </div>\n        </>\n      );\n    } else if (!crossFiltersEnabled) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>{t('Cross-filtering is not enabled for this dashboard.')}</div>\n        </>\n      );\n    } else if (!isCrossFilteringSupportedByChart) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>\n            {t('This visualization type does not support cross-filtering.')}\n          </div>\n        </>\n      );\n    } else if (!filters?.crossFilter) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>{t(`You can't apply cross-filter on this data point.`)}</div>\n        </>\n      );\n    }\n    menuItems.push(\n      <>\n        <Menu.Item\n          key=\"cross-filtering-menu-item\"\n          disabled={isCrossFilterDisabled}\n          onClick={() => {\n            if (filters?.crossFilter) {\n              dispatch(updateDataMask(id, filters.crossFilter.dataMask));\n            }\n          }}\n        >\n          {filters?.crossFilter?.isCurrentValueSelected ? (\n            t('Remove cross-filter')\n          ) : (\n            <div>\n              {t('Add cross-filter')}\n              <MenuItemTooltip\n                title={crossFilteringTooltipTitle}\n                color={\n                  !isCrossFilterDisabled\n                    ? theme.colors.grayscale.base\n                    : undefined\n                }\n              />\n            </div>\n          )}\n        </Menu.Item>\n        {itemsCount > 1 && <Menu.Divider />}\n      </>,\n    );\n  }\n  if (showDrillToDetail) {\n    menuItems.push(\n      <DrillDetailMenuItems\n        chartId={id}\n        formData={formData}\n        filters={filters?.drillToDetail}\n        isContextMenu\n        contextMenuY={clientY}\n        onSelection={onSelection}\n      />,\n    );\n  }\n\n  const open = useCallback(\n    (clientX: number, clientY: number, filters?: ContextMenuFilters) => {\n      const adjustedY = getMenuAdjustedY(clientY, itemsCount);\n      setState({\n        clientX,\n        clientY: adjustedY,\n        filters,\n      });\n\n      // Since Ant Design's Dropdown does not offer an imperative API\n      // and we can't attach event triggers to charts SVG elements, we\n      // use a hidden span that gets clicked on when receiving click events\n      // from the charts.\n      document.getElementById(`hidden-span-${id}`)?.click();\n    },\n    [id, itemsCount],\n  );\n\n  useImperativeHandle(\n    ref,\n    () => ({\n      open,\n    }),\n    [open],\n  );\n\n  return ReactDOM.createPortal(\n    <Dropdown\n      overlay={\n        <Menu>\n          {menuItems.length ? (\n            menuItems\n          ) : (\n            <Menu.Item disabled>No actions</Menu.Item>\n          )}\n        </Menu>\n      }\n      trigger={['click']}\n      onVisibleChange={value => !value && onClose()}\n    >\n      <span\n        id={`hidden-span-${id}`}\n        css={{\n          visibility: 'hidden',\n          position: 'fixed',\n          top: clientY,\n          left: clientX,\n          width: 1,\n          height: 1,\n        }}\n      />\n    </Dropdown>,\n    document.body,\n  );\n};\n\nexport default forwardRef(ChartContextMenu);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { snakeCase, isEqual } from 'lodash';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {\n  SuperChart,\n  logging,\n  Behavior,\n  t,\n  isFeatureEnabled,\n  FeatureFlag,\n  getChartMetadataRegistry,\n} from '@superset-ui/core';\nimport { Logger, LOG_ACTIONS_RENDER_CHART } from 'src/logger/LogUtils';\nimport { EmptyStateBig, EmptyStateSmall } from 'src/components/EmptyState';\nimport { ChartSource } from 'src/types/ChartSource';\nimport ChartContextMenu from './ChartContextMenu';\n\nconst propTypes = {\n  annotationData: PropTypes.object,\n  actions: PropTypes.object,\n  chartId: PropTypes.number.isRequired,\n  datasource: PropTypes.object,\n  initialValues: PropTypes.object,\n  formData: PropTypes.object.isRequired,\n  latestQueryFormData: PropTypes.object,\n  labelColors: PropTypes.object,\n  sharedLabelColors: PropTypes.object,\n  height: PropTypes.number,\n  width: PropTypes.number,\n  setControlValue: PropTypes.func,\n  vizType: PropTypes.string.isRequired,\n  triggerRender: PropTypes.bool,\n  // state\n  chartAlert: PropTypes.string,\n  chartStatus: PropTypes.string,\n  queriesResponse: PropTypes.arrayOf(PropTypes.object),\n  triggerQuery: PropTypes.bool,\n  chartIsStale: PropTypes.bool,\n  // dashboard callbacks\n  addFilter: PropTypes.func,\n  setDataMask: PropTypes.func,\n  onFilterMenuOpen: PropTypes.func,\n  onFilterMenuClose: PropTypes.func,\n  ownState: PropTypes.object,\n  postTransformProps: PropTypes.func,\n  source: PropTypes.oneOf([ChartSource.Dashboard, ChartSource.Explore]),\n  emitCrossFilters: PropTypes.bool,\n};\n\nconst BLANK = {};\n\nconst BIG_NO_RESULT_MIN_WIDTH = 300;\nconst BIG_NO_RESULT_MIN_HEIGHT = 220;\n\nconst behaviors = [Behavior.INTERACTIVE_CHART];\n\nconst defaultProps = {\n  addFilter: () => BLANK,\n  onFilterMenuOpen: () => BLANK,\n  onFilterMenuClose: () => BLANK,\n  initialValues: BLANK,\n  setControlValue() {},\n  triggerRender: false,\n};\n\nclass ChartRenderer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showContextMenu:\n        props.source === ChartSource.Dashboard &&\n        (isFeatureEnabled(FeatureFlag.DRILL_TO_DETAIL) ||\n          isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS)),\n      inContextMenu: false,\n    };\n    this.hasQueryResponseChange = false;\n\n    this.contextMenuRef = React.createRef();\n\n    this.handleAddFilter = this.handleAddFilter.bind(this);\n    this.handleRenderSuccess = this.handleRenderSuccess.bind(this);\n    this.handleRenderFailure = this.handleRenderFailure.bind(this);\n    this.handleSetControlValue = this.handleSetControlValue.bind(this);\n    this.handleOnContextMenu = this.handleOnContextMenu.bind(this);\n    this.handleContextMenuSelected = this.handleContextMenuSelected.bind(this);\n    this.handleContextMenuClosed = this.handleContextMenuClosed.bind(this);\n    this.onContextMenuFallback = this.onContextMenuFallback.bind(this);\n\n    this.hooks = {\n      onAddFilter: this.handleAddFilter,\n      onContextMenu: this.state.showContextMenu\n        ? this.handleOnContextMenu\n        : undefined,\n      onError: this.handleRenderFailure,\n      setControlValue: this.handleSetControlValue,\n      onFilterMenuOpen: this.props.onFilterMenuOpen,\n      onFilterMenuClose: this.props.onFilterMenuClose,\n      setDataMask: dataMask => {\n        this.props.actions?.updateDataMask(this.props.chartId, dataMask);\n      },\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const resultsReady =\n      nextProps.queriesResponse &&\n      ['success', 'rendered'].indexOf(nextProps.chartStatus) > -1 &&\n      !nextProps.queriesResponse?.[0]?.error;\n\n    if (resultsReady) {\n      if (!isEqual(this.state, nextState)) {\n        return true;\n      }\n      this.hasQueryResponseChange =\n        nextProps.queriesResponse !== this.props.queriesResponse;\n      return (\n        this.hasQueryResponseChange ||\n        !isEqual(nextProps.datasource, this.props.datasource) ||\n        nextProps.annotationData !== this.props.annotationData ||\n        nextProps.ownState !== this.props.ownState ||\n        nextProps.filterState !== this.props.filterState ||\n        nextProps.height !== this.props.height ||\n        nextProps.width !== this.props.width ||\n        nextProps.triggerRender ||\n        nextProps.labelColors !== this.props.labelColors ||\n        nextProps.sharedLabelColors !== this.props.sharedLabelColors ||\n        nextProps.formData.color_scheme !== this.props.formData.color_scheme ||\n        nextProps.formData.stack !== this.props.formData.stack ||\n        nextProps.cacheBusterProp !== this.props.cacheBusterProp ||\n        nextProps.emitCrossFilters !== this.props.emitCrossFilters\n      );\n    }\n    return false;\n  }\n\n  handleAddFilter(col, vals, merge = true, refresh = true) {\n    this.props.addFilter(col, vals, merge, refresh);\n  }\n\n  handleRenderSuccess() {\n    const { actions, chartStatus, chartId, vizType } = this.props;\n    if (['loading', 'rendered'].indexOf(chartStatus) < 0) {\n      actions.chartRenderingSucceeded(chartId);\n    }\n\n    // only log chart render time which is triggered by query results change\n    // currently we don't log chart re-render time, like window resize etc\n    if (this.hasQueryResponseChange) {\n      actions.logEvent(LOG_ACTIONS_RENDER_CHART, {\n        slice_id: chartId,\n        viz_type: vizType,\n        start_offset: this.renderStartTime,\n        ts: new Date().getTime(),\n        duration: Logger.getTimestamp() - this.renderStartTime,\n      });\n    }\n  }\n\n  handleRenderFailure(error, info) {\n    const { actions, chartId } = this.props;\n    logging.warn(error);\n    actions.chartRenderingFailed(\n      error.toString(),\n      chartId,\n      info ? info.componentStack : null,\n    );\n\n    // only trigger render log when query is changed\n    if (this.hasQueryResponseChange) {\n      actions.logEvent(LOG_ACTIONS_RENDER_CHART, {\n        slice_id: chartId,\n        has_err: true,\n        error_details: error.toString(),\n        start_offset: this.renderStartTime,\n        ts: new Date().getTime(),\n        duration: Logger.getTimestamp() - this.renderStartTime,\n      });\n    }\n  }\n\n  handleSetControlValue(...args) {\n    const { setControlValue } = this.props;\n    if (setControlValue) {\n      setControlValue(...args);\n    }\n  }\n\n  handleOnContextMenu(offsetX, offsetY, filters) {\n    this.contextMenuRef.current.open(offsetX, offsetY, filters);\n    this.setState({ inContextMenu: true });\n  }\n\n  handleContextMenuSelected() {\n    this.setState({ inContextMenu: false });\n  }\n\n  handleContextMenuClosed() {\n    this.setState({ inContextMenu: false });\n  }\n\n  // When viz plugins don't handle `contextmenu` event, fallback handler\n  // calls `handleOnContextMenu` with no `filters` param.\n  onContextMenuFallback(event) {\n    if (!this.state.inContextMenu) {\n      event.preventDefault();\n      this.handleOnContextMenu(event.clientX, event.clientY);\n    }\n  }\n\n  render() {\n    const { chartAlert, chartStatus, chartId, emitCrossFilters } = this.props;\n\n    // Skip chart rendering\n    if (chartStatus === 'loading' || !!chartAlert || chartStatus === null) {\n      return null;\n    }\n\n    this.renderStartTime = Logger.getTimestamp();\n\n    const {\n      width,\n      height,\n      datasource,\n      annotationData,\n      initialValues,\n      ownState,\n      filterState,\n      chartIsStale,\n      formData,\n      latestQueryFormData,\n      queriesResponse,\n      postTransformProps,\n    } = this.props;\n\n    const currentFormData =\n      chartIsStale && latestQueryFormData ? latestQueryFormData : formData;\n    const vizType = currentFormData.viz_type || this.props.vizType;\n\n    // It's bad practice to use unprefixed `vizType` as classnames for chart\n    // container. It may cause css conflicts as in the case of legacy table chart.\n    // When migrating charts, we should gradually add a `superset-chart-` prefix\n    // to each one of them.\n    const snakeCaseVizType = snakeCase(vizType);\n    const chartClassName =\n      vizType === 'table'\n        ? `superset-chart-${snakeCaseVizType}`\n        : snakeCaseVizType;\n\n    const webpackHash =\n      process.env.WEBPACK_MODE === 'development'\n        ? `-${\n            // eslint-disable-next-line camelcase\n            typeof __webpack_require__ !== 'undefined' &&\n            // eslint-disable-next-line camelcase, no-undef\n            typeof __webpack_require__.h === 'function' &&\n            // eslint-disable-next-line no-undef\n            __webpack_require__.h()\n          }`\n        : '';\n\n    let noResultsComponent;\n    const noResultTitle = t('No results were returned for this query');\n    const noResultDescription =\n      this.props.source === ChartSource.Explore\n        ? t(\n            'Make sure that the controls are configured properly and the datasource contains data for the selected time range',\n          )\n        : undefined;\n    const noResultImage = 'chart.svg';\n    if (width > BIG_NO_RESULT_MIN_WIDTH && height > BIG_NO_RESULT_MIN_HEIGHT) {\n      noResultsComponent = (\n        <EmptyStateBig\n          title={noResultTitle}\n          description={noResultDescription}\n          image={noResultImage}\n        />\n      );\n    } else {\n      noResultsComponent = (\n        <EmptyStateSmall title={noResultTitle} image={noResultImage} />\n      );\n    }\n\n    // Check for Behavior.DRILL_TO_DETAIL to tell if chart can receive Drill to\n    // Detail props or if it'll cause side-effects (e.g. excessive re-renders).\n    const drillToDetailProps = getChartMetadataRegistry()\n      .get(formData.viz_type)\n      ?.behaviors.find(behavior => behavior === Behavior.DRILL_TO_DETAIL)\n      ? { inContextMenu: this.state.inContextMenu }\n      : {};\n\n    return (\n      <>\n        {this.state.showContextMenu && (\n          <ChartContextMenu\n            ref={this.contextMenuRef}\n            id={chartId}\n            formData={currentFormData}\n            onSelection={this.handleContextMenuSelected}\n            onClose={this.handleContextMenuClosed}\n          />\n        )}\n        <div\n          onContextMenu={\n            this.state.showContextMenu ? this.onContextMenuFallback : undefined\n          }\n        >\n          <SuperChart\n            disableErrorBoundary\n            key={`${chartId}${webpackHash}`}\n            id={`chart-id-${chartId}`}\n            className={chartClassName}\n            chartType={vizType}\n            width={width}\n            height={height}\n            annotationData={annotationData}\n            datasource={datasource}\n            initialValues={initialValues}\n            formData={currentFormData}\n            ownState={ownState}\n            filterState={filterState}\n            hooks={this.hooks}\n            behaviors={behaviors}\n            queriesData={queriesResponse}\n            onRenderSuccess={this.handleRenderSuccess}\n            onRenderFailure={this.handleRenderFailure}\n            noResults={noResultsComponent}\n            postTransformProps={postTransformProps}\n            emitCrossFilters={emitCrossFilters}\n            {...drillToDetailProps}\n          />\n        </div>\n      </>\n    );\n  }\n}\n\nChartRenderer.propTypes = propTypes;\nChartRenderer.defaultProps = defaultProps;\n\nexport default ChartRenderer;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React from 'react';\nimport { useChartOwnerNames } from 'src/hooks/apiResources';\nimport ErrorMessageWithStackTrace from 'src/components/ErrorMessage/ErrorMessageWithStackTrace';\nimport { SupersetError } from 'src/components/ErrorMessage/types';\n\ninterface Props {\n  chartId: string;\n  error?: SupersetError;\n}\n\n/**\n * fetches the chart owners and adds them to the extra data of the error message\n */\nexport const ChartErrorMessage: React.FC<Props> = ({\n  chartId,\n  error,\n  ...props\n}) => {\n  const { result: owners } = useChartOwnerNames(chartId);\n\n  // don't mutate props\n  const ownedError = error && {\n    ...error,\n    extra: { ...error.extra, owners },\n  };\n\n  return <ErrorMessageWithStackTrace {...props} error={ownedError} />;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { styled, logging, t, ensureIsArray } from '@superset-ui/core';\n\nimport { isFeatureEnabled, FeatureFlag } from 'src/featureFlags';\nimport { PLACEHOLDER_DATASOURCE } from 'src/dashboard/constants';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateBig } from 'src/components/EmptyState';\nimport ErrorBoundary from 'src/components/ErrorBoundary';\nimport { Logger, LOG_ACTIONS_RENDER_CHART } from 'src/logger/LogUtils';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { isCurrentUserBot } from 'src/utils/isBot';\nimport { ChartSource } from 'src/types/ChartSource';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport ChartRenderer from './ChartRenderer';\nimport { ChartErrorMessage } from './ChartErrorMessage';\nimport { getChartRequiredFieldsMissingMessage } from '../../utils/getChartRequiredFieldsMissingMessage';\n\nconst propTypes = {\n  annotationData: PropTypes.object,\n  actions: PropTypes.object,\n  chartId: PropTypes.number.isRequired,\n  datasource: PropTypes.object,\n  // current chart is included by dashboard\n  dashboardId: PropTypes.number,\n  // original selected values for FilterBox viz\n  // so that FilterBox can pre-populate selected values\n  // only affect UI control\n  initialValues: PropTypes.object,\n  // formData contains chart's own filter parameter\n  // and merged with extra filter that current dashboard applying\n  formData: PropTypes.object.isRequired,\n  labelColors: PropTypes.object,\n  sharedLabelColors: PropTypes.object,\n  width: PropTypes.number,\n  height: PropTypes.number,\n  setControlValue: PropTypes.func,\n  timeout: PropTypes.number,\n  vizType: PropTypes.string.isRequired,\n  triggerRender: PropTypes.bool,\n  force: PropTypes.bool,\n  isFiltersInitialized: PropTypes.bool,\n  // state\n  chartAlert: PropTypes.string,\n  chartStatus: PropTypes.string,\n  chartStackTrace: PropTypes.string,\n  queriesResponse: PropTypes.arrayOf(PropTypes.object),\n  triggerQuery: PropTypes.bool,\n  chartIsStale: PropTypes.bool,\n  errorMessage: PropTypes.node,\n  // dashboard callbacks\n  addFilter: PropTypes.func,\n  onQuery: PropTypes.func,\n  onFilterMenuOpen: PropTypes.func,\n  onFilterMenuClose: PropTypes.func,\n  ownState: PropTypes.object,\n  postTransformProps: PropTypes.func,\n  datasetsStatus: PropTypes.oneOf(['loading', 'error', 'complete']),\n  isInView: PropTypes.bool,\n  emitCrossFilters: PropTypes.bool,\n};\n\nconst BLANK = {};\nconst NONEXISTENT_DATASET = t(\n  'The dataset associated with this chart no longer exists',\n);\n\nconst defaultProps = {\n  addFilter: () => BLANK,\n  onFilterMenuOpen: () => BLANK,\n  onFilterMenuClose: () => BLANK,\n  initialValues: BLANK,\n  setControlValue() {},\n  triggerRender: false,\n  dashboardId: null,\n  chartStackTrace: null,\n  force: false,\n  isInView: true,\n};\n\nconst Styles = styled.div`\n  min-height: ${p => p.height}px;\n  position: relative;\n\n  .chart-tooltip {\n    opacity: 0.75;\n    font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  }\n\n  .slice_container {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n\n    height: ${p => p.height}px;\n\n    .pivot_table tbody tr {\n      font-feature-settings: 'tnum' 1;\n    }\n\n    .alert {\n      margin: ${({ theme }) => theme.gridUnit * 2}px;\n    }\n  }\n`;\n\nconst MonospaceDiv = styled.div`\n  font-family: ${({ theme }) => theme.typography.families.monospace};\n  word-break: break-word;\n  overflow-x: auto;\n  white-space: pre-wrap;\n`;\n\nclass Chart extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.handleRenderContainerFailure =\n      this.handleRenderContainerFailure.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.props.triggerQuery) {\n      this.runQuery();\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.props.triggerQuery) {\n      this.runQuery();\n    }\n  }\n\n  runQuery() {\n    if (this.props.chartId > 0 && isFeatureEnabled(FeatureFlag.CLIENT_CACHE)) {\n      // Load saved chart with a GET request\n      this.props.actions.getSavedChart(\n        this.props.formData,\n        this.props.force || getUrlParam(URL_PARAMS.force), // allow override via url params force=true\n        this.props.timeout,\n        this.props.chartId,\n        this.props.dashboardId,\n        this.props.ownState,\n      );\n    } else {\n      // Create chart with POST request\n      this.props.actions.postChartFormData(\n        this.props.formData,\n        this.props.force || getUrlParam(URL_PARAMS.force), // allow override via url params force=true\n        this.props.timeout,\n        this.props.chartId,\n        this.props.dashboardId,\n        this.props.ownState,\n      );\n    }\n  }\n\n  handleRenderContainerFailure(error, info) {\n    const { actions, chartId } = this.props;\n    logging.warn(error);\n    actions.chartRenderingFailed(\n      error.toString(),\n      chartId,\n      info ? info.componentStack : null,\n    );\n\n    actions.logEvent(LOG_ACTIONS_RENDER_CHART, {\n      slice_id: chartId,\n      has_err: true,\n      error_details: error.toString(),\n      start_offset: this.renderStartTime,\n      ts: new Date().getTime(),\n      duration: Logger.getTimestamp() - this.renderStartTime,\n    });\n  }\n\n  renderErrorMessage(queryResponse) {\n    const {\n      chartId,\n      chartAlert,\n      chartStackTrace,\n      datasource,\n      dashboardId,\n      height,\n      datasetsStatus,\n    } = this.props;\n    const error = queryResponse?.errors?.[0];\n    const message = chartAlert || queryResponse?.message;\n\n    // if datasource is still loading, don't render JS errors\n    if (\n      chartAlert !== undefined &&\n      chartAlert !== NONEXISTENT_DATASET &&\n      datasource === PLACEHOLDER_DATASOURCE &&\n      datasetsStatus !== ResourceStatus.ERROR\n    ) {\n      return (\n        <Styles\n          key={chartId}\n          data-ui-anchor=\"chart\"\n          className=\"chart-container\"\n          data-test=\"chart-container\"\n          height={height}\n        >\n          <Loading />\n        </Styles>\n      );\n    }\n\n    return (\n      <ChartErrorMessage\n        key={chartId}\n        chartId={chartId}\n        error={error}\n        subtitle={<MonospaceDiv>{message}</MonospaceDiv>}\n        copyText={message}\n        link={queryResponse ? queryResponse.link : null}\n        source={dashboardId ? ChartSource.Dashboard : ChartSource.Explore}\n        stackTrace={chartStackTrace}\n      />\n    );\n  }\n\n  render() {\n    const {\n      height,\n      chartAlert,\n      chartStatus,\n      errorMessage,\n      chartIsStale,\n      queriesResponse = [],\n      width,\n    } = this.props;\n\n    const isLoading = chartStatus === 'loading';\n    this.renderContainerStartTime = Logger.getTimestamp();\n    if (chartStatus === 'failed') {\n      return queriesResponse.map(item => this.renderErrorMessage(item));\n    }\n\n    if (errorMessage && ensureIsArray(queriesResponse).length === 0) {\n      return (\n        <EmptyStateBig\n          title={t('Add required control values to preview chart')}\n          description={getChartRequiredFieldsMissingMessage(true)}\n          image=\"chart.svg\"\n        />\n      );\n    }\n\n    if (\n      !isLoading &&\n      !chartAlert &&\n      !errorMessage &&\n      chartIsStale &&\n      ensureIsArray(queriesResponse).length === 0\n    ) {\n      return (\n        <EmptyStateBig\n          title={t('Your chart is ready to go!')}\n          description={\n            <span>\n              {t(\n                'Click on \"Create chart\" button in the control panel on the left to preview a visualization or',\n              )}{' '}\n              <span role=\"button\" tabIndex={0} onClick={this.props.onQuery}>\n                {t('click here')}\n              </span>\n              .\n            </span>\n          }\n          image=\"chart.svg\"\n        />\n      );\n    }\n\n    return (\n      <ErrorBoundary\n        onError={this.handleRenderContainerFailure}\n        showMessage={false}\n      >\n        <Styles\n          data-ui-anchor=\"chart\"\n          className=\"chart-container\"\n          data-test=\"chart-container\"\n          height={height}\n          width={width}\n        >\n          <div className=\"slice_container\" data-test=\"slice-container\">\n            {this.props.isInView ||\n            !isFeatureEnabled(FeatureFlag.DASHBOARD_VIRTUALIZATION) ||\n            isCurrentUserBot() ? (\n              <ChartRenderer\n                {...this.props}\n                source={this.props.dashboardId ? 'dashboard' : 'explore'}\n                data-test={this.props.vizType}\n              />\n            ) : (\n              <Loading />\n            )}\n          </div>\n          {isLoading && <Loading />}\n        </Styles>\n      </ErrorBoundary>\n    );\n  }\n}\n\nChart.propTypes = propTypes;\nChart.defaultProps = defaultProps;\n\nexport default Chart;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport * as actions from './chartAction';\nimport { logEvent } from '../../logger/actions';\nimport Chart from './Chart';\nimport { updateDataMask } from '../../dataMask/actions';\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        ...actions,\n        updateDataMask,\n        logEvent,\n      },\n      dispatch,\n    ),\n  };\n}\n\nexport default connect(null, mapDispatchToProps)(Chart);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { css, styled, t } from '@superset-ui/core';\nimport { Input, TextArea } from 'src/components/Input';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { URL_PARAMS } from 'src/constants';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport { CopyButton } from './DataTableControl';\n\nconst CopyButtonEmbedCode = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst EmbedCodeContent = ({ formData, addDangerToast }) => {\n  const [height, setHeight] = useState('400');\n  const [width, setWidth] = useState('600');\n  const [url, setUrl] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const handleInputChange = useCallback(e => {\n    const { value, name } = e.currentTarget;\n    if (name === 'width') {\n      setWidth(value);\n    }\n    if (name === 'height') {\n      setHeight(value);\n    }\n  }, []);\n\n  const updateUrl = useCallback(() => {\n    setUrl('');\n    getChartPermalink(formData)\n      .then(url => {\n        setUrl(url);\n        setErrorMessage('');\n      })\n      .catch(() => {\n        setErrorMessage(t('Error'));\n        addDangerToast(t('Sorry, something went wrong. Try again later.'));\n      });\n  }, [addDangerToast, formData]);\n\n  useEffect(() => {\n    updateUrl();\n  }, []);\n\n  const html = useMemo(() => {\n    if (!url) return '';\n    const srcLink = `${url}?${URL_PARAMS.standalone.name}=1&height=${height}`;\n    return (\n      '<iframe\\n' +\n      `  width=\"${width}\"\\n` +\n      `  height=\"${height}\"\\n` +\n      '  seamless\\n' +\n      '  frameBorder=\"0\"\\n' +\n      '  scrolling=\"no\"\\n' +\n      `  src=\"${srcLink}\"\\n` +\n      '>\\n' +\n      '</iframe>'\n    );\n  }, [height, url, width]);\n\n  const text = errorMessage || html || t('Generating link, please wait..');\n  return (\n    <div id=\"embed-code-popover\" data-test=\"embed-code-popover\">\n      <div\n        css={css`\n          display: flex;\n          flex-direction: column;\n        `}\n      >\n        <CopyToClipboard\n          shouldShowText={false}\n          text={html}\n          copyNode={\n            <CopyButtonEmbedCode buttonSize=\"xsmall\">\n              <i className=\"fa fa-clipboard\" />\n            </CopyButtonEmbedCode>\n          }\n        />\n        <TextArea\n          data-test=\"embed-code-textarea\"\n          name=\"embedCode\"\n          disabled={!html}\n          value={text}\n          rows=\"4\"\n          readOnly\n          css={theme => css`\n            resize: vertical;\n            padding: ${theme.gridUnit * 2}px;\n            font-size: ${theme.typography.sizes.s}px;\n            border-radius: 4px;\n            background-color: ${theme.colors.secondary.light5};\n          `}\n        />\n      </div>\n      <div\n        css={theme => css`\n          display: flex;\n          margin-top: ${theme.gridUnit * 4}px;\n          & > div {\n            margin-right: ${theme.gridUnit * 2}px;\n          }\n          & > div:last-of-type {\n            margin-right: 0;\n            margin-left: ${theme.gridUnit * 2}px;\n          }\n        `}\n      >\n        <div>\n          <label htmlFor=\"embed-height\">{t('Chart height')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={height}\n            name=\"height\"\n            onChange={handleInputChange}\n          />\n        </div>\n        <div>\n          <label htmlFor=\"embed-width\">{t('Chart width')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={width}\n            name=\"width\"\n            onChange={handleInputChange}\n            id=\"embed-width\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EmbedCodeContent;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport { Input } from 'src/components/Input';\nimport Icons from 'src/components/Icons';\nimport { Menu } from 'src/components/Menu';\nimport { Link } from 'react-router-dom';\n\nexport interface DashboardsSubMenuProps {\n  chartId?: number;\n  dashboards?: { id: number; dashboard_title: string }[];\n}\n\nconst WIDTH = 220;\nconst HEIGHT = 300;\nconst SEARCH_THRESHOLD = 10;\n\nconst DashboardsSubMenu = ({\n  chartId,\n  dashboards = [],\n  ...menuProps\n}: DashboardsSubMenuProps) => {\n  const theme = useTheme();\n  const [dashboardSearch, setDashboardSearch] = useState<string>();\n  const [hoveredItem, setHoveredItem] = useState<number | null>();\n  const showSearch = dashboards.length > SEARCH_THRESHOLD;\n  const filteredDashboards = dashboards.filter(\n    dashboard =>\n      !dashboardSearch ||\n      dashboard.dashboard_title\n        .toLowerCase()\n        .includes(dashboardSearch.toLowerCase()),\n  );\n  const noResults = dashboards.length === 0;\n  const noResultsFound = dashboardSearch && filteredDashboards.length === 0;\n  const urlQueryString = chartId ? `?focused_chart=${chartId}` : '';\n  return (\n    <>\n      {showSearch && (\n        <Input\n          allowClear\n          placeholder={t('Search')}\n          prefix={<Icons.Search iconSize=\"l\" />}\n          css={css`\n            width: ${WIDTH}px;\n            margin: ${theme.gridUnit * 2}px ${theme.gridUnit * 3}px;\n          `}\n          value={dashboardSearch}\n          onChange={e => setDashboardSearch(e.currentTarget.value)}\n        />\n      )}\n      <div\n        css={css`\n          max-height: ${HEIGHT}px;\n          overflow: auto;\n        `}\n      >\n        {filteredDashboards.map(dashboard => (\n          <Menu.Item\n            key={String(dashboard.id)}\n            onMouseEnter={() => setHoveredItem(dashboard.id)}\n            onMouseLeave={() => {\n              if (hoveredItem === dashboard.id) {\n                setHoveredItem(null);\n              }\n            }}\n            {...menuProps}\n          >\n            <Link\n              target=\"_blank\"\n              rel=\"noreferer noopener\"\n              to={`/superset/dashboard/${dashboard.id}${urlQueryString}`}\n            >\n              <div\n                css={css`\n                  display: flex;\n                  flex-direction: row;\n                  align-items: center;\n                  max-width: ${WIDTH}px;\n                `}\n              >\n                <div\n                  css={css`\n                    white-space: normal;\n                  `}\n                >\n                  {dashboard.dashboard_title}\n                </div>\n                <Icons.Full\n                  iconSize=\"l\"\n                  iconColor={theme.colors.grayscale.base}\n                  css={css`\n                    margin-left: ${theme.gridUnit * 2}px;\n                    visibility: ${hoveredItem === dashboard.id\n                      ? 'visible'\n                      : 'hidden'};\n                  `}\n                />\n              </div>\n            </Link>\n          </Menu.Item>\n        ))}\n        {noResultsFound && (\n          <div\n            css={css`\n              margin-left: ${theme.gridUnit * 3}px;\n              margin-bottom: ${theme.gridUnit}px;\n            `}\n          >\n            {t('No results found')}\n          </div>\n        )}\n        {noResults && (\n          <Menu.Item\n            disabled\n            css={css`\n              min-width: ${WIDTH}px;\n            `}\n            {...menuProps}\n          >\n            {t('None')}\n          </Menu.Item>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default DashboardsSubMenu;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { css, styled, t, useTheme } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Menu } from 'src/components/Menu';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport Button from 'src/components/Button';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { exportChart, getChartKey } from 'src/explore/exploreUtils';\nimport downloadAsImage from 'src/utils/downloadAsImage';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport copyTextToClipboard from 'src/utils/copy';\nimport HeaderReportDropDown from 'src/components/ReportModal/HeaderReportDropdown';\nimport { isFeatureEnabled, FeatureFlag } from 'src/featureFlags';\nimport ViewQueryModal from '../controls/ViewQueryModal';\nimport EmbedCodeContent from '../EmbedCodeContent';\nimport DashboardsSubMenu from './DashboardsSubMenu';\n\nconst MENU_KEYS = {\n  EDIT_PROPERTIES: 'edit_properties',\n  DASHBOARDS_ADDED_TO: 'dashboards_added_to',\n  DOWNLOAD_SUBMENU: 'download_submenu',\n  EXPORT_TO_CSV: 'export_to_csv',\n  EXPORT_TO_CSV_PIVOTED: 'export_to_csv_pivoted',\n  EXPORT_TO_JSON: 'export_to_json',\n  EXPORT_TO_XLSX: 'export_to_xlsx',\n  DOWNLOAD_AS_IMAGE: 'download_as_image',\n  SHARE_SUBMENU: 'share_submenu',\n  COPY_PERMALINK: 'copy_permalink',\n  EMBED_CODE: 'embed_code',\n  SHARE_BY_EMAIL: 'share_by_email',\n  REPORT_SUBMENU: 'report_submenu',\n  SET_UP_REPORT: 'set_up_report',\n  SET_REPORT_ACTIVE: 'set_report_active',\n  EDIT_REPORT: 'edit_report',\n  DELETE_REPORT: 'delete_report',\n  VIEW_QUERY: 'view_query',\n  RUN_IN_SQL_LAB: 'run_in_sql_lab',\n};\n\nconst VIZ_TYPES_PIVOTABLE = ['pivot_table', 'pivot_table_v2'];\n\nexport const MenuItemWithCheckboxContainer = styled.div`\n  ${({ theme }) => css`\n    display: flex;\n    align-items: center;\n\n    & svg {\n      width: ${theme.gridUnit * 3}px;\n      height: ${theme.gridUnit * 3}px;\n    }\n\n    & span[role='checkbox'] {\n      display: inline-flex;\n      margin-right: ${theme.gridUnit}px;\n    }\n  `}\n`;\n\nexport const MenuTrigger = styled(Button)`\n  ${({ theme }) => css`\n    width: ${theme.gridUnit * 8}px;\n    height: ${theme.gridUnit * 8}px;\n    padding: 0;\n    border: 1px solid ${theme.colors.primary.dark2};\n\n    &.ant-btn > span.anticon {\n      line-height: 0;\n      transition: inherit;\n    }\n\n    &:hover:not(:focus) > span.anticon {\n      color: ${theme.colors.primary.light1};\n    }\n  `}\n`;\n\nconst iconReset = css`\n  .ant-dropdown-menu-item > & > .anticon:first-child {\n    margin-right: 0;\n    vertical-align: 0;\n  }\n`;\n\nexport const useExploreAdditionalActionsMenu = (\n  latestQueryFormData,\n  canDownloadCSV,\n  slice,\n  onOpenInEditor,\n  onOpenPropertiesModal,\n  ownState,\n  dashboards,\n) => {\n  const theme = useTheme();\n  const { addDangerToast, addSuccessToast } = useToasts();\n  const [showReportSubMenu, setShowReportSubMenu] = useState(null);\n  const [isDropdownVisible, setIsDropdownVisible] = useState(false);\n  const [openSubmenus, setOpenSubmenus] = useState([]);\n  const chart = useSelector(\n    state => state.charts?.[getChartKey(state.explore)],\n  );\n\n  const { datasource } = latestQueryFormData;\n\n  const shareByEmail = useCallback(async () => {\n    try {\n      const subject = t('Superset Chart');\n      const url = await getChartPermalink(latestQueryFormData);\n      const body = encodeURIComponent(t('%s%s', 'Check out this chart: ', url));\n      window.location.href = `mailto:?Subject=${subject}%20&Body=${body}`;\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, latestQueryFormData]);\n\n  const exportCSV = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            ownState,\n            resultType: 'full',\n            resultFormat: 'csv',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const exportCSVPivoted = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            resultType: 'post_processed',\n            resultFormat: 'csv',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const exportJson = useCallback(\n    () =>\n      exportChart({\n        formData: latestQueryFormData,\n        resultType: 'results',\n        resultFormat: 'json',\n      }),\n    [latestQueryFormData],\n  );\n\n  const exportExcel = useCallback(\n    () =>\n      exportChart({\n        formData: latestQueryFormData,\n        resultType: 'results',\n        resultFormat: 'xlsx',\n      }),\n    [latestQueryFormData],\n  );\n\n  const copyLink = useCallback(async () => {\n    try {\n      if (!latestQueryFormData) {\n        throw new Error();\n      }\n      await copyTextToClipboard(() => getChartPermalink(latestQueryFormData));\n      addSuccessToast(t('Copied to clipboard!'));\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, addSuccessToast, latestQueryFormData]);\n\n  const handleMenuClick = useCallback(\n    ({ key, domEvent }) => {\n      switch (key) {\n        case MENU_KEYS.EDIT_PROPERTIES:\n          onOpenPropertiesModal();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV:\n          exportCSV();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV_PIVOTED:\n          exportCSVPivoted();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.EXPORT_TO_JSON:\n          exportJson();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n\n          break;\n        case MENU_KEYS.EXPORT_TO_XLSX:\n          exportExcel();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.DOWNLOAD_AS_IMAGE:\n          downloadAsImage(\n            '.panel-body .chart-container',\n            // eslint-disable-next-line camelcase\n            slice?.slice_name ?? t('New chart'),\n            true,\n          )(domEvent);\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.COPY_PERMALINK:\n          copyLink();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.EMBED_CODE:\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.SHARE_BY_EMAIL:\n          shareByEmail();\n          setIsDropdownVisible(false);\n          setOpenSubmenus([]);\n          break;\n        case MENU_KEYS.VIEW_QUERY:\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.RUN_IN_SQL_LAB:\n          onOpenInEditor(latestQueryFormData);\n          setIsDropdownVisible(false);\n          break;\n        default:\n          break;\n      }\n    },\n    [\n      copyLink,\n      exportCSV,\n      exportCSVPivoted,\n      exportJson,\n      latestQueryFormData,\n      onOpenInEditor,\n      onOpenPropertiesModal,\n      shareByEmail,\n      slice?.slice_name,\n    ],\n  );\n\n  const menu = useMemo(\n    () => (\n      <Menu\n        onClick={handleMenuClick}\n        selectable={false}\n        openKeys={openSubmenus}\n        onOpenChange={setOpenSubmenus}\n      >\n        <>\n          {slice && (\n            <Menu.Item key={MENU_KEYS.EDIT_PROPERTIES}>\n              {t('Edit chart properties')}\n            </Menu.Item>\n          )}\n          <Menu.SubMenu\n            title={t('Dashboards added to')}\n            key={MENU_KEYS.DASHBOARDS_ADDED_TO}\n          >\n            <DashboardsSubMenu\n              chartId={slice?.slice_id}\n              dashboards={dashboards}\n            />\n          </Menu.SubMenu>\n          <Menu.Divider />\n        </>\n        <Menu.SubMenu title={t('Download')} key={MENU_KEYS.DOWNLOAD_SUBMENU}>\n          {VIZ_TYPES_PIVOTABLE.includes(latestQueryFormData.viz_type) ? (\n            <>\n              <Menu.Item\n                key={MENU_KEYS.EXPORT_TO_CSV}\n                icon={<Icons.FileOutlined css={iconReset} />}\n                disabled={!canDownloadCSV}\n              >\n                {t('Export to original .CSV')}\n              </Menu.Item>\n              <Menu.Item\n                key={MENU_KEYS.EXPORT_TO_CSV_PIVOTED}\n                icon={<Icons.FileOutlined css={iconReset} />}\n                disabled={!canDownloadCSV}\n              >\n                {t('Export to pivoted .CSV')}\n              </Menu.Item>\n            </>\n          ) : (\n            <Menu.Item\n              key={MENU_KEYS.EXPORT_TO_CSV}\n              icon={<Icons.FileOutlined css={iconReset} />}\n              disabled={!canDownloadCSV}\n            >\n              {t('Export to .CSV')}\n            </Menu.Item>\n          )}\n          <Menu.Item\n            key={MENU_KEYS.EXPORT_TO_JSON}\n            icon={<Icons.FileOutlined css={iconReset} />}\n          >\n            {t('Export to .JSON')}\n          </Menu.Item>\n          <Menu.Item\n            key={MENU_KEYS.DOWNLOAD_AS_IMAGE}\n            icon={<Icons.FileImageOutlined css={iconReset} />}\n          >\n            {t('Download as image')}\n          </Menu.Item>\n          <Menu.Item\n            key={MENU_KEYS.EXPORT_TO_XLSX}\n            icon={<Icons.FileOutlined css={iconReset} />}\n          >\n            {t('Export to Excel')}\n          </Menu.Item>\n        </Menu.SubMenu>\n        <Menu.SubMenu title={t('Share')} key={MENU_KEYS.SHARE_SUBMENU}>\n          <Menu.Item key={MENU_KEYS.COPY_PERMALINK}>\n            {t('Copy permalink to clipboard')}\n          </Menu.Item>\n          <Menu.Item key={MENU_KEYS.SHARE_BY_EMAIL}>\n            {t('Share chart by email')}\n          </Menu.Item>\n          {isFeatureEnabled(FeatureFlag.EMBEDDABLE_CHARTS) ? (\n            <Menu.Item key={MENU_KEYS.EMBED_CODE}>\n              <ModalTrigger\n                triggerNode={\n                  <span data-test=\"embed-code-button\">{t('Embed code')}</span>\n                }\n                modalTitle={t('Embed code')}\n                modalBody={\n                  <EmbedCodeContent\n                    formData={latestQueryFormData}\n                    addDangerToast={addDangerToast}\n                  />\n                }\n                maxWidth={`${theme.gridUnit * 100}px`}\n                destroyOnClose\n                responsive\n              />\n            </Menu.Item>\n          ) : null}\n        </Menu.SubMenu>\n        <Menu.Divider />\n        {showReportSubMenu ? (\n          <>\n            <Menu.SubMenu title={t('Manage email report')}>\n              <HeaderReportDropDown\n                chart={chart}\n                setShowReportSubMenu={setShowReportSubMenu}\n                showReportSubMenu={showReportSubMenu}\n                setIsDropdownVisible={setIsDropdownVisible}\n                isDropdownVisible={isDropdownVisible}\n                useTextMenu\n              />\n            </Menu.SubMenu>\n            <Menu.Divider />\n          </>\n        ) : (\n          <Menu>\n            <HeaderReportDropDown\n              chart={chart}\n              setShowReportSubMenu={setShowReportSubMenu}\n              setIsDropdownVisible={setIsDropdownVisible}\n              isDropdownVisible={isDropdownVisible}\n              useTextMenu\n            />\n          </Menu>\n        )}\n        <Menu.Item key={MENU_KEYS.VIEW_QUERY}>\n          <ModalTrigger\n            triggerNode={\n              <span data-test=\"view-query-menu-item\">{t('View query')}</span>\n            }\n            modalTitle={t('View query')}\n            modalBody={\n              <ViewQueryModal latestQueryFormData={latestQueryFormData} />\n            }\n            draggable\n            resizable\n            responsive\n          />\n        </Menu.Item>\n        {datasource && (\n          <Menu.Item key={MENU_KEYS.RUN_IN_SQL_LAB}>\n            {t('Run in SQL Lab')}\n          </Menu.Item>\n        )}\n      </Menu>\n    ),\n    [\n      addDangerToast,\n      canDownloadCSV,\n      chart,\n      dashboards,\n      handleMenuClick,\n      isDropdownVisible,\n      latestQueryFormData,\n      openSubmenus,\n      showReportSubMenu,\n      slice,\n      theme.gridUnit,\n    ],\n  );\n  return [menu, isDropdownVisible, setIsDropdownVisible];\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { ReactNode } from 'react';\nimport { css, SupersetTheme } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Tooltip } from 'src/components/Tooltip';\n\nexport const MenuItemTooltip = ({\n  title,\n  color,\n}: {\n  title: ReactNode;\n  color?: string;\n}) => (\n  <Tooltip title={title} placement=\"top\">\n    <Icons.InfoCircleOutlined\n      data-test=\"tooltip-trigger\"\n      css={(theme: SupersetTheme) => css`\n        color: ${color || theme.colors.text.label};\n        margin-left: ${theme.gridUnit * 2}px;\n        &.anticon {\n          font-size: unset;\n          .anticon {\n            line-height: unset;\n            vertical-align: unset;\n          }\n        }\n      `}\n    />\n  </Tooltip>\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { BOOL_FALSE_DISPLAY, BOOL_TRUE_DISPLAY } from 'src/constants';\n\nexport interface BooleanCellProps {\n  value?: boolean;\n}\n\nfunction BooleanCell({ value }: BooleanCellProps) {\n  return <span>{value ? BOOL_TRUE_DISPLAY : BOOL_FALSE_DISPLAY}</span>;\n}\n\nexport default BooleanCell;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { css, SupersetTheme } from '@superset-ui/core';\nimport { NULL_DISPLAY } from 'src/constants';\n\nfunction NullCell() {\n  return (\n    <span\n      css={(theme: SupersetTheme) =>\n        css`\n          color: ${theme.colors.grayscale.light1};\n        `\n      }\n    >\n      {NULL_DISPLAY}\n    </span>\n  );\n}\n\nexport default NullCell;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { getTimeFormatter, TimeFormats } from '@superset-ui/core';\nimport NullCell from '../NullCell';\n\nexport interface TimeCellProps {\n  format?: string;\n  value?: number | Date;\n}\n\nfunction TimeCell({\n  format = TimeFormats.DATABASE_DATETIME,\n  value,\n}: TimeCellProps) {\n  if (value) {\n    return <span>{getTimeFormatter(format).format(value)}</span>;\n  }\n  return <NullCell />;\n}\n\nexport default TimeCell;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { css, useTheme } from '@superset-ui/core';\nimport { Radio } from 'src/components/Radio';\nimport { Space } from 'src/components';\nimport Icons from 'src/components/Icons';\nimport Popover from 'src/components/Popover';\n\nexport interface HeaderWithRadioGroupProps {\n  headerTitle: string;\n  groupTitle: string;\n  groupOptions: { label: string; value: string | number }[];\n  value?: string | number;\n  onChange: (value: string) => void;\n}\n\nfunction HeaderWithRadioGroup(props: HeaderWithRadioGroupProps) {\n  const { headerTitle, groupTitle, groupOptions, value, onChange } = props;\n  const theme = useTheme();\n  const [popoverVisible, setPopoverVisible] = useState(false);\n\n  return (\n    <div\n      css={css`\n        display: flex;\n        align-items: center;\n      `}\n    >\n      <Popover\n        trigger=\"click\"\n        visible={popoverVisible}\n        content={\n          <div>\n            <div\n              css={css`\n                font-weight: ${theme.typography.weights.bold};\n                margin-bottom: ${theme.gridUnit}px;\n              `}\n            >\n              {groupTitle}\n            </div>\n            <Radio.Group\n              value={value}\n              onChange={e => {\n                onChange(e.target.value);\n                setPopoverVisible(false);\n              }}\n            >\n              <Space direction=\"vertical\">\n                {groupOptions.map(option => (\n                  <Radio key={option.value} value={option.value}>\n                    {option.label}\n                  </Radio>\n                ))}\n              </Space>\n            </Radio.Group>\n          </div>\n        }\n        placement=\"bottomLeft\"\n        arrowPointAtCenter\n      >\n        <Icons.SettingOutlined\n          iconSize=\"m\"\n          iconColor={theme.colors.grayscale.light1}\n          css={css`\n            margin-top: 3px; // we need exactly 3px to align the icon\n            margin-right: ${theme.gridUnit}px;\n          `}\n          onClick={() => setPopoverVisible(true)}\n        />\n      </Popover>\n      {headerTitle}\n    </div>\n  );\n}\n\nexport default HeaderWithRadioGroup;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useCallback, useMemo } from 'react';\nimport { Tag } from 'antd';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  isAdhocColumn,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport RowCountLabel from 'src/explore/components/RowCountLabel';\nimport Icons from 'src/components/Icons';\n\nexport default function TableControls({\n  filters,\n  setFilters,\n  totalCount,\n  loading,\n  onReload,\n}: {\n  filters: BinaryQueryObjectFilterClause[];\n  setFilters: (filters: BinaryQueryObjectFilterClause[]) => void;\n  totalCount?: number;\n  loading: boolean;\n  onReload: () => void;\n}) {\n  const theme = useTheme();\n  const filterMap: Record<string, BinaryQueryObjectFilterClause> = useMemo(\n    () =>\n      Object.assign(\n        {},\n        ...filters.map(filter => ({\n          [isAdhocColumn(filter.col)\n            ? (filter.col.label as string)\n            : filter.col]: filter,\n        })),\n      ),\n    [filters],\n  );\n\n  const removeFilter = useCallback(\n    colName => {\n      const updatedFilterMap = { ...filterMap };\n      delete updatedFilterMap[colName];\n      setFilters([...Object.values(updatedFilterMap)]);\n    },\n    [filterMap, setFilters],\n  );\n\n  const filterTags = useMemo(\n    () =>\n      Object.entries(filterMap)\n        .map(([colName, { val, formattedVal }]) => ({\n          colName,\n          val: formattedVal ?? val,\n        }))\n        .sort((a, b) => a.colName.localeCompare(b.colName)),\n    [filterMap],\n  );\n\n  return (\n    <div\n      css={css`\n        display: flex;\n        justify-content: space-between;\n        padding: ${theme.gridUnit / 2}px 0;\n        margin-bottom: ${theme.gridUnit * 2}px;\n      `}\n    >\n      <div\n        css={css`\n          display: flex;\n          flex-wrap: wrap;\n          margin-bottom: -${theme.gridUnit * 4}px;\n        `}\n      >\n        {filterTags.map(({ colName, val }) => (\n          <Tag\n            closable\n            onClose={removeFilter.bind(null, colName)}\n            key={colName}\n            css={css`\n              height: ${theme.gridUnit * 6}px;\n              display: flex;\n              align-items: center;\n              padding: ${theme.gridUnit / 2}px ${theme.gridUnit * 2}px;\n              margin-right: ${theme.gridUnit * 4}px;\n              margin-bottom: ${theme.gridUnit * 4}px;\n              line-height: 1.2;\n            `}\n            data-test=\"filter-col\"\n          >\n            <span\n              css={css`\n                margin-right: ${theme.gridUnit}px;\n              `}\n            >\n              {colName}\n            </span>\n            <strong data-test=\"filter-val\">{val}</strong>\n          </Tag>\n        ))}\n      </div>\n      <div\n        css={css`\n          display: flex;\n          align-items: center;\n          height: min-content;\n        `}\n      >\n        <RowCountLabel loading={loading && !totalCount} rowcount={totalCount} />\n        <Icons.ReloadOutlined\n          iconColor={theme.colors.grayscale.light1}\n          iconSize=\"l\"\n          aria-label={t('Reload')}\n          role=\"button\"\n          onClick={onReload}\n        />\n      </div>\n    </div>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useState,\n  useEffect,\n  useMemo,\n  useCallback,\n  useRef,\n  ReactElement,\n} from 'react';\nimport { useSelector } from 'react-redux';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  ensureIsArray,\n  t,\n  useTheme,\n  QueryFormData,\n  JsonObject,\n  GenericDataType,\n} from '@superset-ui/core';\nimport { useResizeDetector } from 'react-resize-detector';\nimport Loading from 'src/components/Loading';\nimport BooleanCell from 'src/components/Table/cell-renderers/BooleanCell';\nimport NullCell from 'src/components/Table/cell-renderers/NullCell';\nimport TimeCell from 'src/components/Table/cell-renderers/TimeCell';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport Table, {\n  ColumnsType,\n  TablePaginationConfig,\n  TableSize,\n} from 'src/components/Table';\nimport MetadataBar, {\n  ContentType,\n  MetadataType,\n} from 'src/components/MetadataBar';\nimport Alert from 'src/components/Alert';\nimport { useApiV1Resource } from 'src/hooks/apiResources';\nimport HeaderWithRadioGroup from 'src/components/Table/header-renderers/HeaderWithRadioGroup';\nimport TableControls from './DrillDetailTableControls';\nimport { getDrillPayload } from './utils';\nimport { Dataset, ResultsPage } from './types';\n\nconst PAGE_SIZE = 50;\n\ninterface DataType {\n  [key: string]: any;\n}\n\n// Must be outside of the main component due to problems in\n// react-resize-detector with conditional rendering\n// https://github.com/maslianok/react-resize-detector/issues/178\nfunction Resizable({ children }: { children: ReactElement }) {\n  const { ref, height } = useResizeDetector();\n  return (\n    <div ref={ref} css={{ flex: 1 }}>\n      {React.cloneElement(children, { height })}\n    </div>\n  );\n}\n\nenum TimeFormatting {\n  Original,\n  Formatted,\n}\n\nexport default function DrillDetailPane({\n  formData,\n  initialFilters,\n}: {\n  formData: QueryFormData;\n  initialFilters: BinaryQueryObjectFilterClause[];\n}) {\n  const theme = useTheme();\n  const [pageIndex, setPageIndex] = useState(0);\n  const lastPageIndex = useRef(pageIndex);\n  const [filters, setFilters] = useState(initialFilters);\n  const [isLoading, setIsLoading] = useState(false);\n  const [responseError, setResponseError] = useState('');\n  const [resultsPages, setResultsPages] = useState<Map<number, ResultsPage>>(\n    new Map(),\n  );\n  const [timeFormatting, setTimeFormatting] = useState({});\n\n  const SAMPLES_ROW_LIMIT = useSelector(\n    (state: { common: { conf: JsonObject } }) =>\n      state.common.conf.SAMPLES_ROW_LIMIT,\n  );\n\n  // Extract datasource ID/type from string ID\n  const [datasourceId, datasourceType] = useMemo(\n    () => formData.datasource.split('__'),\n    [formData.datasource],\n  );\n\n  // Get page of results\n  const resultsPage = useMemo(() => {\n    const nextResultsPage = resultsPages.get(pageIndex);\n    if (nextResultsPage) {\n      lastPageIndex.current = pageIndex;\n      return nextResultsPage;\n    }\n\n    return resultsPages.get(lastPageIndex.current);\n  }, [pageIndex, resultsPages]);\n\n  const mappedColumns: ColumnsType<DataType> = useMemo(\n    () =>\n      resultsPage?.colNames.map((column, index) => ({\n        key: column,\n        dataIndex: column,\n        title:\n          resultsPage?.colTypes[index] === GenericDataType.TEMPORAL ? (\n            <HeaderWithRadioGroup\n              headerTitle={column}\n              groupTitle={t('Formatting')}\n              groupOptions={[\n                { label: t('Original value'), value: TimeFormatting.Original },\n                {\n                  label: t('Formatted value'),\n                  value: TimeFormatting.Formatted,\n                },\n              ]}\n              value={\n                timeFormatting[column] === TimeFormatting.Original\n                  ? TimeFormatting.Original\n                  : TimeFormatting.Formatted\n              }\n              onChange={value =>\n                setTimeFormatting(state => ({ ...state, [column]: value }))\n              }\n            />\n          ) : (\n            column\n          ),\n        render: value => {\n          if (value === true || value === false) {\n            return <BooleanCell value={value} />;\n          }\n          if (value === null) {\n            return <NullCell />;\n          }\n          if (\n            resultsPage?.colTypes[index] === GenericDataType.TEMPORAL &&\n            timeFormatting[column] !== TimeFormatting.Original &&\n            (typeof value === 'number' || value instanceof Date)\n          ) {\n            return <TimeCell value={value} />;\n          }\n          return String(value);\n        },\n        width: 150,\n      })) || [],\n    [resultsPage?.colNames, resultsPage?.colTypes, timeFormatting],\n  );\n\n  const data: DataType[] = useMemo(\n    () =>\n      resultsPage?.data.map((row, index) =>\n        resultsPage?.colNames.reduce(\n          (acc, curr) => ({ ...acc, [curr]: row[curr] }),\n          {\n            key: index,\n          },\n        ),\n      ) || [],\n    [resultsPage?.colNames, resultsPage?.data],\n  );\n\n  // Clear cache on reload button click\n  const handleReload = useCallback(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, []);\n\n  // Clear cache and reset page index if filters change\n  useEffect(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, [filters]);\n\n  // Update cache order if page in cache\n  useEffect(() => {\n    if (\n      resultsPages.has(pageIndex) &&\n      [...resultsPages.keys()].at(-1) !== pageIndex\n    ) {\n      const nextResultsPages = new Map(resultsPages);\n      nextResultsPages.delete(pageIndex);\n      setResultsPages(\n        nextResultsPages.set(\n          pageIndex,\n          resultsPages.get(pageIndex) as ResultsPage,\n        ),\n      );\n    }\n  }, [pageIndex, resultsPages]);\n\n  // Download page of results & trim cache if page not in cache\n  useEffect(() => {\n    if (!responseError && !isLoading && !resultsPages.has(pageIndex)) {\n      setIsLoading(true);\n      const jsonPayload = getDrillPayload(formData, filters) ?? {};\n      const cachePageLimit = Math.ceil(SAMPLES_ROW_LIMIT / PAGE_SIZE);\n      getDatasourceSamples(\n        datasourceType,\n        datasourceId,\n        false,\n        jsonPayload,\n        PAGE_SIZE,\n        pageIndex + 1,\n      )\n        .then(response => {\n          setResultsPages(\n            new Map([\n              ...[...resultsPages.entries()].slice(-cachePageLimit + 1),\n              [\n                pageIndex,\n                {\n                  total: response.total_count,\n                  data: response.data,\n                  colNames: ensureIsArray(response.colnames),\n                  colTypes: ensureIsArray(response.coltypes),\n                },\n              ],\n            ]),\n          );\n          setResponseError('');\n        })\n        .catch(error => {\n          setResponseError(`${error.name}: ${error.message}`);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [\n    SAMPLES_ROW_LIMIT,\n    datasourceId,\n    datasourceType,\n    filters,\n    formData,\n    isLoading,\n    pageIndex,\n    responseError,\n    resultsPages,\n  ]);\n\n  // Get datasource metadata\n  const response = useApiV1Resource<Dataset>(`/api/v1/dataset/${datasourceId}`);\n\n  const bootstrapping =\n    (!responseError && !resultsPages.size) || response.status === 'loading';\n\n  let tableContent = null;\n  if (responseError) {\n    // Render error if page download failed\n    tableContent = (\n      <pre\n        css={css`\n          margin-top: ${theme.gridUnit * 4}px;\n        `}\n      >\n        {responseError}\n      </pre>\n    );\n  } else if (bootstrapping) {\n    // Render loading if first page hasn't loaded\n    tableContent = <Loading />;\n  } else if (resultsPage?.total === 0) {\n    // Render empty state if no results are returned for page\n    const title = t('No rows were returned for this dataset');\n    tableContent = <EmptyStateMedium image=\"document.svg\" title={title} />;\n  } else {\n    // Render table if at least one page has successfully loaded\n    tableContent = (\n      <Resizable>\n        <Table\n          data={data}\n          columns={mappedColumns}\n          size={TableSize.SMALL}\n          defaultPageSize={PAGE_SIZE}\n          recordCount={resultsPage?.total}\n          usePagination\n          loading={isLoading}\n          onChange={(pagination: TablePaginationConfig) =>\n            setPageIndex(pagination.current ? pagination.current - 1 : 0)\n          }\n          resizable\n          virtualize\n        />\n      </Resizable>\n    );\n  }\n\n  const metadata = useMemo(() => {\n    const { status, result } = response;\n    const items: ContentType[] = [];\n    if (result) {\n      const {\n        changed_on_humanized,\n        created_on_humanized,\n        description,\n        table_name,\n        changed_by,\n        created_by,\n        owners,\n      } = result;\n      const notAvailable = t('Not available');\n      const createdBy =\n        `${created_by?.first_name ?? ''} ${\n          created_by?.last_name ?? ''\n        }`.trim() || notAvailable;\n      const modifiedBy = changed_by\n        ? `${changed_by.first_name} ${changed_by.last_name}`\n        : notAvailable;\n      const formattedOwners =\n        owners.length > 0\n          ? owners.map(owner => `${owner.first_name} ${owner.last_name}`)\n          : [notAvailable];\n      items.push({\n        type: MetadataType.TABLE,\n        title: table_name,\n      });\n      items.push({\n        type: MetadataType.LAST_MODIFIED,\n        value: changed_on_humanized,\n        modifiedBy,\n      });\n      items.push({\n        type: MetadataType.OWNER,\n        createdBy,\n        owners: formattedOwners,\n        createdOn: created_on_humanized,\n      });\n      if (description) {\n        items.push({\n          type: MetadataType.DESCRIPTION,\n          value: description,\n        });\n      }\n    }\n    return (\n      <div\n        css={css`\n          display: flex;\n          margin-bottom: ${theme.gridUnit * 4}px;\n        `}\n      >\n        {status === 'complete' && (\n          <MetadataBar items={items} tooltipPlacement=\"bottom\" />\n        )}\n        {status === 'error' && (\n          <Alert\n            type=\"error\"\n            message={t('There was an error loading the dataset metadata')}\n          />\n        )}\n      </div>\n    );\n  }, [response, theme.gridUnit]);\n\n  return (\n    <>\n      {!bootstrapping && metadata}\n      {!bootstrapping && (\n        <TableControls\n          filters={filters}\n          setFilters={setFilters}\n          totalCount={resultsPage?.total}\n          loading={isLoading}\n          onReload={handleReload}\n        />\n      )}\n      {tableContent}\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { omit } from 'lodash';\nimport {\n  ensureIsArray,\n  QueryFormData,\n  BinaryQueryObjectFilterClause,\n  buildQueryObject,\n} from '@superset-ui/core';\n\nexport function getDrillPayload(\n  queryFormData?: QueryFormData,\n  drillFilters?: BinaryQueryObjectFilterClause[],\n) {\n  if (!queryFormData) {\n    return undefined;\n  }\n  const queryObject = buildQueryObject(queryFormData);\n  const extras = omit(queryObject.extras, 'having');\n  const filters = [\n    ...ensureIsArray(queryObject.filters),\n    ...ensureIsArray(drillFilters).map(f => omit(f, 'formattedVal')),\n  ];\n  return {\n    granularity: queryObject.granularity,\n    time_range: queryObject.time_range,\n    filters,\n    extras,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useCallback, useContext, useMemo } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { useSelector } from 'react-redux';\nimport { DashboardPageIdContext } from 'src/dashboard/containers/DashboardPage';\nimport { Slice } from 'src/types/Chart';\nimport DrillDetailPane from './DrillDetailPane';\n\ninterface ModalFooterProps {\n  exploreChart: () => void;\n  closeModal?: () => void;\n}\n\nconst ModalFooter = ({ exploreChart, closeModal }: ModalFooterProps) => (\n  <>\n    <Button buttonStyle=\"secondary\" buttonSize=\"small\" onClick={exploreChart}>\n      {t('Edit chart')}\n    </Button>\n    <Button\n      buttonStyle=\"primary\"\n      buttonSize=\"small\"\n      onClick={closeModal}\n      data-test=\"close-drilltodetail-modal\"\n    >\n      {t('Close')}\n    </Button>\n  </>\n);\n\ninterface DrillDetailModalProps {\n  chartId: number;\n  formData: QueryFormData;\n  initialFilters: BinaryQueryObjectFilterClause[];\n  showModal: boolean;\n  onHideModal: () => void;\n}\n\nexport default function DrillDetailModal({\n  chartId,\n  formData,\n  initialFilters,\n  showModal,\n  onHideModal,\n}: DrillDetailModalProps) {\n  const theme = useTheme();\n  const history = useHistory();\n  const dashboardPageId = useContext(DashboardPageIdContext);\n  const { slice_name: chartName } = useSelector(\n    (state: { sliceEntities: { slices: Record<number, Slice> } }) =>\n      state.sliceEntities.slices[chartId],\n  );\n\n  const exploreUrl = useMemo(\n    () => `/explore/?dashboard_page_id=${dashboardPageId}&slice_id=${chartId}`,\n    [chartId, dashboardPageId],\n  );\n\n  const exploreChart = useCallback(() => {\n    history.push(exploreUrl);\n  }, [exploreUrl, history]);\n\n  return (\n    <Modal\n      show={showModal}\n      onHide={onHideModal ?? (() => null)}\n      css={css`\n        .ant-modal-body {\n          display: flex;\n          flex-direction: column;\n        }\n      `}\n      title={t('Drill to detail: %s', chartName)}\n      footer={<ModalFooter exploreChart={exploreChart} />}\n      responsive\n      resizable\n      resizableConfig={{\n        minHeight: theme.gridUnit * 128,\n        minWidth: theme.gridUnit * 128,\n        defaultSize: {\n          width: 'auto',\n          height: '75vh',\n        },\n      }}\n      draggable\n      destroyOnClose\n      maskClosable={false}\n    >\n      <DrillDetailPane formData={formData} initialFilters={initialFilters} />\n    </Modal>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { ReactNode, useCallback, useMemo, useState } from 'react';\nimport { isEmpty } from 'lodash';\nimport {\n  Behavior,\n  BinaryQueryObjectFilterClause,\n  css,\n  extractQueryFields,\n  getChartMetadataRegistry,\n  QueryFormData,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport { Menu } from 'src/components/Menu';\nimport DrillDetailModal from './DrillDetailModal';\nimport { getMenuAdjustedY, MENU_ITEM_HEIGHT } from '../utils';\nimport { MenuItemTooltip } from '../DisabledMenuItemTooltip';\n\nconst MENU_PADDING = 4;\nconst DRILL_TO_DETAIL_TEXT = t('Drill to detail by');\n\nconst DisabledMenuItem = ({ children, ...props }: { children: ReactNode }) => (\n  <Menu.Item disabled {...props}>\n    <div\n      css={css`\n        white-space: normal;\n        max-width: 160px;\n      `}\n    >\n      {children}\n    </div>\n  </Menu.Item>\n);\n\nconst Filter = styled.span`\n  ${({ theme }) => `\n     font-weight: ${theme.typography.weights.bold};\n     color: ${theme.colors.primary.base};\n   `}\n`;\n\nexport type DrillDetailMenuItemsProps = {\n  chartId: number;\n  formData: QueryFormData;\n  filters?: BinaryQueryObjectFilterClause[];\n  isContextMenu?: boolean;\n  contextMenuY?: number;\n  onSelection?: () => void;\n  onClick?: (event: MouseEvent) => void;\n};\n\nconst DrillDetailMenuItems = ({\n  chartId,\n  formData,\n  filters = [],\n  isContextMenu = false,\n  contextMenuY = 0,\n  onSelection = () => null,\n  onClick = () => null,\n  ...props\n}: DrillDetailMenuItemsProps) => {\n  const [modalFilters, setFilters] = useState<BinaryQueryObjectFilterClause[]>(\n    [],\n  );\n\n  const [showModal, setShowModal] = useState(false);\n  const openModal = useCallback(\n    (filters, event) => {\n      onClick(event);\n      onSelection();\n      setFilters(filters);\n      setShowModal(true);\n    },\n    [onClick, onSelection],\n  );\n\n  const closeModal = useCallback(() => {\n    setShowModal(false);\n  }, []);\n\n  // Check for Behavior.DRILL_TO_DETAIL to tell if plugin handles the `contextmenu`\n  // event for dimensions.  If it doesn't, tell the user that drill to detail by\n  // dimension is not supported.  If it does, and the `contextmenu` handler didn't\n  // pass any filters, tell the user that they didn't select a dimension.\n  const handlesDimensionContextMenu = useMemo(\n    () =>\n      getChartMetadataRegistry()\n        .get(formData.viz_type)\n        ?.behaviors.find(behavior => behavior === Behavior.DRILL_TO_DETAIL),\n    [formData.viz_type],\n  );\n\n  // Check metrics to see if chart's current configuration lacks\n  // aggregations, in which case Drill to Detail should be disabled.\n  const noAggregations = useMemo(() => {\n    const { metrics } = extractQueryFields(formData);\n    return isEmpty(metrics);\n  }, [formData]);\n\n  let drillToDetailMenuItem;\n  if (handlesDimensionContextMenu && noAggregations) {\n    drillToDetailMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-no-aggregations\">\n        {t('Drill to detail')}\n        <MenuItemTooltip\n          title={t(\n            'Drill to detail is disabled because this chart does not group data by dimension value.',\n          )}\n        />\n      </DisabledMenuItem>\n    );\n  } else {\n    drillToDetailMenuItem = (\n      <Menu.Item\n        {...props}\n        key=\"drill-detail-no-filters\"\n        onClick={openModal.bind(null, [])}\n      >\n        {t('Drill to detail')}\n      </Menu.Item>\n    );\n  }\n\n  let drillToDetailByMenuItem;\n  if (!handlesDimensionContextMenu) {\n    drillToDetailByMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-by-chart-not-supported\">\n        {DRILL_TO_DETAIL_TEXT}\n        <MenuItemTooltip\n          title={t(\n            'Drill to detail by value is not yet supported for this chart type.',\n          )}\n        />\n      </DisabledMenuItem>\n    );\n  }\n\n  if (handlesDimensionContextMenu && noAggregations) {\n    drillToDetailByMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-by-no-aggregations\">\n        {DRILL_TO_DETAIL_TEXT}\n      </DisabledMenuItem>\n    );\n  }\n\n  // Ensure submenu doesn't appear offscreen\n  const submenuYOffset = useMemo(() => {\n    const itemsCount = filters.length > 1 ? filters.length + 1 : filters.length;\n    const submenuY =\n      contextMenuY + MENU_PADDING + MENU_ITEM_HEIGHT + MENU_PADDING;\n\n    return getMenuAdjustedY(submenuY, itemsCount) - submenuY;\n  }, [contextMenuY, filters.length]);\n\n  if (handlesDimensionContextMenu && !noAggregations && filters?.length) {\n    drillToDetailByMenuItem = (\n      <Menu.SubMenu\n        {...props}\n        popupOffset={[0, submenuYOffset]}\n        title={DRILL_TO_DETAIL_TEXT}\n      >\n        <div data-test=\"drill-to-detail-by-submenu\">\n          {filters.map((filter, i) => (\n            <Menu.Item\n              {...props}\n              key={`drill-detail-filter-${i}`}\n              onClick={openModal.bind(null, [filter])}\n            >\n              {`${DRILL_TO_DETAIL_TEXT} `}\n              <Filter>{filter.formattedVal}</Filter>\n            </Menu.Item>\n          ))}\n          {filters.length > 1 && (\n            <Menu.Item\n              {...props}\n              key=\"drill-detail-filter-all\"\n              onClick={openModal.bind(null, filters)}\n            >\n              {`${DRILL_TO_DETAIL_TEXT} `}\n              <Filter>{t('all')}</Filter>\n            </Menu.Item>\n          )}\n        </div>\n      </Menu.SubMenu>\n    );\n  }\n\n  if (handlesDimensionContextMenu && !noAggregations && !filters?.length) {\n    drillToDetailByMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-by-select-aggregation\">\n        {DRILL_TO_DETAIL_TEXT}\n        <MenuItemTooltip\n          title={t(\n            'Right-click on a dimension value to drill to detail by that value.',\n          )}\n        />\n      </DisabledMenuItem>\n    );\n  }\n\n  return (\n    <>\n      {drillToDetailMenuItem}\n      {isContextMenu && drillToDetailByMenuItem}\n      <DrillDetailModal\n        chartId={chartId}\n        formData={formData}\n        initialFilters={modalFilters}\n        showModal={showModal}\n        onHideModal={closeModal}\n      />\n    </>\n  );\n};\n\nexport default DrillDetailMenuItems;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport const MENU_ITEM_HEIGHT = 32;\nconst MENU_VERTICAL_SPACING = 32;\n\n/**\n * Calculates an adjusted Y-offset for a menu or submenu to prevent that\n * menu from appearing offscreen\n *\n * @param clientY The original Y-offset\n * @param itemsCount The number of menu items\n */\nexport function getMenuAdjustedY(clientY: number, itemsCount: number) {\n  // Viewport height\n  const vh = Math.max(\n    document.documentElement.clientHeight || 0,\n    window.innerHeight || 0,\n  );\n\n  const menuHeight = MENU_ITEM_HEIGHT * itemsCount + MENU_VERTICAL_SPACING;\n  // Always show the context menu inside the viewport\n  return vh - clientY < menuHeight ? vh - menuHeight : clientY;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { ConfigProvider } from 'antd';\nimport { styled, t } from '@superset-ui/core';\nimport ReactCronPicker, { Locale, CronProps } from 'react-js-cron';\n\nexport * from 'react-js-cron';\n\nexport const LOCALE: Locale = {\n  everyText: t('every'),\n  emptyMonths: t('every month'),\n  emptyMonthDays: t('every day of the month'),\n  emptyMonthDaysShort: t('day of the month'),\n  emptyWeekDays: t('every day of the week'),\n  emptyWeekDaysShort: t('day of the week'),\n  emptyHours: t('every hour'),\n  emptyMinutes: t('every minute'),\n  emptyMinutesForHourPeriod: t('every'),\n  yearOption: t('year'),\n  monthOption: t('month'),\n  weekOption: t('week'),\n  dayOption: t('day'),\n  hourOption: t('hour'),\n  minuteOption: t('minute'),\n  rebootOption: t('reboot'),\n  prefixPeriod: t('Every'),\n  prefixMonths: t('in'),\n  prefixMonthDays: t('on'),\n  prefixWeekDays: t('on'),\n  prefixWeekDaysForMonthAndYearPeriod: t('and'),\n  prefixHours: t('at'),\n  prefixMinutes: t(':'),\n  prefixMinutesForHourPeriod: t('at'),\n  suffixMinutesForHourPeriod: t('minute(s)'),\n  errorInvalidCron: t('Invalid cron expression'),\n  clearButtonText: t('Clear'),\n  weekDays: [\n    // Order is important, the index will be used as value\n    t('Sunday'), // Sunday must always be first, it's \"0\"\n    t('Monday'),\n    t('Tuesday'),\n    t('Wednesday'),\n    t('Thursday'),\n    t('Friday'),\n    t('Saturday'),\n  ],\n  months: [\n    // Order is important, the index will be used as value\n    t('January'),\n    t('February'),\n    t('March'),\n    t('April'),\n    t('May'),\n    t('June'),\n    t('July'),\n    t('August'),\n    t('September'),\n    t('October'),\n    t('November'),\n    t('December'),\n  ],\n  // Order is important, the index will be used as value\n  altWeekDays: [\n    t('SUN'), // Sunday must always be first, it's \"0\"\n    t('MON'),\n    t('TUE'),\n    t('WED'),\n    t('THU'),\n    t('FRI'),\n    t('SAT'),\n  ],\n  // Order is important, the index will be used as value\n  altMonths: [\n    t('JAN'),\n    t('FEB'),\n    t('MAR'),\n    t('APR'),\n    t('MAY'),\n    t('JUN'),\n    t('JUL'),\n    t('AUG'),\n    t('SEP'),\n    t('OCT'),\n    t('NOV'),\n    t('DEC'),\n  ],\n};\n\nexport const CronPicker = styled((props: CronProps) => (\n  <ConfigProvider\n    getPopupContainer={trigger => trigger.parentElement as HTMLElement}\n  >\n    <ReactCronPicker locale={LOCALE} {...props} />\n  </ConfigProvider>\n))`\n  .react-js-cron-field {\n    margin-bottom: 0px;\n  }\n  .react-js-cron-select:not(.react-js-cron-custom-select) > div:first-of-type,\n  .react-js-cron-custom-select {\n    border-radius: ${({ theme }) => theme.gridUnit}px;\n    background-color: ${({ theme }) =>\n      theme.colors.grayscale.light4} !important;\n  }\n  .react-js-cron-custom-select > div:first-of-type {\n    border-radius: ${({ theme }) => theme.gridUnit}px;\n  }\n  .react-js-cron-custom-select .ant-select-selection-placeholder {\n    flex: auto;\n  }\n  .react-js-cron-custom-select .ant-select-selection-overflow-item {\n    align-self: center;\n  }\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { RefObject } from 'react';\nimport { AntdDropdown } from 'src/components';\nimport { DropDownProps } from 'antd/lib/dropdown';\nimport { styled } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\n\nconst MenuDots = styled.div`\n  width: ${({ theme }) => theme.gridUnit * 0.75}px;\n  height: ${({ theme }) => theme.gridUnit * 0.75}px;\n  border-radius: 50%;\n  background-color: ${({ theme }) => theme.colors.grayscale.light1};\n\n  font-weight: ${({ theme }) => theme.typography.weights.normal};\n  display: inline-flex;\n  position: relative;\n\n  &:hover {\n    background-color: ${({ theme }) => theme.colors.primary.base};\n\n    &::before,\n    &::after {\n      background-color: ${({ theme }) => theme.colors.primary.base};\n    }\n  }\n\n  &::before,\n  &::after {\n    position: absolute;\n    content: ' ';\n    width: ${({ theme }) => theme.gridUnit * 0.75}px;\n    height: ${({ theme }) => theme.gridUnit * 0.75}px;\n    border-radius: 50%;\n    background-color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n\n  &::before {\n    top: ${({ theme }) => theme.gridUnit}px;\n  }\n\n  &::after {\n    bottom: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst MenuDotsWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  padding: ${({ theme }) => theme.gridUnit * 2}px;\n  padding-left: ${({ theme }) => theme.gridUnit}px;\n`;\n\nexport enum IconOrientation {\n  VERTICAL = 'vertical',\n  HORIZONTAL = 'horizontal',\n}\nexport interface DropdownProps extends DropDownProps {\n  overlay: React.ReactElement;\n  iconOrientation?: IconOrientation;\n}\n\nconst RenderIcon = (\n  iconOrientation: IconOrientation = IconOrientation.VERTICAL,\n) => {\n  const component =\n    iconOrientation === IconOrientation.HORIZONTAL ? (\n      <Icons.MoreHoriz iconSize=\"xl\" />\n    ) : (\n      <MenuDots />\n    );\n  return component;\n};\n\nexport const Dropdown = ({\n  overlay,\n  iconOrientation = IconOrientation.VERTICAL,\n  ...rest\n}: DropdownProps) => (\n  <AntdDropdown overlay={overlay} {...rest}>\n    <MenuDotsWrapper data-test=\"dropdown-trigger\">\n      {RenderIcon(iconOrientation)}\n    </MenuDotsWrapper>\n  </AntdDropdown>\n);\n\ninterface ExtendedDropDownProps extends DropDownProps {\n  ref?: RefObject<HTMLDivElement>;\n}\n\n// @z-index-below-dashboard-header (100) - 1 = 99\nexport const NoAnimationDropdown = (\n  props: ExtendedDropDownProps & { children?: React.ReactNode },\n) => (\n  <AntdDropdown\n    overlayStyle={{ zIndex: 99, animationDuration: '0s' }}\n    {...props}\n  />\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { ensureIsArray, styled, t } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { ContentType, MetadataType } from '.';\n\nconst Header = styled.div`\n  font-weight: ${({ theme }) => theme.typography.weights.bold};\n`;\n\nconst Info = ({\n  text,\n  header,\n}: {\n  text?: string | string[];\n  header?: string;\n}) => {\n  const values = ensureIsArray(text);\n  return (\n    <>\n      {header && <Header>{header}</Header>}\n      {values.map(value => (\n        <div key={value}>{value}</div>\n      ))}\n    </>\n  );\n};\n\nconst config = (contentType: ContentType) => {\n  const { type } = contentType;\n\n  /**\n   * Tooltips are very similar. It's pretty much blocks\n   * of header/text pairs. That's why they are implemented here.\n   * If more complex tooltips emerge, then we should extract the different\n   * types of tooltips to their own components and reference them here.\n   */\n\n  switch (type) {\n    case MetadataType.DASHBOARDS:\n      return {\n        icon: Icons.FundProjectionScreenOutlined,\n        title: contentType.title,\n        tooltip: contentType.description ? (\n          <div>\n            <Info header={contentType.title} text={contentType.description} />\n          </div>\n        ) : undefined,\n      };\n\n    case MetadataType.DESCRIPTION:\n      return {\n        icon: Icons.BookOutlined,\n        title: contentType.value,\n      };\n\n    case MetadataType.LAST_MODIFIED:\n      return {\n        icon: Icons.EditOutlined,\n        title: contentType.value,\n        tooltip: (\n          <div>\n            <Info header={t('Last modified')} text={contentType.value} />\n            <Info header={t('Modified by')} text={contentType.modifiedBy} />\n          </div>\n        ),\n      };\n\n    case MetadataType.OWNER:\n      return {\n        icon: Icons.UserOutlined,\n        title: contentType.createdBy,\n        tooltip: (\n          <div>\n            <Info header={t('Created by')} text={contentType.createdBy} />\n            <Info header={t('Owners')} text={contentType.owners} />\n            <Info header={t('Created on')} text={contentType.createdOn} />\n          </div>\n        ),\n      };\n\n    case MetadataType.ROWS:\n      return {\n        icon: Icons.InsertRowBelowOutlined,\n        title: contentType.title,\n        tooltip: contentType.title,\n      };\n\n    case MetadataType.SQL:\n      return {\n        icon: Icons.ConsoleSqlOutlined,\n        title: contentType.title,\n        tooltip: contentType.title,\n      };\n\n    case MetadataType.TABLE:\n      return {\n        icon: Icons.Table,\n        title: contentType.title,\n        tooltip: contentType.title,\n      };\n\n    case MetadataType.TAGS:\n      return {\n        icon: Icons.TagsOutlined,\n        title: contentType.values.join(', '),\n        tooltip: (\n          <div>\n            <Info header={t('Tags')} text={contentType.values} />\n          </div>\n        ),\n      };\n\n    default:\n      throw Error(`Invalid type provided: ${type}`);\n  }\n};\n\nexport { config };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useResizeDetector } from 'react-resize-detector';\nimport { uniqWith } from 'lodash';\nimport { styled } from '@superset-ui/core';\nimport { Tooltip, TooltipPlacement } from 'src/components/Tooltip';\nimport { ContentType } from './ContentType';\nimport { config } from './ContentConfig';\n\nexport const MIN_NUMBER_ITEMS = 2;\nexport const MAX_NUMBER_ITEMS = 6;\n\nconst HORIZONTAL_PADDING = 12;\nconst VERTICAL_PADDING = 8;\nconst ICON_PADDING = 8;\nconst SPACE_BETWEEN_ITEMS = 16;\nconst ICON_WIDTH = 16;\nconst TEXT_MIN_WIDTH = 70;\nconst TEXT_MAX_WIDTH = 150;\nconst ORDER = {\n  dashboards: 0,\n  table: 1,\n  sql: 2,\n  rows: 3,\n  tags: 4,\n  description: 5,\n  owner: 6,\n  lastModified: 7,\n};\n\nconst Bar = styled.div<{ count: number }>`\n  ${({ theme, count }) => `\n    display: flex;\n    align-items: center;\n    padding: ${VERTICAL_PADDING}px ${HORIZONTAL_PADDING}px;\n    background-color: ${theme.colors.grayscale.light4};\n    color: ${theme.colors.grayscale.base};\n    font-size: ${theme.typography.sizes.s}px;\n    min-width: ${\n      HORIZONTAL_PADDING * 2 +\n      (ICON_WIDTH + SPACE_BETWEEN_ITEMS) * count -\n      SPACE_BETWEEN_ITEMS\n    }px;\n    border-radius: ${theme.borderRadius}px;\n    line-height: 1;\n  `}\n`;\n\nconst StyledItem = styled.div<{\n  collapsed: boolean;\n  last: boolean;\n  onClick?: () => void;\n}>`\n  ${({ theme, collapsed, last, onClick }) => `\n    display: flex;\n    align-items: center;\n    max-width: ${\n      ICON_WIDTH +\n      ICON_PADDING +\n      TEXT_MAX_WIDTH +\n      (last ? 0 : SPACE_BETWEEN_ITEMS)\n    }px;\n    min-width: ${\n      collapsed\n        ? ICON_WIDTH + (last ? 0 : SPACE_BETWEEN_ITEMS)\n        : ICON_WIDTH +\n          ICON_PADDING +\n          TEXT_MIN_WIDTH +\n          (last ? 0 : SPACE_BETWEEN_ITEMS)\n    }px;\n    padding-right: ${last ? 0 : SPACE_BETWEEN_ITEMS}px;\n    cursor: ${onClick ? 'pointer' : 'default'};\n    & .metadata-icon {\n      color: ${\n        onClick && collapsed\n          ? theme.colors.primary.base\n          : theme.colors.grayscale.base\n      };\n      padding-right: ${collapsed ? 0 : ICON_PADDING}px;\n      & .anticon {\n        line-height: 0;\n      }\n    }\n    & .metadata-text {\n      min-width: ${TEXT_MIN_WIDTH}px;\n      overflow: hidden;\n      text-overflow: ${collapsed ? 'unset' : 'ellipsis'};\n      white-space: nowrap;\n      text-decoration: ${onClick ? 'underline' : 'none'};\n    }\n  `}\n`;\n\n// Make sure big tootips are truncated\nconst TootipContent = styled.div`\n  display: -webkit-box;\n  -webkit-line-clamp: 20;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst Item = ({\n  barWidth,\n  contentType,\n  collapsed,\n  last = false,\n  tooltipPlacement,\n}: {\n  barWidth: number | undefined;\n  contentType: ContentType;\n  collapsed: boolean;\n  last?: boolean;\n  tooltipPlacement: TooltipPlacement;\n}) => {\n  const { icon, title, tooltip = title } = config(contentType);\n  const [isTruncated, setIsTruncated] = useState(false);\n  const ref = useRef<HTMLDivElement>(null);\n  const Icon = icon;\n  const { type, onClick } = contentType;\n\n  useEffect(() => {\n    setIsTruncated(\n      ref.current ? ref.current.scrollWidth > ref.current.clientWidth : false,\n    );\n  }, [barWidth, setIsTruncated, contentType]);\n\n  const content = (\n    <StyledItem\n      collapsed={collapsed}\n      last={last}\n      onClick={onClick ? () => onClick(type) : undefined}\n    >\n      <Icon iconSize=\"l\" className=\"metadata-icon\" />\n      {!collapsed && (\n        <span ref={ref} className=\"metadata-text\">\n          {title}\n        </span>\n      )}\n    </StyledItem>\n  );\n  return isTruncated || collapsed || (tooltip && tooltip !== title) ? (\n    <Tooltip\n      placement={tooltipPlacement}\n      title={<TootipContent>{tooltip}</TootipContent>}\n    >\n      {content}\n    </Tooltip>\n  ) : (\n    content\n  );\n};\n\nexport interface MetadataBarProps {\n  /**\n   * Array of content type configurations. To see the available properties\n   * for each content type, check {@link ContentType}\n   */\n  items: ContentType[];\n  /**\n   * Antd tooltip placement. To see available values, check {@link TooltipPlacement}.\n   * Defaults to \"top\".\n   */\n  tooltipPlacement?: TooltipPlacement;\n}\n\n/**\n * The metadata bar component is used to display additional information about an entity.\n * Content types are predefined and consistent across the whole app. This means that\n * they will be displayed and behave in a consistent manner, keeping the same ordering,\n * information formatting, and interactions.\n * To extend the list of content types, a developer needs to request the inclusion of the new type in the design system.\n * This process is important to make sure the new type is reviewed by the design team, improving Superset consistency.\n */\nconst MetadataBar = ({ items, tooltipPlacement = 'top' }: MetadataBarProps) => {\n  const [width, setWidth] = useState<number>();\n  const [collapsed, setCollapsed] = useState(false);\n  const uniqueItems = uniqWith(items, (a, b) => a.type === b.type);\n  const sortedItems = uniqueItems.sort((a, b) => ORDER[a.type] - ORDER[b.type]);\n  const count = sortedItems.length;\n  if (count < MIN_NUMBER_ITEMS) {\n    throw Error('The minimum number of items for the metadata bar is 2.');\n  }\n  if (count > MAX_NUMBER_ITEMS) {\n    throw Error('The maximum number of items for the metadata bar is 6.');\n  }\n\n  const onResize = useCallback(\n    width => {\n      // Calculates the breakpoint width to collapse the bar.\n      // The last item does not have a space, so we subtract SPACE_BETWEEN_ITEMS from the total.\n      const breakpoint =\n        (ICON_WIDTH + ICON_PADDING + TEXT_MIN_WIDTH + SPACE_BETWEEN_ITEMS) *\n          count -\n        SPACE_BETWEEN_ITEMS;\n      setWidth(width);\n      setCollapsed(Boolean(width && width < breakpoint));\n    },\n    [count],\n  );\n\n  const { ref } = useResizeDetector({ onResize });\n\n  return (\n    <Bar ref={ref} count={count} data-test=\"metadata-bar\">\n      {sortedItems.map((item, index) => (\n        <Item\n          barWidth={width}\n          key={index}\n          contentType={item}\n          collapsed={collapsed}\n          last={index === count - 1}\n          tooltipPlacement={tooltipPlacement}\n        />\n      ))}\n    </Bar>\n  );\n};\n\nexport default MetadataBar;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport enum MetadataType {\n  DASHBOARDS = 'dashboards',\n  DESCRIPTION = 'description',\n  LAST_MODIFIED = 'lastModified',\n  OWNER = 'owner',\n  ROWS = 'rows',\n  SQL = 'sql',\n  TABLE = 'table',\n  TAGS = 'tags',\n}\n\nexport type Dashboards = {\n  type: MetadataType.DASHBOARDS;\n  title: string;\n  description?: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Description = {\n  type: MetadataType.DESCRIPTION;\n  value: string;\n  onClick?: (type: string) => void;\n};\n\nexport type LastModified = {\n  type: MetadataType.LAST_MODIFIED;\n  value: string;\n  modifiedBy: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Owner = {\n  type: MetadataType.OWNER;\n  createdBy: string;\n  owners: string[];\n  createdOn: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Rows = {\n  type: MetadataType.ROWS;\n  title: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Sql = {\n  type: MetadataType.SQL;\n  title: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Table = {\n  type: MetadataType.TABLE;\n  title: string;\n  onClick?: (type: string) => void;\n};\n\nexport type Tags = {\n  type: MetadataType.TAGS;\n  values: string[];\n  onClick?: (type: string) => void;\n};\n\nexport type ContentType =\n  | Dashboards\n  | Description\n  | LastModified\n  | Owner\n  | Rows\n  | Sql\n  | Table\n  | Tags;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport MetadataBar, {\n  MetadataBarProps,\n  MIN_NUMBER_ITEMS,\n  MAX_NUMBER_ITEMS,\n} from './MetadataBar';\n\nexport default MetadataBar;\n\nexport { MetadataBarProps, MIN_NUMBER_ITEMS, MAX_NUMBER_ITEMS };\n\nexport * from './ContentType';\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/**\n * Types mirroring enums in `superset/reports/models.py`:\n */\nexport type ReportScheduleType = 'Alert' | 'Report';\nexport type ReportCreationMethod = 'charts' | 'dashboards' | 'alerts_reports';\n\nexport type ReportRecipientType = 'Email' | 'Slack';\n\nexport enum ReportType {\n  DASHBOARDS = 'dashboards',\n  CHARTS = 'charts',\n}\n\nexport enum NOTIFICATION_FORMATS {\n  TEXT = 'TEXT',\n  PNG = 'PNG',\n  CSV = 'CSV',\n}\nexport interface ReportObject {\n  id?: number;\n  active: boolean;\n  crontab: string;\n  dashboard?: number;\n  chart?: number;\n  description?: string;\n  log_retention: number;\n  name: string;\n  owners: number[];\n  recipients: [\n    { recipient_config_json: { target: string }; type: ReportRecipientType },\n  ];\n  report_format: string;\n  timezone: string;\n  type: ReportScheduleType;\n  validator_config_json: {} | null;\n  validator_type: string;\n  working_timeout: number;\n  creation_method: string;\n  force_screenshot: boolean;\n  error?: string;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { styled, css, SupersetTheme } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { Radio } from 'src/components/Radio';\nimport { CronPicker } from 'src/components/CronPicker';\n\nexport const StyledModal = styled(Modal)`\n  .ant-modal-body {\n    padding: 0;\n  }\n`;\n\nexport const StyledTopSection = styled.div`\n  padding: ${({ theme }) =>\n    `${theme.gridUnit * 3}px ${theme.gridUnit * 4}px ${theme.gridUnit * 2}px`};\n  label {\n    font-size: ${({ theme }) => theme.typography.sizes.s}px;\n    color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n`;\n\nexport const StyledBottomSection = styled.div`\n  border-top: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  padding: ${({ theme }) =>\n    `${theme.gridUnit * 4}px ${theme.gridUnit * 4}px ${theme.gridUnit * 6}px`};\n  .ant-select {\n    width: 100%;\n  }\n  .control-label {\n    font-size: ${({ theme }) => theme.typography.sizes.s}px;\n    color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n`;\n\nexport const StyledIconWrapper = styled.span`\n  span {\n    margin-right: ${({ theme }) => theme.gridUnit * 2}px;\n    vertical-align: middle;\n  }\n  .text {\n    vertical-align: middle;\n  }\n`;\n\nexport const StyledScheduleTitle = styled.div`\n  margin-bottom: ${({ theme }) => theme.gridUnit * 7}px;\n\n  h4 {\n    margin-bottom: ${({ theme }) => theme.gridUnit * 3}px;\n  }\n`;\n\nexport const StyledCronPicker = styled(CronPicker)`\n  margin-bottom: ${({ theme }) => theme.gridUnit * 3}px;\n  width: ${({ theme }) => theme.gridUnit * 120}px;\n`;\n\nexport const StyledCronError = styled.p`\n  color: ${({ theme }) => theme.colors.error.base};\n`;\n\nexport const noBottomMargin = css`\n  margin-bottom: 0;\n`;\n\nexport const StyledFooterButton = styled(Button)`\n  width: ${({ theme }) => theme.gridUnit * 40}px;\n`;\n\nexport const TimezoneHeaderStyle = (theme: SupersetTheme) => css`\n  margin: ${theme.gridUnit * 3}px 0 ${theme.gridUnit * 2}px;\n`;\n\nexport const SectionHeaderStyle = (theme: SupersetTheme) => css`\n  margin: ${theme.gridUnit * 3}px 0;\n`;\n\nexport const StyledMessageContentTitle = styled.div`\n  margin: ${({ theme }) => theme.gridUnit * 8}px 0\n    ${({ theme }) => theme.gridUnit * 4}px;\n`;\n\nexport const StyledRadio = styled(Radio)`\n  display: block;\n  line-height: ${({ theme }) => theme.gridUnit * 8}px;\n`;\n\nexport const StyledRadioGroup = styled(Radio.Group)`\n  margin-left: ${({ theme }) => theme.gridUnit * 0.5}px;\n`;\n\nexport const antDErrorAlertStyles = (theme: SupersetTheme) => css`\n  border: ${theme.colors.error.base} 1px solid;\n  padding: ${theme.gridUnit * 4}px;\n  margin: ${theme.gridUnit * 4}px;\n  margin-top: 0;\n  color: ${theme.colors.error.dark2};\n  .ant-alert-message {\n    font-size: ${theme.typography.sizes.m}px;\n    font-weight: bold;\n  }\n  .ant-alert-description {\n    font-size: ${theme.typography.sizes.m}px;\n    line-height: ${theme.gridUnit * 4}px;\n    .ant-alert-icon {\n      margin-right: ${theme.gridUnit * 2.5}px;\n      font-size: ${theme.typography.sizes.l}px;\n      position: relative;\n      top: ${theme.gridUnit / 4}px;\n    }\n  }\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useState,\n  useEffect,\n  useReducer,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { t, SupersetTheme } from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { addReport, editReport } from 'src/reports/actions/reports';\nimport Alert from 'src/components/Alert';\nimport TimezoneSelector from 'src/components/TimezoneSelector';\nimport LabeledErrorBoundInput from 'src/components/Form/LabeledErrorBoundInput';\nimport Icons from 'src/components/Icons';\nimport { CronError } from 'src/components/CronPicker';\nimport { RadioChangeEvent } from 'src/components';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { ChartState } from 'src/explore/types';\nimport {\n  ReportCreationMethod,\n  ReportObject,\n  NOTIFICATION_FORMATS,\n} from 'src/reports/types';\nimport { reportSelector } from 'src/views/CRUD/hooks';\nimport { CreationMethod } from './HeaderReportDropdown';\nimport {\n  antDErrorAlertStyles,\n  StyledModal,\n  StyledTopSection,\n  StyledBottomSection,\n  StyledIconWrapper,\n  StyledScheduleTitle,\n  StyledCronPicker,\n  StyledCronError,\n  noBottomMargin,\n  StyledFooterButton,\n  TimezoneHeaderStyle,\n  SectionHeaderStyle,\n  StyledMessageContentTitle,\n  StyledRadio,\n  StyledRadioGroup,\n} from './styles';\n\ninterface ReportProps {\n  onHide: () => {};\n  addDangerToast: (msg: string) => void;\n  show: boolean;\n  userId: number;\n  userEmail: string;\n  chart?: ChartState;\n  chartName?: string;\n  dashboardId?: number;\n  dashboardName?: string;\n  creationMethod: ReportCreationMethod;\n  props: any;\n}\n\nconst TEXT_BASED_VISUALIZATION_TYPES = [\n  'pivot_table',\n  'pivot_table_v2',\n  'table',\n  'paired_ttest',\n];\n\nconst INITIAL_STATE = {\n  crontab: '0 12 * * 1',\n};\n\ntype ReportObjectState = Partial<ReportObject> & {\n  error?: string;\n  /**\n   * Is submitting changes to the backend.\n   */\n  isSubmitting?: boolean;\n};\n\nfunction ReportModal({\n  onHide,\n  show = false,\n  dashboardId,\n  chart,\n  userId,\n  userEmail,\n  creationMethod,\n  dashboardName,\n  chartName,\n}: ReportProps) {\n  const vizType = chart?.sliceFormData?.viz_type;\n  const isChart = !!chart;\n  const isTextBasedChart =\n    isChart && vizType && TEXT_BASED_VISUALIZATION_TYPES.includes(vizType);\n  const defaultNotificationFormat = isTextBasedChart\n    ? NOTIFICATION_FORMATS.TEXT\n    : NOTIFICATION_FORMATS.PNG;\n  const entityName = dashboardName || chartName;\n  const initialState: ReportObjectState = useMemo(\n    () => ({\n      ...INITIAL_STATE,\n      name: entityName\n        ? t('Weekly Report for %s', entityName)\n        : t('Weekly Report'),\n    }),\n    [entityName],\n  );\n\n  const reportReducer = useCallback(\n    (state: ReportObjectState | null, action: 'reset' | ReportObjectState) => {\n      if (action === 'reset') {\n        return initialState;\n      }\n      return {\n        ...state,\n        ...action,\n      };\n    },\n    [initialState],\n  );\n\n  const [currentReport, setCurrentReport] = useReducer(\n    reportReducer,\n    initialState,\n  );\n  const [cronError, setCronError] = useState<CronError>();\n\n  const dispatch = useDispatch();\n  // Report fetch logic\n  const report = useSelector<any, ReportObject>(state => {\n    const resourceType = dashboardId\n      ? CreationMethod.DASHBOARDS\n      : CreationMethod.CHARTS;\n    return reportSelector(state, resourceType, dashboardId || chart?.id);\n  });\n  const isEditMode = report && Object.keys(report).length;\n\n  useEffect(() => {\n    if (isEditMode) {\n      setCurrentReport(report);\n    } else {\n      setCurrentReport('reset');\n    }\n  }, [isEditMode, report]);\n\n  const onSave = async () => {\n    // Create new Report\n    const newReportValues: Partial<ReportObject> = {\n      type: 'Report',\n      active: true,\n      force_screenshot: false,\n      creation_method: creationMethod,\n      dashboard: dashboardId,\n      chart: chart?.id,\n      owners: [userId],\n      recipients: [\n        {\n          recipient_config_json: { target: userEmail },\n          type: 'Email',\n        },\n      ],\n      name: currentReport.name,\n      description: currentReport.description,\n      crontab: currentReport.crontab,\n      report_format: currentReport.report_format || defaultNotificationFormat,\n      timezone: currentReport.timezone,\n    };\n\n    setCurrentReport({ isSubmitting: true, error: undefined });\n    try {\n      if (isEditMode) {\n        await dispatch(\n          editReport(currentReport.id, newReportValues as ReportObject),\n        );\n      } else {\n        await dispatch(addReport(newReportValues as ReportObject));\n      }\n      onHide();\n    } catch (e) {\n      const { error } = await getClientErrorObject(e);\n      setCurrentReport({ error });\n    }\n    setCurrentReport({ isSubmitting: false });\n  };\n\n  const wrappedTitle = (\n    <StyledIconWrapper>\n      <Icons.Calendar />\n      <span className=\"text\">\n        {isEditMode ? t('Edit email report') : t('Schedule a new email report')}\n      </span>\n    </StyledIconWrapper>\n  );\n\n  const renderModalFooter = (\n    <>\n      <StyledFooterButton key=\"back\" onClick={onHide}>\n        {t('Cancel')}\n      </StyledFooterButton>\n      <StyledFooterButton\n        key=\"submit\"\n        buttonStyle=\"primary\"\n        onClick={onSave}\n        disabled={!currentReport.name}\n        loading={currentReport.isSubmitting}\n      >\n        {isEditMode ? t('Save') : t('Add')}\n      </StyledFooterButton>\n    </>\n  );\n\n  const renderMessageContentSection = (\n    <>\n      <StyledMessageContentTitle>\n        <h4>{t('Message content')}</h4>\n      </StyledMessageContentTitle>\n      <div className=\"inline-container\">\n        <StyledRadioGroup\n          onChange={(event: RadioChangeEvent) => {\n            setCurrentReport({ report_format: event.target.value });\n          }}\n          value={currentReport.report_format || defaultNotificationFormat}\n        >\n          {isTextBasedChart && (\n            <StyledRadio value={NOTIFICATION_FORMATS.TEXT}>\n              {t('Text embedded in email')}\n            </StyledRadio>\n          )}\n          <StyledRadio value={NOTIFICATION_FORMATS.PNG}>\n            {t('Image (PNG) embedded in email')}\n          </StyledRadio>\n          <StyledRadio value={NOTIFICATION_FORMATS.CSV}>\n            {t('Formatted CSV attached in email')}\n          </StyledRadio>\n        </StyledRadioGroup>\n      </div>\n    </>\n  );\n\n  return (\n    <StyledModal\n      show={show}\n      onHide={onHide}\n      title={wrappedTitle}\n      footer={renderModalFooter}\n      width=\"432\"\n      centered\n    >\n      <StyledTopSection>\n        <LabeledErrorBoundInput\n          id=\"name\"\n          name=\"name\"\n          value={currentReport.name || ''}\n          placeholder={initialState.name}\n          required\n          validationMethods={{\n            onChange: ({ target }: { target: HTMLInputElement }) =>\n              setCurrentReport({ name: target.value }),\n          }}\n          label={t('Report Name')}\n          data-test=\"report-name-test\"\n        />\n        <LabeledErrorBoundInput\n          id=\"description\"\n          name=\"description\"\n          value={currentReport?.description || ''}\n          validationMethods={{\n            onChange: ({ target }: { target: HTMLInputElement }) => {\n              setCurrentReport({ description: target.value });\n            },\n          }}\n          label={t('Description')}\n          placeholder={t(\n            'Include a description that will be sent with your report',\n          )}\n          css={noBottomMargin}\n          data-test=\"report-description-test\"\n        />\n      </StyledTopSection>\n\n      <StyledBottomSection>\n        <StyledScheduleTitle>\n          <h4 css={(theme: SupersetTheme) => SectionHeaderStyle(theme)}>\n            {t('Schedule')}\n          </h4>\n          <p>\n            {t('A screenshot of the dashboard will be sent to your email at')}\n          </p>\n        </StyledScheduleTitle>\n\n        <StyledCronPicker\n          clearButton={false}\n          value={currentReport.crontab || '0 12 * * 1'}\n          setValue={(newValue: string) => {\n            setCurrentReport({ crontab: newValue });\n          }}\n          onError={setCronError}\n        />\n        <StyledCronError>{cronError}</StyledCronError>\n        <div\n          className=\"control-label\"\n          css={(theme: SupersetTheme) => TimezoneHeaderStyle(theme)}\n        >\n          {t('Timezone')}\n        </div>\n        <TimezoneSelector\n          timezone={currentReport.timezone}\n          onTimezoneChange={value => {\n            setCurrentReport({ timezone: value });\n          }}\n        />\n        {isChart && renderMessageContentSection}\n      </StyledBottomSection>\n      {currentReport.error && (\n        <Alert\n          type=\"error\"\n          css={(theme: SupersetTheme) => antDErrorAlertStyles(theme)}\n          message={\n            isEditMode\n              ? t('Failed to update report')\n              : t('Failed to create report')\n          }\n          description={currentReport.error}\n        />\n      )}\n    </StyledModal>\n  );\n}\n\nexport default withToasts(ReportModal);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect } from 'react';\nimport { usePrevious } from 'src/hooks/usePrevious';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {\n  t,\n  SupersetTheme,\n  css,\n  styled,\n  useTheme,\n  FeatureFlag,\n  isFeatureEnabled,\n  getExtensionsRegistry,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Switch } from 'src/components/Switch';\nimport { AlertObject } from 'src/views/CRUD/alert/types';\nimport { Menu } from 'src/components/Menu';\nimport Checkbox from 'src/components/Checkbox';\nimport { noOp } from 'src/utils/common';\nimport { NoAnimationDropdown } from 'src/components/Dropdown';\nimport DeleteModal from 'src/components/DeleteModal';\nimport ReportModal from 'src/components/ReportModal';\nimport { ChartState } from 'src/explore/types';\nimport { UserWithPermissionsAndRoles } from 'src/types/bootstrapTypes';\nimport {\n  fetchUISpecificReport,\n  toggleActive,\n  deleteActiveReport,\n} from 'src/reports/actions/reports';\nimport { reportSelector } from 'src/views/CRUD/hooks';\nimport { MenuItemWithCheckboxContainer } from 'src/explore/components/useExploreAdditionalActionsMenu/index';\n\nconst extensionsRegistry = getExtensionsRegistry();\n\nconst deleteColor = (theme: SupersetTheme) => css`\n  color: ${theme.colors.error.base};\n`;\n\nconst onMenuHover = (theme: SupersetTheme) => css`\n  & .ant-menu-item {\n    padding: 5px 12px;\n    margin-top: 0px;\n    margin-bottom: 4px;\n    :hover {\n      color: ${theme.colors.grayscale.dark1};\n    }\n  }\n  :hover {\n    background-color: ${theme.colors.secondary.light5};\n  }\n`;\n\nconst onMenuItemHover = (theme: SupersetTheme) => css`\n  &:hover {\n    color: ${theme.colors.grayscale.dark1};\n    background-color: ${theme.colors.secondary.light5};\n  }\n`;\n\nconst StyledDropdownItemWithIcon = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  > *:first-child {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst DropdownItemExtension = extensionsRegistry.get(\n  'report-modal.dropdown.item.icon',\n);\n\nexport enum CreationMethod {\n  CHARTS = 'charts',\n  DASHBOARDS = 'dashboards',\n}\nexport interface HeaderReportProps {\n  dashboardId?: number;\n  chart?: ChartState;\n  useTextMenu?: boolean;\n  setShowReportSubMenu?: (show: boolean) => void;\n  setIsDropdownVisible?: (visible: boolean) => void;\n  isDropdownVisible?: boolean;\n  showReportSubMenu?: boolean;\n}\n\nexport default function HeaderReportDropDown({\n  dashboardId,\n  chart,\n  useTextMenu = false,\n  setShowReportSubMenu,\n  setIsDropdownVisible,\n  isDropdownVisible,\n}: HeaderReportProps) {\n  const dispatch = useDispatch();\n  const report = useSelector<any, AlertObject>(state => {\n    const resourceType = dashboardId\n      ? CreationMethod.DASHBOARDS\n      : CreationMethod.CHARTS;\n    return reportSelector(state, resourceType, dashboardId || chart?.id);\n  });\n\n  const isReportActive: boolean = report?.active || false;\n  const user: UserWithPermissionsAndRoles = useSelector<\n    any,\n    UserWithPermissionsAndRoles\n  >(state => state.user);\n  const canAddReports = () => {\n    if (!isFeatureEnabled(FeatureFlag.ALERT_REPORTS)) {\n      return false;\n    }\n\n    if (!user?.userId) {\n      // this is in the case that there is an anonymous user.\n      return false;\n    }\n    const roles = Object.keys(user.roles || []);\n    const permissions = roles.map(key =>\n      user.roles[key].filter(\n        perms => perms[0] === 'menu_access' && perms[1] === 'Manage',\n      ),\n    );\n    return permissions.some(permission => permission.length > 0);\n  };\n\n  const [currentReportDeleting, setCurrentReportDeleting] =\n    useState<AlertObject | null>(null);\n  const theme = useTheme();\n  const prevDashboard = usePrevious(dashboardId);\n  const [showModal, setShowModal] = useState<boolean>(false);\n  const toggleActiveKey = async (data: AlertObject, checked: boolean) => {\n    if (data?.id) {\n      dispatch(toggleActive(data, checked));\n    }\n  };\n\n  const handleReportDelete = async (report: AlertObject) => {\n    await dispatch(deleteActiveReport(report));\n    setCurrentReportDeleting(null);\n  };\n\n  const shouldFetch =\n    canAddReports() &&\n    !!((dashboardId && prevDashboard !== dashboardId) || chart?.id);\n\n  useEffect(() => {\n    if (shouldFetch) {\n      dispatch(\n        fetchUISpecificReport({\n          userId: user.userId,\n          filterField: dashboardId ? 'dashboard_id' : 'chart_id',\n          creationMethod: dashboardId ? 'dashboards' : 'charts',\n          resourceId: dashboardId || chart?.id,\n        }),\n      );\n    }\n  }, []);\n\n  const showReportSubMenu = report && setShowReportSubMenu && canAddReports();\n\n  useEffect(() => {\n    if (showReportSubMenu) {\n      setShowReportSubMenu(true);\n    } else if (!report && setShowReportSubMenu) {\n      setShowReportSubMenu(false);\n    }\n  }, [report]);\n\n  const handleShowMenu = () => {\n    if (setIsDropdownVisible) {\n      setIsDropdownVisible(false);\n      setShowModal(true);\n    }\n  };\n\n  const handleDeleteMenuClick = () => {\n    if (setIsDropdownVisible) {\n      setIsDropdownVisible(false);\n      setCurrentReportDeleting(report);\n    }\n  };\n\n  const textMenu = () =>\n    report ? (\n      isDropdownVisible && (\n        <Menu selectable={false} css={{ border: 'none' }}>\n          <Menu.Item\n            css={onMenuItemHover}\n            onClick={() => toggleActiveKey(report, !isReportActive)}\n          >\n            <MenuItemWithCheckboxContainer>\n              <Checkbox checked={isReportActive} onChange={noOp} />\n              {t('Email reports active')}\n            </MenuItemWithCheckboxContainer>\n          </Menu.Item>\n          <Menu.Item css={onMenuItemHover} onClick={handleShowMenu}>\n            {t('Edit email report')}\n          </Menu.Item>\n          <Menu.Item css={onMenuItemHover} onClick={handleDeleteMenuClick}>\n            {t('Delete email report')}\n          </Menu.Item>\n        </Menu>\n      )\n    ) : (\n      <Menu selectable={false} css={onMenuHover}>\n        <Menu.Item onClick={handleShowMenu}>\n          {DropdownItemExtension ? (\n            <StyledDropdownItemWithIcon>\n              <div>{t('Set up an email report')}</div>\n              <DropdownItemExtension />\n            </StyledDropdownItemWithIcon>\n          ) : (\n            t('Set up an email report')\n          )}\n        </Menu.Item>\n        <Menu.Divider />\n      </Menu>\n    );\n  const menu = () => (\n    <Menu selectable={false} css={{ width: '200px' }}>\n      <Menu.Item>\n        {t('Email reports active')}\n        <Switch\n          data-test=\"toggle-active\"\n          checked={isReportActive}\n          onClick={(checked: boolean) => toggleActiveKey(report, checked)}\n          size=\"small\"\n          css={{ marginLeft: theme.gridUnit * 2 }}\n        />\n      </Menu.Item>\n      <Menu.Item onClick={() => setShowModal(true)}>\n        {t('Edit email report')}\n      </Menu.Item>\n      <Menu.Item\n        onClick={() => setCurrentReportDeleting(report)}\n        css={deleteColor}\n      >\n        {t('Delete email report')}\n      </Menu.Item>\n    </Menu>\n  );\n\n  const iconMenu = () =>\n    report ? (\n      <>\n        <NoAnimationDropdown\n          overlay={menu()}\n          trigger={['click']}\n          getPopupContainer={(triggerNode: any) =>\n            triggerNode.closest('.action-button')\n          }\n        >\n          <span\n            role=\"button\"\n            className=\"action-button action-schedule-report\"\n            tabIndex={0}\n          >\n            <Icons.Calendar />\n          </span>\n        </NoAnimationDropdown>\n      </>\n    ) : (\n      <span\n        role=\"button\"\n        title={t('Schedule email report')}\n        tabIndex={0}\n        className=\"action-button action-schedule-report\"\n        onClick={() => setShowModal(true)}\n      >\n        <Icons.Calendar />\n      </span>\n    );\n\n  return (\n    <>\n      {canAddReports() && (\n        <>\n          <ReportModal\n            userId={user.userId}\n            show={showModal}\n            onHide={() => setShowModal(false)}\n            userEmail={user.email}\n            dashboardId={dashboardId}\n            chart={chart}\n            creationMethod={\n              dashboardId ? CreationMethod.DASHBOARDS : CreationMethod.CHARTS\n            }\n          />\n          {useTextMenu ? textMenu() : iconMenu()}\n          {currentReportDeleting && (\n            <DeleteModal\n              description={t(\n                'This action will permanently delete %s.',\n                currentReportDeleting?.name,\n              )}\n              onConfirm={() => {\n                if (currentReportDeleting) {\n                  handleReportDelete(currentReportDeleting);\n                }\n              }}\n              onHide={() => setCurrentReportDeleting(null)}\n              open\n              title={t('Delete Report?')}\n            />\n          )}\n        </>\n      )}\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { styled } from '@superset-ui/core';\nimport BaseSwitch, { SwitchProps } from 'antd/lib/switch';\n\nconst StyledSwitch = styled(BaseSwitch)`\n  .ant-switch-checked {\n    background-color: ${({ theme }) => theme.colors.primary.base};\n  }\n`;\n\nexport const Switch = (props: SwitchProps) => <StyledSwitch {...props} />;\nexport type { SwitchProps };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useEffect, useMemo } from 'react';\nimport moment from 'moment-timezone';\nimport { t } from '@superset-ui/core';\nimport { Select } from 'src/components';\n\nconst DEFAULT_TIMEZONE = {\n  name: 'GMT Standard Time',\n  value: 'Africa/Abidjan', // timezones are deduped by the first alphabetical value\n};\n\nconst MIN_SELECT_WIDTH = '400px';\n\nconst offsetsToName = {\n  '-300-240': ['Eastern Standard Time', 'Eastern Daylight Time'],\n  '-360-300': ['Central Standard Time', 'Central Daylight Time'],\n  '-420-360': ['Mountain Standard Time', 'Mountain Daylight Time'],\n  '-420-420': [\n    'Mountain Standard Time - Phoenix',\n    'Mountain Standard Time - Phoenix',\n  ],\n  '-480-420': ['Pacific Standard Time', 'Pacific Daylight Time'],\n  '-540-480': ['Alaska Standard Time', 'Alaska Daylight Time'],\n  '-600-600': ['Hawaii Standard Time', 'Hawaii Daylight Time'],\n  '60120': ['Central European Time', 'Central European Daylight Time'],\n  '00': [DEFAULT_TIMEZONE.name, DEFAULT_TIMEZONE.name],\n  '060': ['GMT Standard Time - London', 'British Summer Time'],\n};\n\nconst currentDate = moment();\nconst JANUARY = moment([2021, 1]);\nconst JULY = moment([2021, 7]);\n\nconst getOffsetKey = (name: string) =>\n  JANUARY.tz(name).utcOffset().toString() +\n  JULY.tz(name).utcOffset().toString();\n\nconst getTimezoneName = (name: string) => {\n  const offsets = getOffsetKey(name);\n  return (\n    (currentDate.tz(name).isDST()\n      ? offsetsToName[offsets]?.[1]\n      : offsetsToName[offsets]?.[0]) || name\n  );\n};\n\nconst ALL_ZONES = moment.tz\n  .countries()\n  .map(country => moment.tz.zonesForCountry(country, true))\n  .flat();\n\nconst TIMEZONES: moment.MomentZoneOffset[] = [];\nALL_ZONES.forEach(zone => {\n  if (\n    !TIMEZONES.find(\n      option => getOffsetKey(option.name) === getOffsetKey(zone.name),\n    )\n  ) {\n    TIMEZONES.push(zone); // dedupe zones by offsets\n  }\n});\n\nconst TIMEZONE_OPTIONS = TIMEZONES.map(zone => ({\n  label: `GMT ${moment\n    .tz(currentDate, zone.name)\n    .format('Z')} (${getTimezoneName(zone.name)})`,\n  value: zone.name,\n  offsets: getOffsetKey(zone.name),\n  timezoneName: zone.name,\n}));\n\nconst TIMEZONE_OPTIONS_SORT_COMPARATOR = (\n  a: typeof TIMEZONE_OPTIONS[number],\n  b: typeof TIMEZONE_OPTIONS[number],\n) =>\n  moment.tz(currentDate, a.timezoneName).utcOffset() -\n  moment.tz(currentDate, b.timezoneName).utcOffset();\n\n// pre-sort timezone options by time offset\nTIMEZONE_OPTIONS.sort(TIMEZONE_OPTIONS_SORT_COMPARATOR);\n\nconst matchTimezoneToOptions = (timezone: string) =>\n  TIMEZONE_OPTIONS.find(option => option.offsets === getOffsetKey(timezone))\n    ?.value || DEFAULT_TIMEZONE.value;\n\nexport type TimezoneSelectorProps = {\n  onTimezoneChange: (value: string) => void;\n  timezone?: string | null;\n  minWidth?: string;\n};\n\nexport default function TimezoneSelector({\n  onTimezoneChange,\n  timezone,\n  minWidth = MIN_SELECT_WIDTH, // smallest size for current values\n}: TimezoneSelectorProps) {\n  const validTimezone = useMemo(\n    () => matchTimezoneToOptions(timezone || moment.tz.guess()),\n    [timezone],\n  );\n\n  // force trigger a timezone update if provided `timezone` is not invalid\n  useEffect(() => {\n    if (timezone !== validTimezone) {\n      onTimezoneChange(validTimezone);\n    }\n  }, [validTimezone, onTimezoneChange, timezone]);\n\n  return (\n    <Select\n      ariaLabel={t('Timezone selector')}\n      css={{ minWidth }}\n      onChange={tz => onTimezoneChange(tz as string)}\n      value={validTimezone}\n      options={TIMEZONE_OPTIONS}\n      sortComparator={TIMEZONE_OPTIONS_SORT_COMPARATOR}\n    />\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataMaskStateWithId,\n  PartialFilters,\n  JsonObject,\n} from '@superset-ui/core';\nimport { ActiveFilters } from '../types';\nimport { ChartConfiguration } from '../reducers/types';\n\nexport const getRelevantDataMask = (\n  dataMask: DataMaskStateWithId,\n  prop: string,\n): JsonObject | DataMaskStateWithId =>\n  Object.values(dataMask)\n    .filter(item => item[prop])\n    .reduce(\n      (prev, next) => ({ ...prev, [next.id]: prop ? next[prop] : next }),\n      {},\n    );\n\nexport const getAllActiveFilters = ({\n  chartConfiguration,\n  nativeFilters,\n  dataMask,\n  allSliceIds,\n}: {\n  chartConfiguration: ChartConfiguration;\n  dataMask: DataMaskStateWithId;\n  nativeFilters: PartialFilters;\n  allSliceIds: number[];\n}): ActiveFilters => {\n  const activeFilters = {};\n\n  // Combine native filters with cross filters, because they have similar logic\n  Object.values(dataMask).forEach(({ id: filterId, extraFormData }) => {\n    const scope =\n      nativeFilters?.[filterId]?.chartsInScope ??\n      chartConfiguration?.[filterId]?.crossFilters?.chartsInScope ??\n      allSliceIds ??\n      [];\n    // Iterate over all roots to find all affected charts\n    activeFilters[filterId] = {\n      scope,\n      values: extraFormData,\n    };\n  });\n  return activeFilters;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { DataRecordFilters } from '@superset-ui/core';\n\nexport default function getEffectiveExtraFilters(filters: DataRecordFilters) {\n  return Object.entries(filters)\n    .map(([column, values]) => ({\n      col: column,\n      op: Array.isArray(values) ? 'IN' : '==',\n      val: values,\n    }))\n    .filter(filter => filter.val !== null);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataMaskStateWithId,\n  DataRecordFilters,\n  JsonObject,\n  PartialFilters,\n} from '@superset-ui/core';\nimport { ChartQueryPayload } from 'src/dashboard/types';\nimport { getExtraFormData } from 'src/dashboard/components/nativeFilters/utils';\nimport { areObjectsEqual } from 'src/reduxUtils';\nimport getEffectiveExtraFilters from './getEffectiveExtraFilters';\nimport { ChartConfiguration } from '../../reducers/types';\nimport { getAllActiveFilters } from '../activeAllDashboardFilters';\n\n// We cache formData objects so that our connected container components don't always trigger\n// render cascades. we cannot leverage the reselect library because our cache size is >1\nconst cachedFiltersByChart = {};\nconst cachedFormdataByChart = {};\n\nexport interface GetFormDataWithExtraFiltersArguments {\n  chartConfiguration: ChartConfiguration;\n  chart: ChartQueryPayload;\n  filters: DataRecordFilters;\n  colorScheme?: string;\n  colorNamespace?: string;\n  sliceId: number;\n  dataMask: DataMaskStateWithId;\n  nativeFilters: PartialFilters;\n  extraControls: Record<string, string | boolean | null>;\n  labelColors?: Record<string, string>;\n  sharedLabelColors?: Record<string, string>;\n  allSliceIds: number[];\n}\n\n// this function merge chart's formData with dashboard filters value,\n// and generate a new formData which will be used in the new query.\n// filters param only contains those applicable to this chart.\nexport default function getFormDataWithExtraFilters({\n  chart,\n  filters,\n  nativeFilters,\n  chartConfiguration,\n  colorScheme,\n  colorNamespace,\n  sliceId,\n  dataMask,\n  extraControls,\n  labelColors,\n  sharedLabelColors,\n  allSliceIds,\n}: GetFormDataWithExtraFiltersArguments) {\n  // if dashboard metadata + filters have not changed, use cache if possible\n  const cachedFormData = cachedFormdataByChart[sliceId];\n  if (\n    cachedFiltersByChart[sliceId] === filters &&\n    areObjectsEqual(cachedFormData?.color_scheme, colorScheme, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.color_namespace, colorNamespace, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.label_colors, labelColors, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.shared_label_colors, sharedLabelColors, {\n      ignoreUndefined: true,\n    }) &&\n    !!cachedFormData &&\n    areObjectsEqual(cachedFormData?.dataMask, dataMask, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.extraControls, extraControls, {\n      ignoreUndefined: true,\n    })\n  ) {\n    return cachedFormData;\n  }\n\n  let extraData: { extra_form_data?: JsonObject } = {};\n  const activeFilters = getAllActiveFilters({\n    chartConfiguration,\n    dataMask,\n    nativeFilters,\n    allSliceIds,\n  });\n  const filterIdsAppliedOnChart = Object.entries(activeFilters)\n    .filter(([, { scope }]) => scope.includes(chart.id))\n    .map(([filterId]) => filterId);\n  if (filterIdsAppliedOnChart.length) {\n    extraData = {\n      extra_form_data: getExtraFormData(dataMask, filterIdsAppliedOnChart),\n    };\n  }\n\n  const formData = {\n    ...chart.form_data,\n    label_colors: labelColors,\n    shared_label_colors: sharedLabelColors,\n    ...(colorScheme && { color_scheme: colorScheme }),\n    extra_filters: getEffectiveExtraFilters(filters),\n    ...extraData,\n    ...extraControls,\n  };\n\n  cachedFiltersByChart[sliceId] = filters;\n  cachedFormdataByChart[sliceId] = { ...formData, dataMask, extraControls };\n\n  return formData;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  Datasource,\n  GenericDataType,\n  JsonObject,\n  QueryFormData,\n} from '@superset-ui/core';\nimport { ExploreActions } from 'src/explore/actions/exploreActions';\nimport { ChartStatus } from 'src/explore/types';\n\nexport enum ResultTypes {\n  Results = 'results',\n  Samples = 'samples',\n}\n\nexport interface DataTablesPaneProps {\n  queryFormData: QueryFormData;\n  datasource: Datasource;\n  queryForce: boolean;\n  ownState?: JsonObject;\n  chartStatus: ChartStatus;\n  onCollapseChange: (isOpen: boolean) => void;\n  errorMessage?: JSX.Element;\n  actions: ExploreActions;\n}\n\nexport interface ResultsPaneProps {\n  isRequest: boolean;\n  queryFormData: QueryFormData;\n  queryForce: boolean;\n  ownState?: JsonObject;\n  errorMessage?: React.ReactElement;\n  actions?: ExploreActions;\n  dataSize?: number;\n  // reload OriginalFormattedTimeColumns from localStorage when isVisible is true\n  isVisible: boolean;\n}\n\nexport interface SamplesPaneProps {\n  isRequest: boolean;\n  datasource: Datasource;\n  queryForce: boolean;\n  actions?: ExploreActions;\n  dataSize?: number;\n  // reload OriginalFormattedTimeColumns from localStorage when isVisible is true\n  isVisible: boolean;\n}\n\nexport interface TableControlsProps {\n  data: Record<string, any>[];\n  // {datasource.id}__{datasource.type}, eg: 1__table\n  datasourceId: string;\n  onInputChange: (input: string) => void;\n  columnNames: string[];\n  columnTypes: GenericDataType[];\n  isLoading: boolean;\n}\n\nexport interface QueryResultInterface {\n  colnames: string[];\n  coltypes: GenericDataType[];\n  data: Record<string, any>[][];\n}\n\nexport interface SingleQueryResultPaneProp extends QueryResultInterface {\n  // {datasource.id}__{datasource.type}, eg: 1__table\n  datasourceId: string;\n  dataSize?: number;\n  // reload OriginalFormattedTimeColumns from localStorage when isVisible is true\n  isVisible: boolean;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo } from 'react';\nimport { zip } from 'lodash';\nimport { css, GenericDataType, styled } from '@superset-ui/core';\nimport {\n  CopyToClipboardButton,\n  FilterInput,\n  RowCount,\n} from 'src/explore/components/DataTableControl';\nimport { applyFormattingToTabularData } from 'src/utils/common';\nimport { getTimeColumns } from 'src/explore/components/DataTableControl/utils';\nimport { TableControlsProps } from '../types';\n\nexport const TableControlsWrapper = styled.div`\n  ${({ theme }) => `\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: ${theme.gridUnit * 2}px;\n\n    span {\n      flex-shrink: 0;\n    }\n  `}\n`;\n\nexport const TableControls = ({\n  data,\n  datasourceId,\n  onInputChange,\n  columnNames,\n  columnTypes,\n  isLoading,\n}: TableControlsProps) => {\n  const originalTimeColumns = getTimeColumns(datasourceId);\n  const formattedTimeColumns = zip<string, GenericDataType>(\n    columnNames,\n    columnTypes,\n  )\n    .filter(\n      ([name, type]) =>\n        type === GenericDataType.TEMPORAL &&\n        name &&\n        !originalTimeColumns.includes(name),\n    )\n    .map(([colname]) => colname);\n  const formattedData = useMemo(\n    () => applyFormattingToTabularData(data, formattedTimeColumns),\n    [data, formattedTimeColumns],\n  );\n  return (\n    <TableControlsWrapper>\n      <FilterInput onChangeHandler={onInputChange} />\n      <div\n        css={css`\n          display: flex;\n          align-items: center;\n        `}\n      >\n        <RowCount data={data} loading={isLoading} />\n        <CopyToClipboardButton data={formattedData} columns={columnNames} />\n      </div>\n    </TableControlsWrapper>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { t } from '@superset-ui/core';\nimport TableView, { EmptyWrapperType } from 'src/components/TableView';\nimport {\n  useFilteredTableData,\n  useTableColumns,\n} from 'src/explore/components/DataTableControl';\nimport { TableControls } from './DataTableControls';\nimport { SingleQueryResultPaneProp } from '../types';\n\nexport const SingleQueryResultPane = ({\n  data,\n  colnames,\n  coltypes,\n  datasourceId,\n  dataSize = 50,\n  isVisible,\n}: SingleQueryResultPaneProp) => {\n  const [filterText, setFilterText] = useState('');\n\n  // this is to preserve the order of the columns, even if there are integer values,\n  // while also only grabbing the first column's keys\n  const columns = useTableColumns(\n    colnames,\n    coltypes,\n    data,\n    datasourceId,\n    isVisible,\n  );\n  const filteredData = useFilteredTableData(filterText, data);\n\n  return (\n    <>\n      <TableControls\n        data={filteredData}\n        columnNames={colnames}\n        columnTypes={coltypes}\n        datasourceId={datasourceId}\n        onInputChange={input => setFilterText(input)}\n        isLoading={false}\n      />\n      <TableView\n        columns={columns}\n        data={filteredData}\n        pageSize={dataSize}\n        noDataText={t('No results')}\n        emptyWrapperType={EmptyWrapperType.Small}\n        className=\"table-condensed\"\n        isPaginationSticky\n        showRowCount={false}\n        small\n      />\n    </>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect } from 'react';\nimport {\n  ensureIsArray,\n  styled,\n  t,\n  getChartMetadataRegistry,\n} from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport { getChartDataRequest } from 'src/components/Chart/chartAction';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { ResultsPaneProps, QueryResultInterface } from '../types';\nimport { SingleQueryResultPane } from './SingleQueryResultPane';\nimport { TableControls } from './DataTableControls';\n\nconst Error = styled.pre`\n  margin-top: ${({ theme }) => `${theme.gridUnit * 4}px`};\n`;\n\nconst cache = new WeakMap();\n\nexport const useResultsPane = ({\n  isRequest,\n  queryFormData,\n  queryForce,\n  ownState,\n  errorMessage,\n  actions,\n  isVisible,\n  dataSize = 50,\n}: ResultsPaneProps): React.ReactElement[] => {\n  const metadata = getChartMetadataRegistry().get(\n    queryFormData?.viz_type || queryFormData?.vizType,\n  );\n\n  const [resultResp, setResultResp] = useState<QueryResultInterface[]>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const [responseError, setResponseError] = useState<string>('');\n  const queryCount = metadata?.queryObjectCount ?? 1;\n\n  useEffect(() => {\n    // it's an invalid formData when gets a errorMessage\n    if (errorMessage) return;\n    if (isRequest && cache.has(queryFormData)) {\n      setResultResp(ensureIsArray(cache.get(queryFormData)));\n      setResponseError('');\n      if (queryForce && actions) {\n        actions.setForceQuery(false);\n      }\n      setIsLoading(false);\n    }\n    if (isRequest && !cache.has(queryFormData)) {\n      setIsLoading(true);\n      getChartDataRequest({\n        formData: queryFormData,\n        force: queryForce,\n        resultFormat: 'json',\n        resultType: 'results',\n        ownState,\n      })\n        .then(({ json }) => {\n          setResultResp(ensureIsArray(json.result));\n          setResponseError('');\n          cache.set(queryFormData, json.result);\n          if (queryForce && actions) {\n            actions.setForceQuery(false);\n          }\n        })\n        .catch(response => {\n          getClientErrorObject(response).then(({ error, message }) => {\n            setResponseError(error || message || t('Sorry, an error occurred'));\n          });\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [queryFormData, isRequest]);\n\n  useEffect(() => {\n    if (errorMessage) {\n      setIsLoading(false);\n    }\n  }, [errorMessage]);\n\n  if (isLoading) {\n    return Array(queryCount).fill(<Loading />);\n  }\n\n  if (errorMessage) {\n    const title = t('Run a query to display results');\n    return Array(queryCount).fill(\n      <EmptyStateMedium image=\"document.svg\" title={title} />,\n    );\n  }\n\n  if (responseError) {\n    const err = (\n      <>\n        <TableControls\n          data={[]}\n          columnNames={[]}\n          columnTypes={[]}\n          datasourceId={queryFormData.datasource}\n          onInputChange={() => {}}\n          isLoading={false}\n        />\n        <Error>{responseError}</Error>\n      </>\n    );\n    return Array(queryCount).fill(err);\n  }\n\n  if (resultResp.length === 0) {\n    const title = t('No results were returned for this query');\n    return Array(queryCount).fill(\n      <EmptyStateMedium image=\"document.svg\" title={title} />,\n    );\n  }\n\n  return resultResp\n    .slice(0, queryCount)\n    .map((result, idx) => (\n      <SingleQueryResultPane\n        data={result.data}\n        colnames={result.colnames}\n        coltypes={result.coltypes}\n        dataSize={dataSize}\n        datasourceId={queryFormData.datasource}\n        key={idx}\n        isVisible={isVisible}\n      />\n    ));\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t, styled } from '@superset-ui/core';\nimport Tabs from 'src/components/Tabs';\nimport { ResultTypes, ResultsPaneProps } from '../types';\nimport { useResultsPane } from './useResultsPane';\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n\n  .ant-tabs {\n    height: 100%;\n  }\n\n  .ant-tabs-content {\n    height: 100%;\n  }\n\n  .ant-tabs-tabpane {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .table-condensed {\n    overflow: auto;\n  }\n`;\n\nexport const ResultsPaneOnDashboard = ({\n  isRequest,\n  queryFormData,\n  queryForce,\n  ownState,\n  errorMessage,\n  actions,\n  isVisible,\n  dataSize = 50,\n}: ResultsPaneProps) => {\n  const resultsPanes = useResultsPane({\n    errorMessage,\n    queryFormData,\n    queryForce,\n    ownState,\n    isRequest,\n    actions,\n    dataSize,\n    isVisible,\n  });\n\n  if (resultsPanes.length === 1) {\n    return <Wrapper>{resultsPanes[0]}</Wrapper>;\n  }\n\n  const panes = resultsPanes.map((pane, idx) => {\n    if (idx === 0) {\n      return (\n        <Tabs.TabPane tab={t('Results')} key={ResultTypes.Results}>\n          {pane}\n        </Tabs.TabPane>\n      );\n    }\n\n    return (\n      <Tabs.TabPane\n        tab={t('Results %s', idx + 1)}\n        key={`${ResultTypes.Results} ${idx + 1}`}\n      >\n        {pane}\n      </Tabs.TabPane>\n    );\n  });\n\n  return (\n    <Wrapper>\n      <Tabs fullWidth={false}>{panes}</Tabs>\n    </Wrapper>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { ensureIsArray, GenericDataType, styled, t } from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport TableView, { EmptyWrapperType } from 'src/components/TableView';\nimport {\n  useFilteredTableData,\n  useTableColumns,\n} from 'src/explore/components/DataTableControl';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport { TableControls } from './DataTableControls';\nimport { SamplesPaneProps } from '../types';\n\nconst Error = styled.pre`\n  margin-top: ${({ theme }) => `${theme.gridUnit * 4}px`};\n`;\n\nconst cache = new WeakSet();\n\nexport const SamplesPane = ({\n  isRequest,\n  datasource,\n  queryForce,\n  actions,\n  dataSize = 50,\n  isVisible,\n}: SamplesPaneProps) => {\n  const [filterText, setFilterText] = useState('');\n  const [data, setData] = useState<Record<string, any>[][]>([]);\n  const [colnames, setColnames] = useState<string[]>([]);\n  const [coltypes, setColtypes] = useState<GenericDataType[]>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [responseError, setResponseError] = useState<string>('');\n  const datasourceId = useMemo(\n    () => `${datasource.id}__${datasource.type}`,\n    [datasource],\n  );\n\n  useEffect(() => {\n    if (isRequest && queryForce) {\n      cache.delete(datasource);\n    }\n\n    if (isRequest && !cache.has(datasource)) {\n      setIsLoading(true);\n      getDatasourceSamples(datasource.type, datasource.id, queryForce, {})\n        .then(response => {\n          setData(ensureIsArray(response.data));\n          setColnames(ensureIsArray(response.colnames));\n          setColtypes(ensureIsArray(response.coltypes));\n          setResponseError('');\n          cache.add(datasource);\n          if (queryForce && actions) {\n            actions.setForceQuery(false);\n          }\n        })\n        .catch(error => {\n          setData([]);\n          setColnames([]);\n          setColtypes([]);\n          setResponseError(`${error.name}: ${error.message}`);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [datasource, isRequest, queryForce]);\n\n  // this is to preserve the order of the columns, even if there are integer values,\n  // while also only grabbing the first column's keys\n  const columns = useTableColumns(\n    colnames,\n    coltypes,\n    data,\n    datasourceId,\n    isVisible,\n  );\n  const filteredData = useFilteredTableData(filterText, data);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n\n  if (responseError) {\n    return (\n      <>\n        <TableControls\n          data={filteredData}\n          columnNames={colnames}\n          columnTypes={coltypes}\n          datasourceId={datasourceId}\n          onInputChange={input => setFilterText(input)}\n          isLoading={isLoading}\n        />\n        <Error>{responseError}</Error>\n      </>\n    );\n  }\n\n  if (data.length === 0) {\n    const title = t('No samples were returned for this dataset');\n    return <EmptyStateMedium image=\"document.svg\" title={title} />;\n  }\n\n  return (\n    <>\n      <TableControls\n        data={filteredData}\n        columnNames={colnames}\n        columnTypes={coltypes}\n        datasourceId={datasourceId}\n        onInputChange={input => setFilterText(input)}\n        isLoading={isLoading}\n      />\n      <TableView\n        columns={columns}\n        data={filteredData}\n        pageSize={dataSize}\n        noDataText={t('No results')}\n        emptyWrapperType={EmptyWrapperType.Small}\n        className=\"table-condensed\"\n        isPaginationSticky\n        showRowCount={false}\n        small\n      />\n    </>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n  MouseEvent,\n} from 'react';\nimport { styled, t, useTheme } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport Tabs from 'src/components/Tabs';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport {\n  getItem,\n  setItem,\n  LocalStorageKeys,\n} from 'src/utils/localStorageHelpers';\nimport {\n  SamplesPane,\n  TableControlsWrapper,\n  useResultsPane,\n} from './components';\nimport { DataTablesPaneProps, ResultTypes } from './types';\n\nconst SouthPane = styled.div`\n  ${({ theme }) => `\n    position: relative;\n    background-color: ${theme.colors.grayscale.light5};\n    z-index: 5;\n    overflow: hidden;\n\n    .ant-tabs {\n      height: 100%;\n    }\n\n    .ant-tabs-content-holder {\n      height: 100%;\n    }\n\n    .ant-tabs-content {\n      height: 100%;\n    }\n\n    .ant-tabs-tabpane {\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n\n      .table-condensed {\n        height: 100%;\n        overflow: auto;\n        margin-bottom: ${theme.gridUnit * 4}px;\n\n        .table {\n          margin-bottom: ${theme.gridUnit * 2}px;\n        }\n      }\n\n      .pagination-container > ul[role='navigation'] {\n        margin-top: 0;\n      }\n    }\n  `}\n`;\n\nexport const DataTablesPane = ({\n  queryFormData,\n  datasource,\n  queryForce,\n  onCollapseChange,\n  chartStatus,\n  ownState,\n  errorMessage,\n  actions,\n}: DataTablesPaneProps) => {\n  const theme = useTheme();\n  const [activeTabKey, setActiveTabKey] = useState<string>(ResultTypes.Results);\n  const [isRequest, setIsRequest] = useState<Record<ResultTypes, boolean>>({\n    results: false,\n    samples: false,\n  });\n  const [panelOpen, setPanelOpen] = useState(\n    isFeatureEnabled(FeatureFlag.DATAPANEL_CLOSED_BY_DEFAULT)\n      ? false\n      : getItem(LocalStorageKeys.is_datapanel_open, false),\n  );\n\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.DATAPANEL_CLOSED_BY_DEFAULT))\n      setItem(LocalStorageKeys.is_datapanel_open, panelOpen);\n  }, [panelOpen]);\n\n  useEffect(() => {\n    if (!panelOpen) {\n      setIsRequest({\n        results: false,\n        samples: false,\n      });\n    }\n\n    if (\n      panelOpen &&\n      activeTabKey.startsWith(ResultTypes.Results) &&\n      chartStatus === 'rendered'\n    ) {\n      setIsRequest({\n        results: true,\n        samples: false,\n      });\n    }\n\n    if (panelOpen && activeTabKey === ResultTypes.Samples) {\n      setIsRequest({\n        results: false,\n        samples: true,\n      });\n    }\n  }, [panelOpen, activeTabKey, chartStatus]);\n\n  const handleCollapseChange = useCallback(\n    (isOpen: boolean) => {\n      onCollapseChange(isOpen);\n      setPanelOpen(isOpen);\n    },\n    [onCollapseChange],\n  );\n\n  const handleTabClick = useCallback(\n    (tabKey: string, e: MouseEvent) => {\n      if (!panelOpen) {\n        handleCollapseChange(true);\n      } else if (tabKey === activeTabKey) {\n        e.preventDefault();\n        handleCollapseChange(false);\n      }\n      setActiveTabKey(tabKey);\n    },\n    [activeTabKey, handleCollapseChange, panelOpen],\n  );\n\n  const CollapseButton = useMemo(() => {\n    const caretIcon = panelOpen ? (\n      <Icons.CaretUp\n        iconColor={theme.colors.grayscale.base}\n        aria-label={t('Collapse data panel')}\n      />\n    ) : (\n      <Icons.CaretDown\n        iconColor={theme.colors.grayscale.base}\n        aria-label={t('Expand data panel')}\n      />\n    );\n    return (\n      <TableControlsWrapper>\n        {panelOpen ? (\n          <span\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => handleCollapseChange(false)}\n          >\n            {caretIcon}\n          </span>\n        ) : (\n          <span\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => handleCollapseChange(true)}\n          >\n            {caretIcon}\n          </span>\n        )}\n      </TableControlsWrapper>\n    );\n  }, [handleCollapseChange, panelOpen, theme.colors.grayscale.base]);\n\n  const queryResultsPanes = useResultsPane({\n    errorMessage,\n    queryFormData,\n    queryForce,\n    ownState,\n    isRequest: isRequest.results,\n    actions,\n    isVisible: ResultTypes.Results === activeTabKey,\n  }).map((pane, idx) => {\n    if (idx === 0) {\n      return (\n        <Tabs.TabPane tab={t('Results')} key={ResultTypes.Results}>\n          {pane}\n        </Tabs.TabPane>\n      );\n    }\n    if (idx > 0) {\n      return (\n        <Tabs.TabPane\n          tab={t('Results %s', idx + 1)}\n          key={`${ResultTypes.Results} ${idx + 1}`}\n        >\n          {pane}\n        </Tabs.TabPane>\n      );\n    }\n    return null;\n  });\n\n  return (\n    <SouthPane data-test=\"some-purposeful-instance\">\n      <Tabs\n        fullWidth={false}\n        tabBarExtraContent={CollapseButton}\n        activeKey={panelOpen ? activeTabKey : ''}\n        onTabClick={handleTabClick}\n      >\n        {queryResultsPanes}\n        <Tabs.TabPane tab={t('Samples')} key={ResultTypes.Samples}>\n          <SamplesPane\n            datasource={datasource}\n            queryForce={queryForce}\n            isRequest={isRequest.samples}\n            actions={actions}\n            isVisible={ResultTypes.Samples === activeTabKey}\n          />\n        </Tabs.TabPane>\n      </Tabs>\n    </SouthPane>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useState } from 'react';\nimport { styled, ensureIsArray, t } from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { getChartDataRequest } from 'src/components/Chart/chartAction';\nimport ViewQuery from 'src/explore/components/controls/ViewQuery';\n\ninterface Props {\n  latestQueryFormData: object;\n}\n\ntype Result = {\n  query: string;\n  language: string;\n};\n\nconst ViewQueryModalContainer = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst ViewQueryModal: React.FC<Props> = props => {\n  const [result, setResult] = useState<Result[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const loadChartData = (resultType: string) => {\n    setIsLoading(true);\n    getChartDataRequest({\n      formData: props.latestQueryFormData,\n      resultFormat: 'json',\n      resultType,\n    })\n      .then(({ json }) => {\n        setResult(ensureIsArray(json.result));\n        setIsLoading(false);\n        setError(null);\n      })\n      .catch(response => {\n        getClientErrorObject(response).then(({ error, message }) => {\n          setError(\n            error ||\n              message ||\n              response.statusText ||\n              t('Sorry, An error occurred'),\n          );\n          setIsLoading(false);\n        });\n      });\n  };\n  useEffect(() => {\n    loadChartData('query');\n  }, [JSON.stringify(props.latestQueryFormData)]);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n  if (error) {\n    return <pre>{error}</pre>;\n  }\n\n  return (\n    <ViewQueryModalContainer>\n      {result.map(item =>\n        item.query ? (\n          <ViewQuery sql={item.query} language={item.language || undefined} />\n        ) : null,\n      )}\n    </ViewQueryModalContainer>\n  );\n};\n\nexport default ViewQueryModal;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { useEffect } from 'react';\nimport { usePrevious } from '../usePrevious';\n\n/**\n * Calls the callback when the value changes.\n *\n * Passes the previous and current values to the callback\n */\nexport function useChangeEffect<T>(\n  value: T,\n  callback: (previous: T | undefined, current: T) => void,\n) {\n  const previous = usePrevious(value);\n  useEffect(() => {\n    if (value !== previous) {\n      callback(previous, value);\n    }\n  }, [value, previous, callback]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useState } from 'react';\nimport shortid from 'shortid';\nimport { BroadcastChannel } from 'broadcast-channel';\n\ninterface TabIdChannelMessage {\n  type: 'REQUESTING_TAB_ID' | 'TAB_ID_DENIED';\n  tabId: string;\n}\n\n// TODO: We are using broadcast-channel to support Safari.\n// The native BroadcastChannel API will be supported in Safari version 15.4.\n// After that, we should remove this dependency and use the native API.\nconst channel = new BroadcastChannel<TabIdChannelMessage>('tab_id_channel');\n\nexport function useTabId() {\n  const [tabId, setTabId] = useState<string>();\n\n  function isStorageAvailable() {\n    try {\n      return window.localStorage && window.sessionStorage;\n    } catch (error) {\n      return false;\n    }\n  }\n  useEffect(() => {\n    if (!isStorageAvailable()) {\n      if (!tabId) {\n        setTabId(shortid.generate());\n      }\n      return;\n    }\n\n    const updateTabId = () => {\n      const lastTabId = window.localStorage.getItem('last_tab_id');\n      const newTabId = String(\n        lastTabId ? Number.parseInt(lastTabId, 10) + 1 : 1,\n      );\n      window.sessionStorage.setItem('tab_id', newTabId);\n      window.localStorage.setItem('last_tab_id', newTabId);\n      setTabId(newTabId);\n    };\n\n    const storedTabId = window.sessionStorage.getItem('tab_id');\n    if (storedTabId) {\n      channel.postMessage({\n        type: 'REQUESTING_TAB_ID',\n        tabId: storedTabId,\n      });\n      setTabId(storedTabId);\n    } else {\n      updateTabId();\n    }\n\n    channel.onmessage = messageEvent => {\n      if (messageEvent.tabId === tabId) {\n        if (messageEvent.type === 'REQUESTING_TAB_ID') {\n          const message: TabIdChannelMessage = {\n            type: 'TAB_ID_DENIED',\n            tabId: messageEvent.tabId,\n          };\n          channel.postMessage(message);\n        } else if (messageEvent.type === 'TAB_ID_DENIED') {\n          updateTabId();\n        }\n      }\n    };\n  }, [tabId]);\n\n  return tabId;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { SyntheticEvent } from 'react';\nimport domToImage from 'dom-to-image-more';\nimport kebabCase from 'lodash/kebabCase';\nimport { t, supersetTheme } from '@superset-ui/core';\nimport { addWarningToast } from 'src/components/MessageToasts/actions';\n\n/**\n * generate a consistent file stem from a description and date\n *\n * @param description title or description of content of file\n * @param date date when file was generated\n */\nconst generateFileStem = (description: string, date = new Date()) =>\n  `${kebabCase(description)}-${date.toISOString().replace(/[: ]/g, '-')}`;\n\n/**\n * Create an event handler for turning an element into an image\n *\n * @param selector css selector of the parent element which should be turned into image\n * @param description name or a short description of what is being printed.\n *   Value will be normalized, and a date as well as a file extension will be added.\n * @param isExactSelector if false, searches for the closest ancestor that matches selector.\n * @returns event handler\n */\nexport default function downloadAsImage(\n  selector: string,\n  description: string,\n  isExactSelector = false,\n) {\n  return (event: SyntheticEvent) => {\n    const elementToPrint = isExactSelector\n      ? document.querySelector(selector)\n      : event.currentTarget.closest(selector);\n\n    if (!elementToPrint) {\n      return addWarningToast(\n        t('Image download failed, please refresh and try again.'),\n      );\n    }\n\n    // Mapbox controls are loaded from different origin, causing CORS error\n    // See https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL#exceptions\n    const filter = (node: Element) => {\n      if (typeof node.className === 'string') {\n        return (\n          node.className !== 'mapboxgl-control-container' &&\n          !node.className.includes('ant-dropdown')\n        );\n      }\n      return true;\n    };\n\n    return domToImage\n      .toJpeg(elementToPrint, {\n        quality: 0.95,\n        bgcolor: supersetTheme.colors.grayscale.light4,\n        filter,\n      })\n      .then(dataUrl => {\n        const link = document.createElement('a');\n        link.download = `${generateFileStem(description)}.jpg`;\n        link.href = dataUrl;\n        link.click();\n      })\n      .catch(e => {\n        console.error('Creating image failed', e);\n      });\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t } from '@superset-ui/core';\n\nconst CREATE_CHART_TEXT = t('Create chart');\nconst UPDATE_CHART_TEXT = t('Update chart');\n\nexport const getChartRequiredFieldsMissingMessage = (isCreating: boolean) =>\n  t(\n    'Select values in highlighted field(s) in the control panel. Then run the query by clicking on the %s button.',\n    `\"${isCreating ? CREATE_CHART_TEXT : UPDATE_CHART_TEXT}\"`,\n  );\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n// navigator.webdriver is true when browser is controlled by a bot\nexport const isCurrentUserBot = () => window?.navigator?.webdriver;\n"],"names":["ChartSource","ChartContextMenu","ref","id","formData","onSelection","onClose","theme","useTheme","dispatch","useDispatch","canExplore","useSelector","state","findPermission","user","roles","crossFiltersEnabled","dashboardInfo","filters","clientX","clientY","setState","useState","menuItems","showDrillToDetail","isFeatureEnabled","FeatureFlag","isCrossFilteringSupportedByChart","getChartMetadataRegistry","get","viz_type","behaviors","Behavior","itemsCount","isCrossFilterDisabled","crossFilter","crossFilteringTooltipTitle","t","push","Menu","key","disabled","onClick","updateDataMask","dataMask","isCurrentValueSelected","title","color","undefined","colors","grayscale","base","DrillDetail","chartId","drillToDetail","isContextMenu","contextMenuY","open","useCallback","adjustedY","getMenuAdjustedY","document","getElementById","click","useImperativeHandle","ReactDOM","overlay","length","trigger","onVisibleChange","value","css","visibility","position","top","left","width","height","body","forwardRef","propTypes","annotationData","PropTypes","actions","datasource","initialValues","latestQueryFormData","labelColors","sharedLabelColors","setControlValue","vizType","triggerRender","chartAlert","chartStatus","queriesResponse","triggerQuery","chartIsStale","addFilter","setDataMask","onFilterMenuOpen","onFilterMenuClose","ownState","postTransformProps","source","Dashboard","Explore","emitCrossFilters","BLANK","defaultProps","ChartRenderer","React","constructor","props","super","this","showContextMenu","inContextMenu","hasQueryResponseChange","contextMenuRef","handleAddFilter","bind","handleRenderSuccess","handleRenderFailure","handleSetControlValue","handleOnContextMenu","handleContextMenuSelected","handleContextMenuClosed","onContextMenuFallback","hooks","onAddFilter","onContextMenu","onError","shouldComponentUpdate","nextProps","nextState","indexOf","error","filterState","color_scheme","stack","cacheBusterProp","col","vals","merge","refresh","chartRenderingSucceeded","logEvent","LOG_ACTIONS_RENDER_CHART","slice_id","start_offset","renderStartTime","ts","Date","getTime","duration","Logger","info","logging","chartRenderingFailed","toString","componentStack","has_err","error_details","offsetX","offsetY","current","event","preventDefault","render","currentFormData","snakeCaseVizType","chartClassName","noResultsComponent","noResultTitle","noResultDescription","noResultImage","EmptyState","description","image","drillToDetailProps","find","behavior","SuperChart","disableErrorBoundary","className","chartType","queriesData","onRenderSuccess","onRenderFailure","noResults","ChartErrorMessage","result","owners","useChartOwnerNames","ownedError","extra","ErrorMessageWithStackTrace","dashboardId","timeout","force","isFiltersInitialized","chartStackTrace","errorMessage","onQuery","datasetsStatus","isInView","NONEXISTENT_DATASET","Styles","styled","p","typography","sizes","s","gridUnit","MonospaceDiv","families","monospace","Chart","handleRenderContainerFailure","componentDidMount","runQuery","componentDidUpdate","getSavedChart","getUrlParam","URL_PARAMS","postChartFormData","renderErrorMessage","queryResponse","errors","message","PLACEHOLDER_DATASOURCE","ResourceStatus","Loading","subtitle","copyText","link","stackTrace","isLoading","renderContainerStartTime","map","item","ensureIsArray","getChartRequiredFieldsMissingMessage","ErrorBoundary","showMessage","isCurrentUserBot","role","tabIndex","connect","bindActionCreators","CopyButtonEmbedCode","CopyButton","addDangerToast","setHeight","setWidth","url","setUrl","setErrorMessage","handleInputChange","e","name","currentTarget","updateUrl","getChartPermalink","then","catch","useEffect","html","useMemo","srcLink","text","CopyToClipboard","shouldShowText","copyNode","buttonSize","rows","readOnly","secondary","light5","htmlFor","Input","type","defaultValue","onChange","dashboards","menuProps","dashboardSearch","setDashboardSearch","hoveredItem","setHoveredItem","showSearch","filteredDashboards","filter","dashboard","dashboard_title","toLowerCase","noResultsFound","urlQueryString","allowClear","placeholder","prefix","Icons","iconSize","String","onMouseEnter","onMouseLeave","target","rel","to","iconColor","MENU_KEYS","VIZ_TYPES_PIVOTABLE","MenuItemWithCheckboxContainer","iconReset","Button","primary","dark2","light1","useExploreAdditionalActionsMenu","canDownloadCSV","slice","onOpenInEditor","onOpenPropertiesModal","addSuccessToast","useToasts","showReportSubMenu","setShowReportSubMenu","isDropdownVisible","setIsDropdownVisible","openSubmenus","setOpenSubmenus","chart","charts","getChartKey","explore","shareByEmail","async","subject","encodeURIComponent","window","location","href","exportCSV","exportChart","resultType","resultFormat","exportCSVPivoted","exportJson","exportExcel","copyLink","Error","copyTextToClipboard","handleMenuClick","domEvent","downloadAsImage","slice_name","selectable","openKeys","onOpenChange","icon","ModalTrigger","triggerNode","modalTitle","modalBody","maxWidth","destroyOnClose","responsive","useTextMenu","ViewQueryModal","draggable","resizable","MenuItemTooltip","placement","label","BOOL_TRUE_DISPLAY","BOOL_FALSE_DISPLAY","NULL_DISPLAY","format","TimeFormats","getTimeFormatter","headerTitle","groupTitle","groupOptions","popoverVisible","setPopoverVisible","Popover","visible","content","weights","bold","Radio","direction","option","arrowPointAtCenter","TableControls","setFilters","totalCount","loading","onReload","filterMap","Object","assign","isAdhocColumn","removeFilter","colName","updatedFilterMap","values","filterTags","entries","val","formattedVal","sort","a","b","localeCompare","closable","RowCountLabel","rowcount","TimeFormatting","Resizable","children","useResizeDetector","DrillDetailPane","initialFilters","pageIndex","setPageIndex","lastPageIndex","useRef","setIsLoading","responseError","setResponseError","resultsPages","setResultsPages","Map","timeFormatting","setTimeFormatting","SAMPLES_ROW_LIMIT","common","conf","datasourceId","datasourceType","split","resultsPage","nextResultsPage","mappedColumns","colNames","column","index","dataIndex","colTypes","GenericDataType","Original","Formatted","data","row","reduce","acc","curr","handleReload","has","keys","at","nextResultsPages","delete","set","jsonPayload","queryFormData","drillFilters","queryObject","buildQueryObject","extras","f","granularity","time_range","getDrillPayload","cachePageLimit","Math","ceil","getDatasourceSamples","response","total","total_count","colnames","coltypes","finally","useApiV1Resource","bootstrapping","size","status","tableContent","Table","columns","TableSize","defaultPageSize","recordCount","usePagination","pagination","virtualize","metadata","items","changed_on_humanized","created_on_humanized","table_name","changed_by","created_by","notAvailable","createdBy","first_name","last_name","trim","modifiedBy","formattedOwners","owner","MetadataType","createdOn","MetadataBar","tooltipPlacement","Alert","ModalFooter","exploreChart","closeModal","buttonStyle","DrillDetailModal","showModal","onHideModal","history","useHistory","dashboardPageId","useContext","DashboardPageIdContext","chartName","sliceEntities","slices","exploreUrl","Modal","show","onHide","footer","resizableConfig","minHeight","minWidth","defaultSize","maskClosable","DRILL_TO_DETAIL_TEXT","DisabledMenuItem","Filter","modalFilters","setShowModal","openModal","handlesDimensionContextMenu","noAggregations","metrics","extractQueryFields","drillToDetailMenuItem","drillToDetailByMenuItem","submenuYOffset","submenuY","MENU_ITEM_HEIGHT","popupOffset","i","vh","max","documentElement","clientHeight","innerHeight","menuHeight","LOCALE","everyText","emptyMonths","emptyMonthDays","emptyMonthDaysShort","emptyWeekDays","emptyWeekDaysShort","emptyHours","emptyMinutes","emptyMinutesForHourPeriod","yearOption","monthOption","weekOption","dayOption","hourOption","minuteOption","rebootOption","prefixPeriod","prefixMonths","prefixMonthDays","prefixWeekDays","prefixWeekDaysForMonthAndYearPeriod","prefixHours","prefixMinutes","prefixMinutesForHourPeriod","suffixMinutesForHourPeriod","errorInvalidCron","clearButtonText","weekDays","months","altWeekDays","altMonths","CronPicker","getPopupContainer","parentElement","locale","light4","MenuDots","normal","MenuDotsWrapper","IconOrientation","Dropdown","iconOrientation","VERTICAL","rest","HORIZONTAL","RenderIcon","NoAnimationDropdown","overlayStyle","zIndex","animationDuration","Header","Info","header","SPACE_BETWEEN_ITEMS","ORDER","table","sql","tags","lastModified","Bar","count","HORIZONTAL_PADDING","borderRadius","StyledItem","collapsed","last","ICON_WIDTH","TootipContent","Item","barWidth","contentType","tooltip","DASHBOARDS","DESCRIPTION","LAST_MODIFIED","OWNER","ROWS","SQL","TABLE","TAGS","join","config","isTruncated","setIsTruncated","Icon","scrollWidth","clientWidth","Tooltip","setCollapsed","sortedItems","onResize","breakpoint","Boolean","ReportType","NOTIFICATION_FORMATS","StyledModal","StyledTopSection","StyledBottomSection","light2","StyledIconWrapper","StyledScheduleTitle","StyledCronPicker","StyledCronError","noBottomMargin","StyledFooterButton","StyledMessageContentTitle","StyledRadio","StyledRadioGroup","TEXT_BASED_VISUALIZATION_TYPES","INITIAL_STATE","crontab","withToasts","userId","userEmail","creationMethod","dashboardName","sliceFormData","isChart","isTextBasedChart","defaultNotificationFormat","TEXT","PNG","entityName","initialState","reportReducer","action","currentReport","setCurrentReport","useReducer","cronError","setCronError","report","resourceType","CreationMethod","CHARTS","reportSelector","isEditMode","wrappedTitle","renderModalFooter","newReportValues","active","force_screenshot","creation_method","recipients","recipient_config_json","report_format","timezone","isSubmitting","editReport","addReport","getClientErrorObject","renderMessageContentSection","CSV","centered","LabeledErrorBoundInput","required","validationMethods","SectionHeaderStyle","clearButton","setValue","newValue","TimezoneHeaderStyle","TimezoneSelector","onTimezoneChange","m","l","antDErrorAlertStyles","extensionsRegistry","getExtensionsRegistry","deleteColor","onMenuHover","dark1","onMenuItemHover","StyledDropdownItemWithIcon","DropdownItemExtension","HeaderReportDropDown","isReportActive","canAddReports","perms","some","permission","currentReportDeleting","setCurrentReportDeleting","prevDashboard","usePrevious","toggleActiveKey","checked","toggleActive","shouldFetch","fetchUISpecificReport","filterField","resourceId","handleShowMenu","email","Checkbox","noOp","Switch","marginLeft","closest","DeleteModal","onConfirm","deleteActiveReport","handleReportDelete","StyledSwitch","BaseSwitch","DEFAULT_TIMEZONE","MIN_SELECT_WIDTH","offsetsToName","currentDate","moment","JANUARY","JULY","getOffsetKey","tz","utcOffset","getTimezoneName","offsets","isDST","ALL_ZONES","country","flat","TIMEZONES","forEach","zone","TIMEZONE_OPTIONS","timezoneName","TIMEZONE_OPTIONS_SORT_COMPARATOR","validTimezone","matchTimezoneToOptions","ariaLabel","options","sortComparator","getRelevantDataMask","prop","prev","next","getAllActiveFilters","chartConfiguration","nativeFilters","allSliceIds","activeFilters","filterId","extraFormData","scope","chartsInScope","crossFilters","getEffectiveExtraFilters","op","Array","isArray","cachedFiltersByChart","cachedFormdataByChart","getFormDataWithExtraFilters","colorScheme","colorNamespace","sliceId","extraControls","cachedFormData","areObjectsEqual","ignoreUndefined","color_namespace","label_colors","shared_label_colors","extraData","filterIdsAppliedOnChart","extra_form_data","getExtraFormData","form_data","extra_filters","ResultTypes","TableControlsWrapper","onInputChange","columnNames","columnTypes","originalTimeColumns","getTimeColumns","formattedTimeColumns","colname","formattedData","applyFormattingToTabularData","onChangeHandler","SingleQueryResultPane","dataSize","isVisible","filterText","setFilterText","useTableColumns","filteredData","useFilteredTableData","input","TableView","pageSize","noDataText","emptyWrapperType","EmptyWrapperType","isPaginationSticky","showRowCount","small","cache","WeakMap","useResultsPane","isRequest","queryForce","resultResp","setResultResp","queryCount","queryObjectCount","setForceQuery","getChartDataRequest","json","fill","err","idx","Wrapper","ResultsPaneOnDashboard","resultsPanes","panes","pane","Tabs","tab","Results","fullWidth","WeakSet","SamplesPane","setData","setColnames","setColtypes","add","SouthPane","DataTablesPane","onCollapseChange","activeTabKey","setActiveTabKey","setIsRequest","results","samples","panelOpen","setPanelOpen","getItem","LocalStorageKeys","setItem","startsWith","Samples","handleCollapseChange","isOpen","handleTabClick","tabKey","CollapseButton","caretIcon","queryResultsPanes","tabBarExtraContent","activeKey","onTabClick","ViewQueryModalContainer","setResult","setError","statusText","JSON","stringify","query","language","useChangeEffect","callback","previous","channel","BroadcastChannel","useTabId","tabId","setTabId","localStorage","sessionStorage","isStorageAvailable","shortid","updateTabId","lastTabId","newTabId","Number","parseInt","storedTabId","postMessage","onmessage","messageEvent","selector","isExactSelector","elementToPrint","querySelector","domToImage","quality","bgcolor","supersetTheme","node","dataUrl","createElement","download","date","kebabCase","toISOString","replace","generateFileStem","console","addWarningToast","CREATE_CHART_TEXT","UPDATE_CHART_TEXT","isCreating","navigator","webdriver"],"sourceRoot":""}