"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[1458],{81458:(t,i,e)=>{e.d(i,{Z:()=>I});var r=e(15671),n=e(43144),o=e(82963),a=e(61120),h=e(60136),s=e(97326),u=e(29439),l=e(7778);function c(t,i){var e=l.fF([],i,t);return l.bA(e,e,1/e[3]),e}var p=e(85975),v=e(31437),d=e(77160);function g(t,i){if(!t)throw new Error(i||"viewport-mercator-project: assertion failed.")}var M=Math.PI,f=M/4,b=M/180,j=180/M,x=4003e4;function m(t){return Math.pow(2,t)}function Z(t,i){var e=(0,u.Z)(t,2),r=e[0],n=e[1];g(Number.isFinite(r)&&Number.isFinite(i)),g(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");var o=n*b;return[(i*=512)*(r*b+M)/(2*M),i*(M-Math.log(Math.tan(f+.5*o)))/(2*M)]}function w(t,i){var e=(0,u.Z)(t,2),r=e[0],n=e[1],o=r/(i*=512)*(2*M)-M,a=2*(Math.atan(Math.exp(M-n/i*(2*M)))-f);return[o*j,a*j]}function P(t){var i=t.latitude,e=t.longitude,r=t.zoom,n=t.scale,o=t.highPrecision,a=void 0!==o&&o;n=void 0!==n?n:m(r),g(Number.isFinite(i)&&Number.isFinite(e)&&Number.isFinite(n));var h={},s=512*n,u=Math.cos(i*b),l=s/360,c=l/u,p=s/x/u;if(h.pixelsPerMeter=[p,-p,p],h.metersPerPixel=[1/p,-1/p,1/p],h.pixelsPerDegree=[l,-c,p],h.degreesPerPixel=[1/l,-1/c,1/p],a){var v=b*Math.tan(i*b)/u,d=l*v/2,M=s/x*v,f=M/c*p;h.pixelsPerDegree2=[0,-d,M],h.pixelsPerMeter2=[f,0,f]}return h}function F(t){var i=t.height,e=t.pitch,r=t.bearing,n=t.altitude,o=t.center,a=void 0===o?null:o,h=t.flipY,s=void 0!==h&&h,u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return p.Iu(u,u,[0,0,-n]),p.bA(u,u,[1,1,1/i]),p.lM(u,u,-e*b),p.jI(u,u,r*b),s&&p.bA(u,u,[1,-1,1]),a&&p.Iu(u,u,d.tk([],a)),u}function N(t){var i=t.width,e=t.height,r=t.pitch,n=function(t){var i=t.width,e=t.height,r=t.altitude,n=void 0===r?1.5:r,o=t.pitch,a=t.nearZMultiplier,h=void 0===a?1:a,s=t.farZMultiplier,u=void 0===s?1:s,l=(void 0===o?0:o)*b,c=Math.atan(.5/n),p=Math.sin(c)*n/Math.sin(Math.PI/2-l-c),v=Math.cos(Math.PI/2-l)*p+n;return{fov:2*Math.atan(e/2/n),aspect:i/e,focalDistance:n,near:h,far:v*u}}({width:i,height:e,altitude:t.altitude,pitch:r,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier}),o=n.fov,a=n.aspect,h=n.near,s=n.far;return p.G3([],o,a,h,s)}function k(t,i){var e=(0,u.Z)(t,3),r=e[0],n=e[1],o=e[2],a=void 0===o?0:o;return g(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(a)),c(i,[r,n,a,1])}function y(t,i){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(0,u.Z)(t,3),n=r[0],o=r[1],a=r[2];if(g(Number.isFinite(n)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(a)){var h=c(i,[n,o,a,1]);return h}var s=c(i,[n,o,0,1]),l=c(i,[n,o,1,1]),p=s[2],d=l[2],M=p===d?0:((e||0)-p)/(d-p);return v.t7([],s,l,M)}var L=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function z(t){var i=t.width,e=t.height,r=t.bounds,n=t.minExtent,o=void 0===n?0:n,a=t.maxZoom,h=void 0===a?24:a,s=t.padding,l=void 0===s?0:s,c=t.offset,p=void 0===c?[0,0]:c,v=(0,u.Z)(r,2),d=(0,u.Z)(v[0],2),M=d[0],f=d[1],b=(0,u.Z)(v[1],2),j=b[0],x=b[1];Number.isFinite(l)?l={top:l,bottom:l,left:l,right:l}:g(Number.isFinite(l.top)&&Number.isFinite(l.bottom)&&Number.isFinite(l.left)&&Number.isFinite(l.right));var m=new I({width:i,height:e,longitude:0,latitude:0,zoom:0}),Z=m.project([M,x]),w=m.project([j,f]),P=[Math.max(Math.abs(w[0]-Z[0]),o),Math.max(Math.abs(w[1]-Z[1]),o)],F=[i-l.left-l.right-2*Math.abs(p[0]),e-l.top-l.bottom-2*Math.abs(p[1])];g(F[0]>0&&F[1]>0);var N=F[0]/P[0],k=F[1]/P[1],y=(l.right-l.left)/2/N,L=(l.bottom-l.top)/2/k,z=[(w[0]+Z[0])/2+y,(w[1]+Z[1])/2+L],A=m.unproject(z),C=m.zoom+Math.log2(Math.abs(Math.min(N,k)));return{longitude:A[0],latitude:A[1],zoom:Math.min(C,h)}}var I=function(t){function i(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,h=e.height,u=e.latitude,l=void 0===u?0:u,c=e.longitude,p=void 0===c?0:c,v=e.zoom,d=void 0===v?0:v,g=e.pitch,M=void 0===g?0:g,f=e.bearing,b=void 0===f?0:f,j=e.altitude,x=void 0===j?1.5:j,w=e.nearZMultiplier,k=e.farZMultiplier;(0,r.Z)(this,i),n=n||1,h=h||1;var y=m(d);x=Math.max(.75,x);var L=Z([p,l],y);L[2]=0;var z=N({width:n,height:h,pitch:M,bearing:b,altitude:x,nearZMultiplier:w||1/h,farZMultiplier:k||1.01}),I=F({height:h,center:L,pitch:M,bearing:b,altitude:x,flipY:!0});return(t=(0,o.Z)(this,(0,a.Z)(i).call(this,{width:n,height:h,viewMatrix:I,projectionMatrix:z}))).latitude=l,t.longitude=p,t.zoom=d,t.pitch=M,t.bearing=b,t.altitude=x,t.scale=y,t.center=L,t.pixelsPerMeter=P((0,s.Z)((0,s.Z)(t))).pixelsPerMeter[2],Object.freeze((0,s.Z)((0,s.Z)(t))),t}return(0,h.Z)(i,t),(0,n.Z)(i,[{key:"projectFlat",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Z(t,i)}},{key:"unprojectFlat",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return w(t,i)}},{key:"getMapCenterByLngLatPosition",value:function(t){var i=t.lngLat,e=y(t.pos,this.pixelUnprojectionMatrix),r=Z(i,this.scale),n=v.IH([],r,v.tk([],e));return w(v.IH([],this.center,n),this.scale)}},{key:"getLocationAtPoint",value:function(t){var i=t.lngLat,e=t.pos;return this.getMapCenterByLngLatPosition({lngLat:i,pos:e})}},{key:"fitBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,n=this.height,o=z(Object.assign({width:r,height:n,bounds:t},e)),a=o.longitude,h=o.latitude,s=o.zoom;return new i({width:r,height:n,longitude:a,latitude:h,zoom:s})}}]),i}(function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.width,n=i.height,o=i.viewMatrix,a=void 0===o?L:o,h=i.projectionMatrix,s=void 0===h?L:h;(0,r.Z)(this,t),this.width=e||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=s;var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];p.Jp(u,u,this.projectionMatrix),p.Jp(u,u,this.viewMatrix),this.viewProjectionMatrix=u;var l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];p.bA(l,l,[this.width/2,-this.height/2,1]),p.Iu(l,l,[1,-1,0]),p.Jp(l,l,this.viewProjectionMatrix);var c=p.U_([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l);if(!c)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=l,this.pixelUnprojectionMatrix=c,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,n.Z)(t,[{key:"equals",value:function(i){return i instanceof t&&i.width===this.width&&i.height===this.height&&p.fS(i.projectionMatrix,this.projectionMatrix)&&p.fS(i.viewMatrix,this.viewMatrix)}},{key:"project",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=i.topLeft,r=void 0===e||e,n=this.projectPosition(t),o=k(n,this.pixelProjectionMatrix),a=(0,u.Z)(o,2),h=a[0],s=a[1],l=r?s:this.height-s;return 2===t.length?[h,l]:[h,l,o[2]]}},{key:"unproject",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=i.topLeft,r=void 0===e||e,n=i.targetZ,o=(0,u.Z)(t,3),a=o[0],h=o[1],s=o[2],l=r?h:this.height-h,c=n&&n*this.pixelsPerMeter,p=y([a,l,s],this.pixelUnprojectionMatrix,c),v=this.unprojectPosition(p),d=(0,u.Z)(v,3),g=d[0],M=d[1],f=d[2];return Number.isFinite(s)?[g,M,f]:Number.isFinite(n)?[g,M,n]:[g,M]}},{key:"projectPosition",value:function(t){var i=this.projectFlat(t),e=(0,u.Z)(i,2);return[e[0],e[1],(t[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(t){var i=this.unprojectFlat(t),e=(0,u.Z)(i,2);return[e[0],e[1],(t[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(t){return arguments.length>1&&void 0!==arguments[1]||this.scale,t}},{key:"unprojectFlat",value:function(t){return arguments.length>1&&void 0!==arguments[1]||this.scale,t}}]),t}())}}]);
//# sourceMappingURL=bda04609cd55869cb5bc.chunk.js.map
