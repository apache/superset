"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[704],{33738:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var a=r(78580),l=r.n(a),n=r(67294),s=r(16355),u=r(5364),c=r(63475),i=r(6915),o=r(11965);function h(e){let{height:t,width:r,echartOptions:a,setDataMask:h,labelMap:d,labelMapB:f,groupby:p,groupbyB:g,selectedValues:m,formData:v,emitCrossFilters:b,seriesBreakdown:w,onContextMenu:k,xValueFormatter:y,xAxis:x,refs:I}=e;const C=(0,n.useCallback)((e=>e<w),[w]),E=(0,n.useCallback)(((e,t)=>{const r=Object.values(m||{});let a;a=l()(r).call(r,e)?r.filter((t=>t!==e)):[e];const n=C(t)?p:g,s=C(t)?d:f,u=a.map((e=>null==s?void 0:s[e])).filter((e=>!!e));return{dataMask:{extraFormData:{filters:0===a.length?[]:[...n.map(((e,t)=>{const r=u.map((e=>e[t]));return null==r?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:r}}))]},filterState:{value:u.length?u:null,selectedValues:a.length?a:null}},isCurrentValueSelected:l()(r).call(r,e)}}),[p,g,C,d,f,m]),O=(0,n.useCallback)(((e,t)=>{b&&h(E(e,t).dataMask)}),[b,h,E]),V={click:e=>{const{seriesName:t,seriesIndex:r}=e;O(t,r)},mouseout:()=>{i.aI.name=""},mouseover:e=>{i.aI.name=e.seriesName},contextmenu:e=>{if(k){e.event.stop();const{data:t,seriesName:r,seriesIndex:a}=e,l=e.event.event,n=[];if(t){const r=[...e.name?[e.name]:[],...(C(a)?d:f)[e.seriesName]];x.type===s.we.time&&n.push({col:x.label===u.W3?v.granularitySqla:x.label,grain:v.timeGrainSqla,op:"==",val:t[0],formattedVal:y(t[0])}),[...x.type===s.we.category?[x.label]:[],...C(a)?v.groupby:v.groupbyB].forEach(((e,t)=>n.push({col:e,op:"==",val:r[t],formattedVal:String(r[t])})))}k(l.clientX,l.clientY,{drillToDetail:n,crossFilter:E(r,a)})}}};return(0,o.tZ)(c.Z,{refs:I,height:t,width:r,echartOptions:a,eventHandlers:V,selectedValues:m})}},63475:(e,t,r)=>{r.d(t,{Z:()=>h});var a=r(78580),l=r.n(a),n=r(67294),s=r(51995),u=r(31431),c=r(11965);const i=s.iK.div`
  height: ${e=>{let{height:t}=e;return t}};
  width: ${e=>{let{width:t}=e;return t}};
`;function o(e,t){let{width:r,height:a,echartOptions:s,eventHandlers:o,zrEventHandlers:h,selectedValues:d={},refs:f}=e;const p=(0,n.useRef)(null);f&&(f.divRef=p);const g=(0,n.useRef)(),m=(0,n.useMemo)((()=>Object.keys(d)||[]),[d]),v=(0,n.useRef)([]);(0,n.useImperativeHandle)(t,(()=>({getEchartInstance:()=>g.current}))),(0,n.useEffect)((()=>{p.current&&(g.current||(g.current=(0,u.S1)(p.current)),Object.entries(o||{}).forEach((e=>{var t,r;let[a,l]=e;null==(t=g.current)||t.off(a),null==(r=g.current)||r.on(a,l)})),Object.entries(h||{}).forEach((e=>{var t,r;let[a,l]=e;null==(t=g.current)||t.getZr().off(a),null==(r=g.current)||r.getZr().on(a,l)})),g.current.setOption(s,!0))}),[s,o,h]),(0,n.useEffect)((()=>{g.current&&(g.current.dispatchAction({type:"downplay",dataIndex:v.current.filter((e=>!l()(m).call(m,e)))}),m.length&&g.current.dispatchAction({type:"highlight",dataIndex:m}),v.current=m)}),[m]);const b=(0,n.useCallback)((e=>{let{width:t,height:r}=e;g.current&&g.current.resize({width:t,height:r})}),[]);return(0,n.useEffect)((()=>(b({width:r,height:a}),()=>{var e;return null==(e=g.current)?void 0:e.dispose()})),[]),(0,n.useLayoutEffect)((()=>{b({width:r,height:a})}),[r,a,b]),(0,c.tZ)(i,{ref:p,height:a,width:r})}const h=(0,n.forwardRef)(o)}}]);
//# sourceMappingURL=21d2fb529e44fcf67add.chunk.js.map
