"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[9454],{19485:(e,t,r)=>{r.r(t),r.d(t,{FETCH_DASHBOARDS_SUCCEEDED:()=>l,fetchDashboardsSucceeded:()=>u,FETCH_DASHBOARDS_FAILED:()=>h,fetchDashboardsFailed:()=>_,SET_SAVE_CHART_MODAL_VISIBILITY:()=>p,setSaveChartModalVisibility:()=>E,fetchDashboards:()=>S,SAVE_SLICE_FAILED:()=>f,saveSliceFailed:()=>A,SAVE_SLICE_SUCCESS:()=>T,saveSliceSuccess:()=>y,REMOVE_SAVE_MODAL_ALERT:()=>v,removeSaveModalAlert:()=>D,getSlicePayload:()=>m,updateSlice:()=>R,createSlice:()=>g,createDashboard:()=>b,getDashboard:()=>F,getSliceDashboards:()=>O});var n=r(15926),a=r.n(n),s=r(31069),o=r(55867),i=r(72570),c=r(12515);const d=/^adhoc_filters/,l="FETCH_DASHBOARDS_SUCCEEDED";function u(e){return{type:l,choices:e}}const h="FETCH_DASHBOARDS_FAILED";function _(e){return{type:h,userId:e}}const p="SET_SAVE_CHART_MODAL_VISIBILITY";function E(e){return{type:p,isVisible:e}}function S(e){return function(t){return s.Z.get({endpoint:`/dashboardasync/api/read?_flt_0_owners=${e}`}).then((e=>{let{json:r}=e;const n=r.pks.map(((e,t)=>({value:e,label:(r.result[t]||{}).dashboard_title})));return n.sort(((e,t)=>e.label.localeCompare(t.label,{sensitivity:"base",numeric:!0}))),t(u(n))})).catch((()=>t(_(e))))}}const f="SAVE_SLICE_FAILED";function A(){return{type:f}}const T="SAVE_SLICE_SUCCESS";function y(e){return{type:T,data:e}}const v="REMOVE_SAVE_MODAL_ALERT";function D(){return{type:v}}const m=(e,t,r,n)=>{const a=Object.entries(t).reduce(((e,t)=>{let[r,n]=t;return d.test(r)?{...e,[r]:null==n?void 0:n.filter((e=>!e.isExtra))}:e}),{}),s={...t,...a,dashboards:r},[o,i]=s.datasource.split("__");return{params:JSON.stringify(s),slice_name:e,viz_type:s.viz_type,datasource_id:parseInt(o,10),datasource_type:i,dashboards:r,owners:n,query_context:JSON.stringify((0,c.u)({formData:s,force:!1,resultFormat:"json",resultType:"full",setDataMask:null,ownState:null}))}},C=(e,t,r)=>{const n=[];return e?n.push((0,i.ws)((0,o.t)("Chart [%s] has been saved",t))):n.push((0,i.ws)((0,o.t)("Chart [%s] has been overwritten",t))),r&&(r.new?n.push((0,i.ws)((0,o.t)("Dashboard [%s] just got created and chart [%s] was added to it",r.title,t))):n.push((0,i.ws)((0,o.t)("Chart [%s] was added to dashboard [%s]",t,r.title)))),n},R=(e,t,r,n)=>{let{slice_id:a,owners:o}=e;return async(e,i)=>{const{explore:{form_data:{url_params:c,...d}}}=i();try{const i=await s.Z.put({endpoint:`/api/v1/chart/${a}`,jsonPayload:m(t,d,r,o)});return e(y()),C(!1,t,n).map(e),i.json}catch(t){throw e(A()),t}}},g=(e,t,r)=>async(n,a)=>{const{explore:{form_data:{url_params:o,...i}}}=a();try{const a=await s.Z.post({endpoint:"/api/v1/chart/",jsonPayload:m(e,i,t)});return n(y()),C(!0,e,r).map(n),a.json}catch(e){throw n(A()),e}},b=e=>async t=>{try{return(await s.Z.post({endpoint:"/api/v1/dashboard/",jsonPayload:{dashboard_title:e}})).json}catch(e){throw t(A()),e}},F=e=>async t=>{try{return(await s.Z.get({endpoint:`/api/v1/dashboard/${e}`})).json}catch(e){throw t(A()),e}},O=e=>async t=>{try{return(await s.Z.get({endpoint:`/api/v1/chart/${e.slice_id}?q=${a().encode({columns:["dashboards.id"]})}`})).json.result.dashboards.map((e=>{let{id:t}=e;return t}))}catch(e){throw t(A()),e}}},99068:(e,t,r)=>{r.d(t,{AG:()=>i,yn:()=>l});var n=r(31069),a=r(72570),s=r(98286),o=r(651);const i="SET_DATASOURCE";function c(e){return{type:i,datasource:e}}function d(e){return function(t,r){const{explore:{datasource:n}}=r();t(c(e)),t((0,o.updateFormDataByDatasource)(n,e))}}const l={setDatasource:c,changeDatasource:d,saveDataset:function(e){let{schema:t,sql:r,database:o,templateParams:i,datasourceName:c,columns:l}=e;return async function(e){try{const{json:{data:a}}=await n.Z.post({endpoint:"/superset/sqllab_viz/",postPayload:{data:{schema:t,sql:r,dbId:null==o?void 0:o.id,templateParams:i,datasourceName:c,metrics:[],columns:l}}});return e(d(a)),a}catch(t){throw(0,s.O$)(t).then((t=>{e((0,a.Gb)(t.error))})),t}}}}},651:(e,t,r)=>{r.r(t),r.d(t,{UPDATE_FORM_DATA_BY_DATASOURCE:()=>i,updateFormDataByDatasource:()=>c,POST_DATASOURCE_STARTED:()=>d,FETCH_DATASOURCE_SUCCEEDED:()=>l,fetchDatasourceSucceeded:()=>u,FETCH_DATASOURCES_STARTED:()=>h,fetchDatasourcesStarted:()=>_,FETCH_DATASOURCES_SUCCEEDED:()=>p,fetchDatasourcesSucceeded:()=>E,TOGGLE_FAVE_STAR:()=>S,toggleFaveStar:()=>f,FETCH_FAVE_STAR:()=>A,fetchFaveStar:()=>T,SAVE_FAVE_STAR:()=>y,saveFaveStar:()=>v,SET_FIELD_VALUE:()=>D,setControlValue:()=>m,SET_EXPLORE_CONTROLS:()=>C,setExploreControls:()=>R,SET_FORM_DATA:()=>g,setFormData:()=>b,UPDATE_CHART_TITLE:()=>F,updateChartTitle:()=>O,SET_SAVE_ACTION:()=>I,setSaveAction:()=>w,CREATE_NEW_SLICE:()=>L,createNewSlice:()=>U,SLICE_UPDATED:()=>M,sliceUpdated:()=>V,SET_FORCE_QUERY:()=>x,setForceQuery:()=>P,exploreActions:()=>H});var n=r(31069),a=r(55867),s=r(72570);const o="/superset/favstar/slice",i="UPDATE_FORM_DATA_BY_DATASOURCE";function c(e,t){return{type:i,prevDatasource:e,newDatasource:t}}const d="POST_DATASOURCE_STARTED",l="FETCH_DATASOURCE_SUCCEEDED";function u(){return{type:l}}const h="FETCH_DATASOURCES_STARTED";function _(){return{type:h}}const p="FETCH_DATASOURCES_SUCCEEDED";function E(){return{type:p}}const S="TOGGLE_FAVE_STAR";function f(e){return{type:S,isStarred:e}}const A="FETCH_FAVE_STAR";function T(e){return function(t){n.Z.get({endpoint:`${o}/${e}/count/`}).then((e=>{let{json:r}=e;r.count>0&&t(f(!0))}))}}const y="SAVE_FAVE_STAR";function v(e,t){return function(r){const i=t?"unselect":"select";n.Z.get({endpoint:`${o}/${e}/${i}/`}).then((()=>r(f(!t)))).catch((()=>{r((0,s.Gb)((0,a.t)("An error occurred while starring this chart")))}))}}const D="SET_FIELD_VALUE";function m(e,t,r){return{type:D,controlName:e,value:t,validationErrors:r}}const C="UPDATE_EXPLORE_CONTROLS";function R(e){return{type:C,formData:e}}const g="UPDATE_FORM_DATA";function b(e){return{type:g,formData:e}}const F="UPDATE_CHART_TITLE";function O(e){return{type:F,sliceName:e}}const I="SET_SAVE_ACTION";function w(e){return{type:I,saveAction:e}}const L="CREATE_NEW_SLICE";function U(e,t,r,n,a){return{type:L,can_add:e,can_download:t,can_overwrite:r,slice:n,form_data:a}}const M="SLICE_UPDATED";function V(e){return{type:M,slice:e}}const x="SET_FORCE_QUERY";function P(e){return{type:x,force:e}}const H={...s.s2,fetchDatasourcesStarted:_,fetchDatasourcesSucceeded:E,toggleFaveStar:f,fetchFaveStar:T,saveFaveStar:v,setControlValue:m,setExploreControls:R,updateChartTitle:O,createNewSlice:U,sliceUpdated:V,setForceQuery:P}},29454:(e,t,r)=>{r.d(t,{Cy:()=>ae,zn:()=>ie,h:()=>oe});var n=r(14890),a=r(53894),s=r(72570),o=r(99543),i=r(37863),c=r(8868),d=r(61358),l=r(41295),u=r(4305),h=r(9467),_=r(39023),p=r(39759),E=r(24350),S=r.n(E),f=r(50810),A=r(37927),T=r(21090),y=r(80621),v=r(12885),D=r(81255);function m(e){return[D.BA,D.dW,D.xh,D.t].indexOf(e.type)>-1}var C=r(95173),R=r(47456),g=r(37418),b=r(28428);const F={[D.BG]:{[D.dW]:!0,[D.BA]:!0,[D.xh]:!0},[D.gn]:{[D.dW]:!0,[D.BA]:!0,[D.xh]:!0}};function O(e){let{parentType:t,childType:r}=e;if(!t||!r)return!1;const n=F[t];return!!n&&Boolean(n[r])}function I(e){let{dropResult:t,layout:r}=e;const{dragging:n,destination:a}=t,s=n.type,o=r[a.id],i=o.type;let c=(0,b.Z)(s,n.meta);c.parents=(o.parents||[]).concat(o.id),m(n)&&(c.meta.width=(0,R.Z)({dropResult:t,layout:r})||void 0);const d=O({parentType:i,childType:s}),l={[c.id]:c};if(d){const e=(0,b.Z)(D.Os);e.children=[c.id],e.parents=(o.parents||[]).concat(o.id),l[e.id]=e,c.parents=e.parents.concat(e.id),c=e}else if(s===D.yR){const e=(0,b.Z)(D.gn);e.parents=(o.parents||[]).concat(o.id),c.children=[e.id],l[e.id]=e}const u=[...o.children];return u.splice(a.index,0,c.id),l[a.id]={...o,children:u},l}function w(e,t,r){const n=null==r?void 0:r[e];if(n){delete r[e];const{children:a=[]}=n;null==a||null==a.forEach||a.forEach((t=>{w(t,e,r)}));const s=null==r?void 0:r[t];if(Array.isArray(null==s?void 0:s.children)){const n=s.children.indexOf(e);if(n>-1){const e=[...s.children];e.splice(n,1),r[t]={...s,children:e}}}}}const L={[u.$]:(e,t)=>({...t.data.dashboardLayout.present}),[v.nj](e,t){const{payload:{nextComponents:r}}=t;return{...e,...r}},[v.CB](e,t){var r;const{payload:{id:n,parentId:a}}=t;if(!(a&&n&&e[n]&&e[a]))return e;const s={...e};w(n,a,s);const o=s[a];return(null==o?void 0:o.type)===D.Os&&0===(null==o||null==(r=o.children)?void 0:r.length)&&w(a,(0,C.Z)({childId:a,layout:s}),s),s},[v.J0](e,t){const{payload:{dropResult:r}}=t,n=I({dropResult:r,layout:e});return{...e,...n}},[v.aZ](e,t){const{payload:{dropResult:r}}=t,{source:n,destination:a,dragging:s}=r;if(!n||!a||!s)return e;const o=function(e){let{entitiesMap:t,source:r,destination:n}=e;const a=[...t[r.id].children],s=[...t[n.id].children],o=a[r.index];if(r.id===n.id){const e=function(e,t,r){const n=[...e],[a]=n.splice(t,1);return n.splice(r,0,a),n}(a,r.index,n.index);return{...t,[r.id]:{...t[r.id],children:e}}}return a.splice(r.index,1),s.splice(n.index,0,o),{...t,[r.id]:{...t[r.id],children:a},[n.id]:{...t[n.id],children:s}}}({entitiesMap:e,source:n,destination:a});if(m(o[s.id])){const t=(0,R.Z)({dropResult:r,layout:e})||void 0;(o[s.id].meta||{}).width!==t&&(o[s.id]={...o[s.id],meta:{...o[s.id].meta,width:t}})}if(O({parentType:a.type,childType:s.type})){const e=o[a.id],t=e.children,r=(0,b.Z)(D.Os);r.children=[t[a.index]],r.parents=(e.parents||[]).concat(a.id),t[a.index]=r.id,o[r.id]=r}return{...e,...o}},[v.YA](e,t){const{payload:{dropResult:r}}=t,{source:n,dragging:a}=r,s=e[y._4],o=s.children[0],i=e[o];if(n.id!==y.D0){const t=e[a.id].children[0],r=e[t],n=[...i.children].filter((e=>e!==a.id));return{...e,[y._4]:{...s,children:[a.id]},[o]:{...i,children:[]},[t]:{...r,children:[...r.children,...n]}}}const c=I({dropResult:r,layout:e}),d=Object.values(c),l=d.find((e=>e.type===D.gn)),u=d.find((e=>e.type===D.yR));return l.children=[...i.children],c[o]={...i,children:[]},c[y._4]={...s,children:[u.id]},{...e,...c}},[v.Mu](e){const t=e[y._4],r=t.children[0],n=e[r];if(n.type!==D.yR)return e;let a=[];const s={...e};return n.children.forEach((t=>{const r=e[t];a=[...a,...r.children],delete s[t]})),delete s[r],s[y._4]={...t,children:[y.PV]},s[y.PV]={...e[y.PV],children:a},s},[v.x_](e){const t={...e};return(0,g.Z)({currentComponent:t[y._4],layout:t}),{...t}},[v.bK]:(e,t)=>({...e,[y.M2]:{...e[y.M2],meta:{...e[y.M2].meta,text:t.text}}})},U=(0,T.ZP)((function(e,t){return void 0===e&&(e={}),t.type in L?(0,L[t.type])(e,t):e}),{limit:y.Q9+2,ignoreInitialState:!0,filter:(0,T.an)([u.$,v.nj,v.CB,v.J0,v.YA,v.Mu,v.qL,v.aZ,v.L1])});var M=r(14670),V=r.n(M),x=r(31069),P=r(9679),H=r(97381),Z=r(3741),N=r(23279),B=r.n(N);const j=new class{constructor(e){let{callback:t=(()=>{}),sizeThreshold:r=1e3,delayThreshold:n=1e3}=e;this.queue=[],this.sizeThreshold=r,this.delayThreshold=n,this.trigger=B()(this.trigger.bind(this),this.delayThreshold),this.callback=t}append(e){this.queue.push(e),this.trigger()}trigger(){if(this.queue.length>0){const e=this.queue.splice(0,this.sizeThreshold);this.callback.call(null,e),this.queue.length>0&&this.trigger()}}}({callback:e=>{if(e.length<=0)return;let t="/superset/log/?explode=events";const{source:r,source_id:n}=e[0];if("dashboard"===r?t+=`&dashboard_id=${n}`:"slice"===r&&(t+=`&slice_id=${n}`),navigator.sendBeacon){const r=new FormData;r.append("events",(0,P.o)(e)),x.Z.getGuestToken()&&r.append("guest_token",x.Z.getGuestToken()),navigator.sendBeacon(t,r)}else x.Z.post({endpoint:t,postPayload:{events:e},parseMethod:null})},sizeThreshold:1024,delayThreshold:1e3});let $=0;const q=e=>t=>r=>{var n;if(r.type!==H.LOG_EVENT)return t(r);const{dashboardInfo:a,explore:s,impressionId:o,dashboardLayout:i,sqlLab:c}=e.getState();let d={impression_id:o,version:"v2"};if(null!=a&&a.id)d={source:"dashboard",source_id:a.id,...d};else if(null!=s&&s.slice)d={source:"explore",source_id:s.slice?s.slice.slice_id:0,...d};else if(c){const e=c.queryEditors.find((e=>{let{id:t}=e;return t===c.tabHistory.slice(-1)[0]}));d={source:"sqlLab",source_id:null==e?void 0:e.id,db_id:null==e?void 0:e.dbId,schema:null==e?void 0:e.schema}}const{eventName:l}=r.payload;let{eventData:u={}}=r.payload;if(u={...d,ts:(new Date).getTime(),event_name:l,...u},Z.TY.has(l)?u={...u,event_type:"timing",trigger_event:$}:($=V().generate(),u={...u,event_type:"user",event_id:$,visibility:document.visibilityState}),u.target_id&&null!=i&&null!=(n=i.present)&&n[u.target_id]){const{meta:e}=i.present[u.target_id];u.target_name=e.chartId?e.sliceName:e.text}return j.append(u),u};var k=r(19485),Y=r(76445),G=r(78580),z=r.n(G),J=r(55786),Q=r(52256),W=r(35854),K=r(10331),X=r(651),ee=r(42313),te=r(99068);const re=e=>function(t){return void 0===t&&(t=e),t},ne=(0,r(20292).Z)(),ae="USER_LOADED",se=(0,n.UY)({messageToasts:function(e,t){switch(void 0===e&&(e=[]),t.type){case s.h:{const{payload:r}=t,n=e.slice();return r.noDuplicate&&n.find((e=>e.text===r.text))?e:[r,...e]}case s.K7:{const{payload:{id:r}}=t;return[...e].filter((e=>e.id!==r))}default:return e}},common:re(ne.common),user:function(e,t){return void 0===e&&(e=ne.user||{}),t.type===ae?t.user:e},impressionId:re(V().generate()),charts:i.Z,datasources:(e,t)=>t.type===f.Rn.SET_DATASOURCES?function(e,t){return t.type===f.Rn.SET_DATASOURCES?{...e,...S()(t.datasources,"uid")}:t.type===f.Rn.SET_DATASOURCE?{...e,[t.key]:t.datasource}:e||{}}(e,t):function(e,t){return t.type===te.AG?{...e,[(0,ee.T)(t.datasource)]:t.datasource}:t.type===Y._?{...t.data.datasources}:e||{}}(e,t),dashboardInfo:function(e,t){switch(void 0===e&&(e={}),t.type){case l.$A:return{...e,...t.newInfo,last_modified_time:Math.round((new Date).getTime()/1e3)};case u.$:return{...e,...t.data.dashboardInfo};case l.nH:return{...e,filterBarOrientation:t.filterBarOrientation};case l.Fl:return{...e,crossFiltersEnabled:t.crossFiltersEnabled};default:return e}},dashboardFilters:_.ZP,dataMask:c.Z,nativeFilters:p.Z,dashboardState:function(e,t){void 0===e&&(e={});const r={[u.$]:()=>({...e,...t.data.dashboardState}),[h.Be]:()=>({...e,css:t.css}),[h.BD](){const r=new Set(e.sliceIds);return r.add(t.slice.slice_id),{...e,sliceIds:Array.from(r)}},[h.Vd](){const{sliceId:r}=t,n=new Set(e.sliceIds);return n.delete(r),{...e,sliceIds:Array.from(n)}},[h.Z9]:()=>({...e,isStarred:t.isStarred}),[h.H9]:()=>({...e,isPublished:t.isPublished}),[h.$f]:()=>({...e,editMode:t.editMode}),[h.n1](){const{maxUndoHistoryExceeded:r=!0}=t.payload;return{...e,maxUndoHistoryExceeded:r}},[h.oJ]:()=>({...e}),[h.J$]:()=>({...e,colorScheme:t.colorScheme,updatedColorScheme:!0}),[h.ek](){const r={...e.expandedSlices},{sliceId:n}=t;return r[n]?delete r[n]:r[n]=!0,{...e,expandedSlices:r}},[h.P0]:()=>({...e,hasUnsavedChanges:!0}),[h.hD]:()=>({...e,dashboardIsSaving:!0}),[h.qJ]:()=>({...e,dashboardIsSaving:!1}),[h.Ii]:()=>({...e,hasUnsavedChanges:!1,maxUndoHistoryExceeded:!1,editMode:!1,updatedColorScheme:!1,lastModifiedTime:t.lastModifiedTime}),[h.ee](){const{hasUnsavedChanges:r}=t.payload;return{...e,hasUnsavedChanges:r}},[h.yV]:()=>({...e,refreshFrequency:t.refreshFrequency,shouldPersistRefreshFrequency:t.isPersistent,hasUnsavedChanges:t.isPersistent}),[h.ec]:()=>({...e,isRefreshing:!0}),[h.bs]:()=>({...e,isFiltersRefreshing:!0}),[h.sm]:()=>({...e,isFiltersRefreshing:!1}),[h.k5]:()=>({...e,isRefreshing:!1}),[h.RU]:()=>({...e,directPathToChild:t.path,directPathLastUpdated:Date.now()}),[h.nV](){const r=new Set(e.activeTabs);return r.delete(t.prevTabId),r.add(t.tabId),{...e,activeTabs:Array.from(r)}},[h.w9]:()=>({...e,overwriteConfirmMetadata:t.overwriteConfirmMetadata}),[h.mq]:()=>({...e,focusedFilterField:{chartId:t.chartId,column:t.column}}),[h.Iw]:()=>e.focusedFilterField&&t.chartId===e.focusedFilterField.chartId&&t.column===e.focusedFilterField.column?{...e,focusedFilterField:null}:e,[h.r$]:()=>({...e,fullSizeChartId:t.chartId}),[h.FF]:()=>({...e,datasetsStatus:t.status})};return t.type in r?r[t.type]():e},dashboardLayout:U,sliceEntities:A.Z,reports:function(e,t){void 0===e&&(e={});const r={[d.jt](){var r,n,a;const{report:s,resourceId:o,creationMethod:i,filterField:c}=t,d=null==(r=s.result)?void 0:r.find((e=>e[c]===o));if(d)return{...e,[i]:{...e[i],[o]:d}};if(null!=(n=e)&&null!=(a=n[i])&&a[o]){const t={...e};return delete t[i][o],t}return{...e}},[d.J8](){const{result:r,id:n}=t.json,a={...r,id:n},s=a.dashboard||a.chart;return{...e,[a.creation_method]:{...e[a.creation_method],[s]:a}}},[d.Dr](){const r={...t.json.result,id:t.json.id},n=r.dashboard||r.chart;return{...e,[r.creation_method]:{...e[r.creation_method],[n]:r}}}};return t.type in r?r[t.type]():e},saveModal:function(e,t){void 0===e&&(e={});const r={[k.SET_SAVE_CHART_MODAL_VISIBILITY]:()=>({...e,isVisible:t.isVisible}),[k.FETCH_DASHBOARDS_SUCCEEDED]:()=>({...e,dashboards:t.choices}),[k.FETCH_DASHBOARDS_FAILED]:()=>({...e,saveModalAlert:`fetching dashboards failed for ${t.userId}`}),[k.SAVE_SLICE_FAILED]:()=>({...e,saveModalAlert:"Failed to save slice"}),[k.SAVE_SLICE_SUCCESS]:t=>({...e,data:t}),[k.REMOVE_SAVE_MODAL_ALERT]:()=>({...e,saveModalAlert:null}),[Y._]:()=>({...t.data.saveModal})};return t.type in r?r[t.type]():e},explore:function(e,t){void 0===e&&(e={});const r={[Q.DYNAMIC_PLUGIN_CONTROLS_READY]:()=>({...e,controls:t.controlsState}),[X.TOGGLE_FAVE_STAR]:()=>({...e,isStarred:t.isStarred}),[X.POST_DATASOURCE_STARTED]:()=>({...e,isDatasourceMetaLoading:!0}),[X.UPDATE_FORM_DATA_BY_DATASOURCE](){const r={...e.form_data},{prevDatasource:n,newDatasource:a}=t,s={...e.controls},o=[];n.id===a.id&&n.type===a.type||(r.datasource=a.uid),Object.entries(s).forEach((e=>{let[t,n]=e;("column_name"===n.valueKey||"savedMetrics"in n||"columns"in n||"options"in n&&!Array.isArray(n.options))&&(r[t]=(0,K.YY)(a,n,n.value),(0,J.Z)(r[t]).length>0&&r[t]!==s[t].default&&o.push(t))}));const i={...e,controls:s,datasource:t.newDatasource};return{...i,form_data:r,controls:(0,W.R3)(i,r),controlsTransferred:o}},[X.FETCH_DATASOURCES_STARTED]:()=>({...e,isDatasourcesLoading:!0}),[X.SET_FIELD_VALUE](){const{controlName:r,value:n,validationErrors:a}=t;let s={...e.form_data,[r]:n};const o=e.form_data.metrics,i=e.form_data.column_config,c=s.viz_type;"metrics"===r&&o&&i&&(n.forEach(((e,t)=>{var r,n;(null==e?void 0:e.label)!==(null==(r=o[t])?void 0:r.label)&&i[null==(n=o[t])?void 0:n.label]&&(i[e.label]=i[o[t].label],delete i[o[t].label])})),s.column_config=i);const d=e.controls[t.controlName]||(0,K.Bx)(t.controlName,c)||{},l={...(0,K.vP)(d,e,t.value)},u={...e.controls.column_config,...i&&{value:i}},h={...e,controls:{...e.controls,[r]:l,..."metrics"===r&&{column_config:u}}},_={};Array.isArray(l.rerender)&&l.rerender.forEach((e=>{_[e]={...(0,K.vP)(h.controls[e],h,h.controls[e].value)}}));const p=l.validationErrors||[];(a||[]).forEach((e=>{z()(p).call(p,e)||p.push(e)}));const E=p&&p.length>0,S="viz_type"===t.controlName&&t.value!==e.controls.viz_type.value;let f=e.controls;if(S){const r=new K.os(e.form_data).transform(t.value,e);s=r.formData,f=r.controlsState}return{...e,form_data:s,triggerRender:l.renderTrigger&&!E,controls:{...f,[t.controlName]:{...l,validationErrors:p},..._}}},[X.SET_EXPLORE_CONTROLS]:()=>({...e,controls:(0,W.R3)(e,t.formData)}),[X.SET_FORM_DATA]:()=>({...e,form_data:t.formData}),[X.UPDATE_CHART_TITLE]:()=>({...e,sliceName:t.sliceName}),[X.SET_SAVE_ACTION]:()=>({...e,saveAction:t.saveAction}),[X.CREATE_NEW_SLICE]:()=>({...e,slice:t.slice,controls:(0,W.R3)(e,t.form_data),can_add:t.can_add,can_download:t.can_download,can_overwrite:t.can_overwrite}),[X.SLICE_UPDATED](){var r;return{...e,slice:{...e.slice,...t.slice,owners:t.slice.owners?t.slice.owners.map((e=>e.value)):null},sliceName:null!=(r=t.slice.slice_name)?r:e.sliceName,metadata:{...e.metadata,owners:t.slice.owners?t.slice.owners.map((e=>e.label)):null}}},[X.SET_FORCE_QUERY]:()=>({...e,force:t.force}),[Y._]:()=>({...t.data.explore})};return t.type in r?r[t.type]():e}}),oe=(0,n.MT)(se,{},(0,n.qC)((0,n.md)(a.Z,q),(0,o.hU)(!1)));function ie(e){return void 0===e&&(e=!1),(0,n.MT)(se,{},(0,n.qC)((0,n.md)(a.Z,q),(0,o.hU)(!1,void 0,e)))}}}]);
//# sourceMappingURL=9454.4f7ff2869f66bbf358d6.entry.js.map